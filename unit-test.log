
> disaster-management-pwa@0.1.0 test:unit:coverage
> jest --coverage

FAIL tests/unit/sync/queue.test.ts
  ‚óè Console

    console.log
      Added assessment create for entity1 to sync queue with priority 8

      at SyncQueueManager.log [as addItem] (src/lib/sync/queue.ts:70:13)

    console.log
      Added response update for entity2 to sync queue with priority 5

      at SyncQueueManager.log [as addItem] (src/lib/sync/queue.ts:70:13)

    console.error
      Failed to update queue item: Error: Update failed
          at Object.<anonymous> (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\sync\queue.test.ts:93:70)
          at Promise.then.completed (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:316:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
          at run (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
          at runTestInternal (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:367:16)
          at runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:444:34)
          at Object.worker (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\testWorker.js:106:12)

    [0m [90m 77 |[39m       [36mreturn[39m updated [33m>[39m [35m0[39m[33m;[39m
     [90m 78 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 79 |[39m       console[33m.[39merror([32m'Failed to update queue item:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 80 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m
     [90m 81 |[39m     }
     [90m 82 |[39m   }[0m

      at SyncQueueManager.error [as updateItem] (src/lib/sync/queue.ts:79:15)
      at Object.<anonymous> (tests/unit/sync/queue.test.ts:95:22)

    console.error
      Failed to remove queue item: Error: Remove failed
          at Object.<anonymous> (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\sync\queue.test.ts:112:70)
          at Promise.then.completed (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:316:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
          at run (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
          at runTestInternal (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:367:16)
          at runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:444:34)
          at Object.worker (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\testWorker.js:106:12)

    [0m [90m 87 |[39m       [36mreturn[39m [36mtrue[39m[33m;[39m
     [90m 88 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 89 |[39m       console[33m.[39merror([32m'Failed to remove queue item:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 90 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m
     [90m 91 |[39m     }
     [90m 92 |[39m   }[0m

      at SyncQueueManager.error [as removeItem] (src/lib/sync/queue.ts:89:15)
      at Object.<anonymous> (tests/unit/sync/queue.test.ts:114:22)

    console.error
      Failed to get queue item: Error: Database error
          at Object.<anonymous> (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\sync\queue.test.ts:163:63)
          at Promise.then.completed (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:316:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
          at run (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
          at runTestInternal (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:367:16)
          at runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:444:34)
          at Object.worker (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\testWorker.js:106:12)

    [0m [90m 101 |[39m       [36mreturn[39m [36mthis[39m[33m.[39mmapToQueueItemStatus(item)[33m;[39m
     [90m 102 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 103 |[39m       console[33m.[39merror([32m'Failed to get queue item:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 104 |[39m       [36mreturn[39m [36mnull[39m[33m;[39m
     [90m 105 |[39m     }
     [90m 106 |[39m   }[0m

      at SyncQueueManager.error [as getItem] (src/lib/sync/queue.ts:103:15)
      at Object.<anonymous> (tests/unit/sync/queue.test.ts:165:22)

    console.error
      Failed to get queue items: Error: Database error
          at Object.<anonymous> (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\sync\queue.test.ts:258:63)
          at Promise.then.completed (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:316:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
          at run (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
          at runTestInternal (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:367:16)
          at runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:444:34)
          at Object.worker (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\testWorker.js:106:12)

    [0m [90m 160 |[39m       [36mreturn[39m items[33m.[39mmap(item [33m=>[39m [36mthis[39m[33m.[39mmapToQueueItemStatus(item))[33m;[39m
     [90m 161 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 162 |[39m       console[33m.[39merror([32m'Failed to get queue items:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 163 |[39m       [36mreturn[39m [][33m;[39m
     [90m 164 |[39m     }
     [90m 165 |[39m   }[0m

      at SyncQueueManager.error [as getItems] (src/lib/sync/queue.ts:162:15)
      at Object.<anonymous> (tests/unit/sync/queue.test.ts:260:22)

    console.error
      Failed to get queue metrics: Error: Database error
          at Object.<anonymous> (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\sync\queue.test.ts:352:63)
          at Promise.then.completed (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:316:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
          at run (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
          at runTestInternal (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:367:16)
          at runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:444:34)
          at Object.worker (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\testWorker.js:106:12)

    [0m [90m 230 |[39m       [36mreturn[39m metrics[33m;[39m
     [90m 231 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 232 |[39m       console[33m.[39merror([32m'Failed to get queue metrics:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 233 |[39m       [36mreturn[39m {
     [90m 234 |[39m         total[33m:[39m [35m0[39m[33m,[39m
     [90m 235 |[39m         pending[33m:[39m [35m0[39m[33m,[39m[0m

      at SyncQueueManager.error [as getMetrics] (src/lib/sync/queue.ts:232:15)
      at Object.<anonymous> (tests/unit/sync/queue.test.ts:354:23)

    console.log
      Reset 2 failed items for retry

      at SyncQueueManager.log [as resetFailedItems] (src/lib/sync/queue.ts:321:15)

    console.error
      Failed to update queue item: Error: Update failed
          at Object.<anonymous> (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\sync\queue.test.ts:504:70)
          at Promise.then.completed (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:316:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
          at run (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
          at runTestInternal (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:367:16)
          at runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:444:34)
          at Object.worker (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\testWorker.js:106:12)

    [0m [90m 77 |[39m       [36mreturn[39m updated [33m>[39m [35m0[39m[33m;[39m
     [90m 78 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 79 |[39m       console[33m.[39merror([32m'Failed to update queue item:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 80 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m
     [90m 81 |[39m     }
     [90m 82 |[39m   }[0m

      at SyncQueueManager.error [as updateItem] (src/lib/sync/queue.ts:79:15)
      at SyncQueueManager.resetFailedItems (src/lib/sync/queue.ts:311:25)
      at Object.<anonymous> (tests/unit/sync/queue.test.ts:506:26)

    console.log
      Reset 0 failed items for retry

      at SyncQueueManager.log [as resetFailedItems] (src/lib/sync/queue.ts:321:15)

    console.log
      Updated priority for 2 assessment items to 9

      at SyncQueueManager.log [as reprioritizeType] (src/lib/sync/queue.ts:420:15)

  ‚óè SyncQueueManager ‚Ä∫ addItem ‚Ä∫ should add item to sync queue

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    - Expected
    + Received

      Object {
        "action": "create",
    +   "attempts": 0,
        "data": Object {
          "test": "data",
        },
        "entityUuid": "entity1",
        "priority": 8,
    +   "timestamp": 2025-11-05T13:14:29.898Z,
        "type": "assessment",
        "uuid": "mock-uuid-1234",
      },

    Number of calls: 1

    [0m [90m 46 |[39m
     [90m 47 |[39m       expect(uuid)[33m.[39mtoBe([32m'mock-uuid-1234'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 48 |[39m       expect(offlineDB[33m.[39maddToSyncQueue)[33m.[39mtoHaveBeenCalledWith({
     [90m    |[39m                                        [31m[1m^[22m[39m
     [90m 49 |[39m         uuid[33m:[39m [32m'mock-uuid-1234'[39m[33m,[39m
     [90m 50 |[39m         type[33m:[39m [32m'assessment'[39m[33m,[39m
     [90m 51 |[39m         action[33m:[39m [32m'create'[39m[33m,[39m[0m

      at Object.toHaveBeenCalledWith (tests/unit/sync/queue.test.ts:48:40)

  ‚óè SyncQueueManager ‚Ä∫ getItem ‚Ä∫ should return queue item when found

    expect(received).toEqual(expected) // deep equality

    - Expected  - 1
    + Received  + 1

    @@ -4,10 +4,10 @@
        "entityUuid": "entity1",
        "error": "Network error",
        "lastAttempt": 2024-01-01T01:00:00.000Z,
        "nextRetry": 2024-01-01T01:05:00.000Z,
        "priority": 5,
    -   "status": "retrying",
    +   "status": "failed",
        "timestamp": 2024-01-01T00:00:00.000Z,
        "type": "assessment",
        "uuid": "uuid1",
      }

    [0m [90m 137 |[39m       [36mconst[39m result [33m=[39m [36mawait[39m queueManager[33m.[39mgetItem([32m'uuid1'[39m)[33m;[39m
     [90m 138 |[39m
    [31m[1m>[22m[39m[90m 139 |[39m       expect(result)[33m.[39mtoEqual({
     [90m     |[39m                      [31m[1m^[22m[39m
     [90m 140 |[39m         uuid[33m:[39m [32m'uuid1'[39m[33m,[39m
     [90m 141 |[39m         type[33m:[39m [32m'assessment'[39m[33m,[39m
     [90m 142 |[39m         action[33m:[39m [32m'create'[39m[33m,[39m[0m

      at Object.toEqual (tests/unit/sync/queue.test.ts:139:22)

  ‚óè SyncQueueManager ‚Ä∫ getMetrics ‚Ä∫ should calculate queue metrics correctly

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 2

    @@ -8,12 +8,12 @@
        "byType": Object {
          "assessment": 2,
          "entity": 0,
          "response": 1,
        },
    -   "failed": 0,
    +   "failed": 1,
        "maxRetries": 1,
        "oldestPending": 2024-01-01T00:00:00.000Z,
        "pending": 1,
    -   "retrying": 1,
    +   "retrying": 0,
        "total": 3,
      }

    [0m [90m 303 |[39m       [36mconst[39m metrics [33m=[39m [36mawait[39m queueManager[33m.[39mgetMetrics()[33m;[39m
     [90m 304 |[39m
    [31m[1m>[22m[39m[90m 305 |[39m       expect(metrics)[33m.[39mtoEqual({
     [90m     |[39m                       [31m[1m^[22m[39m
     [90m 306 |[39m         total[33m:[39m [35m3[39m[33m,[39m
     [90m 307 |[39m         pending[33m:[39m [35m1[39m[33m,[39m  [90m// uuid1[39m
     [90m 308 |[39m         retrying[33m:[39m [35m1[39m[33m,[39m [90m// uuid2[39m[0m

      at Object.toEqual (tests/unit/sync/queue.test.ts:305:23)

FAIL tests/unit/services/multi-user-assignment.test.ts
  ‚óè MultiUserAssignmentService ‚Ä∫ getEntityCollaboration ‚Ä∫ should return collaboration details for entity with multiple users

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 2

    @@ -3,21 +3,21 @@
        "assignedUsers": Array [
          Object {
            "assignedAt": 2024-01-01T00:00:00.000Z,
            "assignedBy": "coordinator1",
            "email": "assessor1@test.com",
    -       "name": "John Doe",
    +       "name": "assessor1@test.com",
            "roles": Array [
              "ASSESSOR",
            ],
            "userId": "user1",
          },
          Object {
            "assignedAt": 2024-01-02T00:00:00.000Z,
            "assignedBy": "coordinator1",
            "email": "responder1@test.com",
    -       "name": "Jane Smith",
    +       "name": "responder1@test.com",
            "roles": Array [
              "RESPONDER",
            ],
            "userId": "user2",
          },

    [0m [90m 90 |[39m       [36mconst[39m result [33m=[39m [36mawait[39m [33mMultiUserAssignmentService[39m[33m.[39mgetEntityCollaboration([32m'entity123'[39m)[33m;[39m
     [90m 91 |[39m
    [31m[1m>[22m[39m[90m 92 |[39m       expect(result)[33m.[39mtoEqual({
     [90m    |[39m                      [31m[1m^[22m[39m
     [90m 93 |[39m         entityId[33m:[39m [32m'entity123'[39m[33m,[39m
     [90m 94 |[39m         entityName[33m:[39m [32m'Test Community'[39m[33m,[39m
     [90m 95 |[39m         entityType[33m:[39m [32m'COMMUNITY'[39m[33m,[39m[0m

      at Object.toEqual (tests/unit/services/multi-user-assignment.test.ts:92:22)

  ‚óè MultiUserAssignmentService ‚Ä∫ getUserAssignmentOverview ‚Ä∫ should return user assignment overview with collaboration details

    expect(received).toEqual(expected) // deep equality

    - Expected  - 13
    + Received  +  3

      Object {
    -   "assignedEntities": Array [
    -     Object {
    -       "assignedAt": 2024-01-01T00:00:00.000Z,
    -       "entityId": "entity123",
    -       "entityName": "Test Community",
    -       "entityType": "COMMUNITY",
    -       "sharedWith": Array [
    -         "Jane Smith",
    -       ],
    -     },
    -   ],
    -   "collaborations": 1,
    +   "assignedEntities": Array [],
    +   "collaborations": 0,
        "email": "assessor1@test.com",
    -   "name": "John Doe",
    +   "name": "assessor1@test.com",
        "roles": Array [
          "ASSESSOR",
        ],
        "userId": "user1",
      }

    [0m [90m 154 |[39m       [36mconst[39m result [33m=[39m [36mawait[39m [33mMultiUserAssignmentService[39m[33m.[39mgetUserAssignmentOverview([32m'user1'[39m)[33m;[39m
     [90m 155 |[39m
    [31m[1m>[22m[39m[90m 156 |[39m       expect(result)[33m.[39mtoEqual({
     [90m     |[39m                      [31m[1m^[22m[39m
     [90m 157 |[39m         userId[33m:[39m [32m'user1'[39m[33m,[39m
     [90m 158 |[39m         email[33m:[39m [32m'assessor1@test.com'[39m[33m,[39m
     [90m 159 |[39m         name[33m:[39m [32m'John Doe'[39m[33m,[39m[0m

      at Object.toEqual (tests/unit/services/multi-user-assignment.test.ts:156:22)

  ‚óè MultiUserAssignmentService ‚Ä∫ getUserAssignmentOverview ‚Ä∫ should handle users with no assignments

    expect(received).toEqual(expected) // deep equality

    - Expected  - 1
    + Received  + 1

      Object {
        "assignedEntities": Array [],
        "collaborations": 0,
        "email": "assessor1@test.com",
    -   "name": "John Doe",
    +   "name": "assessor1@test.com",
        "roles": Array [
          "ASSESSOR",
        ],
        "userId": "user1",
      }

    [0m [90m 190 |[39m       [36mconst[39m result [33m=[39m [36mawait[39m [33mMultiUserAssignmentService[39m[33m.[39mgetUserAssignmentOverview([32m'user1'[39m)[33m;[39m
     [90m 191 |[39m
    [31m[1m>[22m[39m[90m 192 |[39m       expect(result)[33m.[39mtoEqual({
     [90m     |[39m                      [31m[1m^[22m[39m
     [90m 193 |[39m         userId[33m:[39m [32m'user1'[39m[33m,[39m
     [90m 194 |[39m         email[33m:[39m [32m'assessor1@test.com'[39m[33m,[39m
     [90m 195 |[39m         name[33m:[39m [32m'John Doe'[39m[33m,[39m[0m

      at Object.toEqual (tests/unit/services/multi-user-assignment.test.ts:192:22)

FAIL tests/unit/services/response-planning.test.ts
  ‚óè Response Planning Service ‚Ä∫ ResponseService (Backend) ‚Ä∫ should create a planned response successfully

    ReferenceError: responseService is not defined

    [0m [90m 82 |[39m       }
     [90m 83 |[39m
    [31m[1m>[22m[39m[90m 84 |[39m       [33m;[39m(responseService[33m.[39mcreatePlannedResponse [36mas[39m jest[33m.[39m[33mMock[39m)[33m.[39mmockResolvedValue(mockResponse)
     [90m    |[39m         [31m[1m^[22m[39m
     [90m 85 |[39m
     [90m 86 |[39m       [36mconst[39m result [33m=[39m [36mawait[39m [33mResponseService[39m[33m.[39mcreatePlannedResponse(
     [90m 87 |[39m         validResponseData[33m,[39m[0m

      at Object.responseService (tests/unit/services/response-planning.test.ts:84:9)

  ‚óè Response Planning Service ‚Ä∫ ResponseService (Backend) ‚Ä∫ should throw error for invalid assessment

    ReferenceError: responseService is not defined

    [0m [90m 102 |[39m       }
     [90m 103 |[39m
    [31m[1m>[22m[39m[90m 104 |[39m       [33m;[39m(responseService[33m.[39mcreatePlannedResponse [36mas[39m jest[33m.[39m[33mMock[39m)[33m.[39mmockRejectedValue(
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 105 |[39m         [36mnew[39m [33mError[39m([32m'Assessment not found'[39m)
     [90m 106 |[39m       )
     [90m 107 |[39m[0m

      at Object.responseService (tests/unit/services/response-planning.test.ts:104:9)

  ‚óè Response Planning Service ‚Ä∫ ResponseService (Backend) ‚Ä∫ should validate response items

    ReferenceError: responseService is not defined

    [0m [90m 117 |[39m       }
     [90m 118 |[39m
    [31m[1m>[22m[39m[90m 119 |[39m       [33m;[39m(responseService[33m.[39mcreatePlannedResponse [36mas[39m jest[33m.[39m[33mMock[39m)[33m.[39mmockRejectedValue(
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 120 |[39m         [36mnew[39m [33mError[39m([32m'At least one item is required'[39m)
     [90m 121 |[39m       )
     [90m 122 |[39m[0m

      at Object.responseService (tests/unit/services/response-planning.test.ts:119:9)

  ‚óè Response Planning Service ‚Ä∫ ResponseOfflineService ‚Ä∫ Online Operations ‚Ä∫ should create response online and cache it

    ReferenceError: responseService is not defined

    [0m [90m 136 |[39m         }
     [90m 137 |[39m
    [31m[1m>[22m[39m[90m 138 |[39m         [33m;[39m(responseService[33m.[39mcreatePlannedResponse [36mas[39m jest[33m.[39m[33mMock[39m)[33m.[39mmockResolvedValue(mockResponse)
     [90m     |[39m           [31m[1m^[22m[39m
     [90m 139 |[39m         [33m;[39m(offlineDB[33m.[39maddResponse [36mas[39m jest[33m.[39m[33mMock[39m)[33m.[39mmockResolvedValue([35m1[39m)
     [90m 140 |[39m
     [90m 141 |[39m         [36mconst[39m result [33m=[39m [36mawait[39m responseOfflineService[33m.[39mcreatePlannedResponse(validResponseData)[0m

      at Object.responseService (tests/unit/services/response-planning.test.ts:138:11)

  ‚óè Response Planning Service ‚Ä∫ ResponseOfflineService ‚Ä∫ Online Operations ‚Ä∫ should update response online and cache it

    ReferenceError: responseService is not defined

    [0m [90m 162 |[39m         }
     [90m 163 |[39m
    [31m[1m>[22m[39m[90m 164 |[39m         [33m;[39m(responseService[33m.[39mupdatePlannedResponse [36mas[39m jest[33m.[39m[33mMock[39m)[33m.[39mmockResolvedValue(mockResponse)
     [90m     |[39m           [31m[1m^[22m[39m
     [90m 165 |[39m         [33m;[39m(offlineDB[33m.[39mupdateResponse [36mas[39m jest[33m.[39m[33mMock[39m)[33m.[39mmockResolvedValue([35m1[39m)
     [90m 166 |[39m
     [90m 167 |[39m         [36mconst[39m result [33m=[39m [36mawait[39m responseOfflineService[33m.[39mupdatePlannedResponse([0m

      at Object.responseService (tests/unit/services/response-planning.test.ts:164:11)

  ‚óè Response Planning Service ‚Ä∫ ResponseOfflineService ‚Ä∫ Online Operations ‚Ä∫ should get response online and cache it

    ReferenceError: responseService is not defined

    [0m [90m 191 |[39m         }
     [90m 192 |[39m
    [31m[1m>[22m[39m[90m 193 |[39m         [33m;[39m(responseService[33m.[39mgetResponseById [36mas[39m jest[33m.[39m[33mMock[39m)[33m.[39mmockResolvedValue(mockResponse)
     [90m     |[39m           [31m[1m^[22m[39m
     [90m 194 |[39m         [33m;[39m(offlineDB[33m.[39mupdateResponse [36mas[39m jest[33m.[39m[33mMock[39m)[33m.[39mmockResolvedValue([35m1[39m)
     [90m 195 |[39m
     [90m 196 |[39m         [36mconst[39m result [33m=[39m [36mawait[39m responseOfflineService[33m.[39mgetResponseById([32m'response-123'[39m)[0m

      at Object.responseService (tests/unit/services/response-planning.test.ts:193:11)

  ‚óè Response Planning Service ‚Ä∫ ResponseOfflineService ‚Ä∫ Offline Fallback ‚Ä∫ should create response offline when online fails

    ReferenceError: responseService is not defined

    [0m [90m 208 |[39m       it([32m'should create response offline when online fails'[39m[33m,[39m [36masync[39m () [33m=>[39m {
     [90m 209 |[39m         [36mconst[39m onlineError [33m=[39m [36mnew[39m [33mError[39m([32m'Network error'[39m)
    [31m[1m>[22m[39m[90m 210 |[39m         [33m;[39m(responseService[33m.[39mcreatePlannedResponse [36mas[39m jest[33m.[39m[33mMock[39m)[33m.[39mmockRejectedValue(onlineError)
     [90m     |[39m           [31m[1m^[22m[39m
     [90m 211 |[39m         [33m;[39m(offlineDB[33m.[39maddResponse [36mas[39m jest[33m.[39m[33mMock[39m)[33m.[39mmockResolvedValue([35m1[39m)
     [90m 212 |[39m         [33m;[39m(offlineDB[33m.[39maddToSyncQueue [36mas[39m jest[33m.[39m[33mMock[39m)[33m.[39mmockResolvedValue([35m1[39m)
     [90m 213 |[39m[0m

      at Object.responseService (tests/unit/services/response-planning.test.ts:210:11)

  ‚óè Response Planning Service ‚Ä∫ ResponseOfflineService ‚Ä∫ Offline Fallback ‚Ä∫ should update response offline when online fails

    ReferenceError: responseService is not defined

    [0m [90m 248 |[39m       it([32m'should update response offline when online fails'[39m[33m,[39m [36masync[39m () [33m=>[39m {
     [90m 249 |[39m         [36mconst[39m onlineError [33m=[39m [36mnew[39m [33mError[39m([32m'Network error'[39m)
    [31m[1m>[22m[39m[90m 250 |[39m         [33m;[39m(responseService[33m.[39mupdatePlannedResponse [36mas[39m jest[33m.[39m[33mMock[39m)[33m.[39mmockRejectedValue(onlineError)
     [90m     |[39m           [31m[1m^[22m[39m
     [90m 251 |[39m         [33m;[39m(offlineDB[33m.[39mupdateResponse [36mas[39m jest[33m.[39m[33mMock[39m)[33m.[39mmockResolvedValue([35m1[39m)
     [90m 252 |[39m         [33m;[39m(offlineDB[33m.[39maddToSyncQueue [36mas[39m jest[33m.[39m[33mMock[39m)[33m.[39mmockResolvedValue([35m1[39m)
     [90m 253 |[39m[0m

      at Object.responseService (tests/unit/services/response-planning.test.ts:250:11)

  ‚óè Response Planning Service ‚Ä∫ ResponseOfflineService ‚Ä∫ Offline Fallback ‚Ä∫ should get response from offline cache when online fails

    ReferenceError: responseService is not defined

    [0m [90m 297 |[39m         }
     [90m 298 |[39m
    [31m[1m>[22m[39m[90m 299 |[39m         [33m;[39m(responseService[33m.[39mgetResponseById [36mas[39m jest[33m.[39m[33mMock[39m)[33m.[39mmockRejectedValue(onlineError)
     [90m     |[39m           [31m[1m^[22m[39m
     [90m 300 |[39m         [33m;[39m(offlineDB[33m.[39mgetResponse [36mas[39m jest[33m.[39m[33mMock[39m)[33m.[39mmockResolvedValue(mockOfflineResponse)
     [90m 301 |[39m
     [90m 302 |[39m         [36mconst[39m result [33m=[39m [36mawait[39m responseOfflineService[33m.[39mgetResponseById([32m'response-123'[39m)[0m

      at Object.responseService (tests/unit/services/response-planning.test.ts:299:11)

  ‚óè Response Planning Service ‚Ä∫ ResponseOfflineService ‚Ä∫ Sync Operations ‚Ä∫ should sync pending responses successfully

    TypeError: _offline.offlineDB.getSyncQueue.mockResolvedValue is not a function

    [0m [90m 328 |[39m         ]
     [90m 329 |[39m
    [31m[1m>[22m[39m[90m 330 |[39m         [33m;[39m(offlineDB[33m.[39mgetSyncQueue [36mas[39m jest[33m.[39m[33mMock[39m)[33m.[39mmockResolvedValue(mockPendingResponses)
     [90m     |[39m                                                [31m[1m^[22m[39m
     [90m 331 |[39m         [33m;[39m(responseService[33m.[39mcreatePlannedResponse [36mas[39m jest[33m.[39m[33mMock[39m)[33m.[39mmockResolvedValue({ id[33m:[39m [32m'response-123'[39m })
     [90m 332 |[39m         [33m;[39m(responseService[33m.[39mupdatePlannedResponse [36mas[39m jest[33m.[39m[33mMock[39m)[33m.[39mmockResolvedValue({ id[33m:[39m [32m'response-456'[39m })
     [90m 333 |[39m         [33m;[39m(offlineDB[33m.[39mupdateResponse [36mas[39m jest[33m.[39m[33mMock[39m)[33m.[39mmockResolvedValue([35m1[39m)[0m

      at Object.mockResolvedValue (tests/unit/services/response-planning.test.ts:330:48)

  ‚óè Response Planning Service ‚Ä∫ ResponseOfflineService ‚Ä∫ Sync Operations ‚Ä∫ should handle sync failures with retry logic

    TypeError: _offline.offlineDB.getSyncQueue.mockResolvedValue is not a function

    [0m [90m 357 |[39m         }
     [90m 358 |[39m
    [31m[1m>[22m[39m[90m 359 |[39m         [33m;[39m(offlineDB[33m.[39mgetSyncQueue [36mas[39m jest[33m.[39m[33mMock[39m)[33m.[39mmockResolvedValue([mockPendingResponse])
     [90m     |[39m                                                [31m[1m^[22m[39m
     [90m 360 |[39m         [33m;[39m(responseService[33m.[39mcreatePlannedResponse [36mas[39m jest[33m.[39m[33mMock[39m)[33m.[39mmockRejectedValue([36mnew[39m [33mError[39m([32m'Server error'[39m))
     [90m 361 |[39m         [33m;[39m(offlineDB[33m.[39mupdateSyncQueueItem [36mas[39m jest[33m.[39m[33mMock[39m)[33m.[39mmockResolvedValue([35m1[39m)
     [90m 362 |[39m[0m

      at Object.mockResolvedValue (tests/unit/services/response-planning.test.ts:359:48)

  ‚óè Response Planning Service ‚Ä∫ ResponseOfflineService ‚Ä∫ Conflict Checking ‚Ä∫ should check conflicts online and fallback to offline

    ReferenceError: responseService is not defined

    [0m [90m 385 |[39m           conflictingResponses[33m:[39m []
     [90m 386 |[39m         }
    [31m[1m>[22m[39m[90m 387 |[39m         [33m;[39m(responseService[33m.[39mcheckAssessmentConflicts [36mas[39m jest[33m.[39m[33mMock[39m)[33m.[39mmockResolvedValue(mockOnlineResult)
     [90m     |[39m           [31m[1m^[22m[39m
     [90m 388 |[39m
     [90m 389 |[39m         [36mconst[39m result [33m=[39m [36mawait[39m responseOfflineService[33m.[39mcheckAssessmentConflicts(mockAssessmentId)
     [90m 390 |[39m         expect(result)[33m.[39mtoEqual(mockOnlineResult)[0m

      at Object.responseService (tests/unit/services/response-planning.test.ts:387:11)

FAIL tests/integration/dashboard/crisis-conflicts.test.ts
  ‚óè Console

    console.log
      Conflict tracking table not found - would need database migration

      at ConflictResolver.log [as initializeConflictTable] (src/lib/sync/conflict.ts:65:17)

  ‚óè Crisis Dashboard Conflict Integration ‚Ä∫ should handle full conflict lifecycle

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/integration/dashboard/crisis-conflicts.test.ts:80:21)

  ‚óè Crisis Dashboard Conflict Integration ‚Ä∫ should handle empty conflict state

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/integration/dashboard/crisis-conflicts.test.ts:174:21)

  ‚óè Crisis Dashboard Conflict Integration ‚Ä∫ should handle date range filtering

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/integration/dashboard/crisis-conflicts.test.ts:229:31)

  ‚óè Crisis Dashboard Conflict Integration ‚Ä∫ should handle concurrent API requests

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at tests/integration/dashboard/crisis-conflicts.test.ts:265:11
          at Function.from (<anonymous>)
      at Object.from (tests/integration/dashboard/crisis-conflicts.test.ts:264:28)

  ‚óè Crisis Dashboard Conflict Integration ‚Ä∫ should handle malformed query parameters gracefully

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/integration/dashboard/crisis-conflicts.test.ts:288:30)

FAIL tests/integration/api/sync/batch.test.ts
  ‚óè /api/v1/sync/batch ‚Ä∫ POST ‚Ä∫ should process empty batch successfully

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/integration/api/sync/batch.test.ts:14:23)

  ‚óè /api/v1/sync/batch ‚Ä∫ POST ‚Ä∫ should validate request schema

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/integration/api/sync/batch.test.ts:30:23)

  ‚óè /api/v1/sync/batch ‚Ä∫ POST ‚Ä∫ should reject batch size over limit

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/integration/api/sync/batch.test.ts:55:23)

  ‚óè /api/v1/sync/batch ‚Ä∫ POST ‚Ä∫ should process valid sync changes

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/integration/api/sync/batch.test.ts:98:23)

  ‚óè /api/v1/sync/batch ‚Ä∫ POST ‚Ä∫ should handle different change types

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/integration/api/sync/batch.test.ts:146:23)

  ‚óè /api/v1/sync/batch ‚Ä∫ POST ‚Ä∫ should validate individual change objects

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/integration/api/sync/batch.test.ts:172:23)

  ‚óè /api/v1/sync/batch ‚Ä∫ POST ‚Ä∫ should handle missing required fields

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/integration/api/sync/batch.test.ts:197:23)

  ‚óè /api/v1/sync/batch ‚Ä∫ POST ‚Ä∫ should handle malformed JSON

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/integration/api/sync/batch.test.ts:218:23)

  ‚óè /api/v1/sync/batch ‚Ä∫ POST ‚Ä∫ should include conflict data in conflict responses

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/integration/api/sync/batch.test.ts:248:25)

  ‚óè /api/v1/sync/batch ‚Ä∫ POST ‚Ä∫ should generate unique server IDs for successful syncs

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/integration/api/sync/batch.test.ts:289:23)

  ‚óè /api/v1/sync/batch ‚Ä∫ POST ‚Ä∫ should preserve offlineId in responses

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/integration/api/sync/batch.test.ts:327:23)

  ‚óè /api/v1/sync/batch ‚Ä∫ POST ‚Ä∫ should handle changes without offlineId

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/integration/api/sync/batch.test.ts:354:23)

FAIL tests/unit/api/sync/conflicts.test.ts
  ‚óè /api/v1/sync/conflicts ‚Ä∫ GET /api/v1/sync/conflicts ‚Ä∫ should return paginated conflicts with default parameters

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at createMockRequest (tests/unit/api/sync/conflicts.test.ts:19:10)
      at Object.createMockRequest (tests/unit/api/sync/conflicts.test.ts:54:23)

  ‚óè /api/v1/sync/conflicts ‚Ä∫ GET /api/v1/sync/conflicts ‚Ä∫ should filter conflicts by entity type

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at createMockRequest (tests/unit/api/sync/conflicts.test.ts:19:10)
      at Object.createMockRequest (tests/unit/api/sync/conflicts.test.ts:95:23)

  ‚óè /api/v1/sync/conflicts ‚Ä∫ GET /api/v1/sync/conflicts ‚Ä∫ should filter conflicts by resolution status

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at createMockRequest (tests/unit/api/sync/conflicts.test.ts:19:10)
      at Object.createMockRequest (tests/unit/api/sync/conflicts.test.ts:130:23)

  ‚óè /api/v1/sync/conflicts ‚Ä∫ GET /api/v1/sync/conflicts ‚Ä∫ should handle pagination correctly

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at createMockRequest (tests/unit/api/sync/conflicts.test.ts:19:10)
      at Object.createMockRequest (tests/unit/api/sync/conflicts.test.ts:162:23)

  ‚óè /api/v1/sync/conflicts ‚Ä∫ GET /api/v1/sync/conflicts ‚Ä∫ should handle errors gracefully

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at createMockRequest (tests/unit/api/sync/conflicts.test.ts:19:10)
      at Object.createMockRequest (tests/unit/api/sync/conflicts.test.ts:182:23)

  ‚óè /api/v1/sync/conflicts ‚Ä∫ GET /api/v1/sync/conflicts/export ‚Ä∫ should export conflicts as CSV

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at createMockRequest (tests/unit/api/sync/conflicts.test.ts:19:10)
      at Object.createMockRequest (tests/unit/api/sync/conflicts.test.ts:220:23)

  ‚óè /api/v1/sync/conflicts ‚Ä∫ GET /api/v1/sync/conflicts/export ‚Ä∫ should apply filters to export

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at createMockRequest (tests/unit/api/sync/conflicts.test.ts:19:10)
      at Object.createMockRequest (tests/unit/api/sync/conflicts.test.ts:258:23)

  ‚óè /api/v1/sync/conflicts ‚Ä∫ GET /api/v1/sync/conflicts/export ‚Ä∫ should handle export errors

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at createMockRequest (tests/unit/api/sync/conflicts.test.ts:19:10)
      at Object.createMockRequest (tests/unit/api/sync/conflicts.test.ts:270:23)

  ‚óè /api/v1/sync/conflicts ‚Ä∫ GET /api/v1/sync/conflicts/summary ‚Ä∫ should return conflict summary statistics

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at createMockRequest (tests/unit/api/sync/conflicts.test.ts:19:10)
      at Object.createMockRequest (tests/unit/api/sync/conflicts.test.ts:316:23)

  ‚óè /api/v1/sync/conflicts ‚Ä∫ GET /api/v1/sync/conflicts/summary ‚Ä∫ should handle zero conflicts

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at createMockRequest (tests/unit/api/sync/conflicts.test.ts:19:10)
      at Object.createMockRequest (tests/unit/api/sync/conflicts.test.ts:364:23)

  ‚óè /api/v1/sync/conflicts ‚Ä∫ GET /api/v1/sync/conflicts/summary ‚Ä∫ should handle summary errors

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at createMockRequest (tests/unit/api/sync/conflicts.test.ts:19:10)
      at Object.createMockRequest (tests/unit/api/sync/conflicts.test.ts:377:23)

FAIL tests/unit/sync/engine.test.ts
  ‚óè Console

    console.log
      Cannot sync: device is offline

      at SyncEngine.log [as triggerSync] (src/lib/sync/engine.ts:154:15)

    console.log
      Cannot sync: device is offline

      at SyncEngine.log [as triggerSync] (src/lib/sync/engine.ts:154:15)

    console.log
      Cannot sync: device is offline

      at SyncEngine.log [as triggerSync] (src/lib/sync/engine.ts:154:15)

    console.log
      Cannot sync: device is offline

      at SyncEngine.log [as triggerSync] (src/lib/sync/engine.ts:154:15)

    console.log
      Cannot sync: device is offline

      at SyncEngine.log [as triggerSync] (src/lib/sync/engine.ts:154:15)

    console.log
      Cannot sync: device is offline

      at SyncEngine.log [as triggerSync] (src/lib/sync/engine.ts:154:15)

    console.log
      Cannot sync: device is offline

      at SyncEngine.log [as triggerSync] (src/lib/sync/engine.ts:154:15)

  ‚óè SyncEngine ‚Ä∫ connectivity detection ‚Ä∫ should detect offline status

    expect(received).toBe(expected) // Object.is equality

    Expected: false
    Received: true

    [0m [90m 66 |[39m       [36mconst[39m offlineEngine [33m=[39m [33mSyncEngine[39m[33m.[39mgetInstance()[33m;[39m
     [90m 67 |[39m       [36mconst[39m status [33m=[39m offlineEngine[33m.[39mgetConnectivityStatus()[33m;[39m
    [31m[1m>[22m[39m[90m 68 |[39m       expect(status[33m.[39misOnline)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
     [90m    |[39m                               [31m[1m^[22m[39m
     [90m 69 |[39m     })[33m;[39m
     [90m 70 |[39m
     [90m 71 |[39m     it([32m'should notify connectivity changes'[39m[33m,[39m (done) [33m=>[39m {[0m

      at Object.toBe (tests/unit/sync/engine.test.ts:68:31)

  ‚óè SyncEngine ‚Ä∫ sync operations ‚Ä∫ should return empty result when no items to sync

    expect(received).toEqual(expected) // deep equality

    Expected: {"conflicts": [], "failed": [], "successful": [], "totalProcessed": 0}
    Received: null

    [0m [90m 131 |[39m       [36mconst[39m result [33m=[39m [36mawait[39m syncEngine[33m.[39mtriggerSync()[33m;[39m
     [90m 132 |[39m       
    [31m[1m>[22m[39m[90m 133 |[39m       expect(result)[33m.[39mtoEqual({
     [90m     |[39m                      [31m[1m^[22m[39m
     [90m 134 |[39m         successful[33m:[39m [][33m,[39m
     [90m 135 |[39m         conflicts[33m:[39m [][33m,[39m
     [90m 136 |[39m         failed[33m:[39m [][33m,[39m[0m

      at Object.toEqual (tests/unit/sync/engine.test.ts:133:22)

  ‚óè SyncEngine ‚Ä∫ sync operations ‚Ä∫ should process successful sync

    expect(received).toEqual(expected) // deep equality

    Expected: {"conflicts": [], "failed": [], "successful": [{"message": "Synced successfully", "offlineId": "item1", "serverId": "server1", "status": "success"}], "totalProcessed": 1}
    Received: null

    [0m [90m 156 |[39m       [36mconst[39m result [33m=[39m [36mawait[39m syncEngine[33m.[39mtriggerSync()[33m;[39m
     [90m 157 |[39m
    [31m[1m>[22m[39m[90m 158 |[39m       expect(result)[33m.[39mtoEqual({
     [90m     |[39m                      [31m[1m^[22m[39m
     [90m 159 |[39m         successful[33m:[39m mockResponse[33m,[39m
     [90m 160 |[39m         conflicts[33m:[39m [][33m,[39m
     [90m 161 |[39m         failed[33m:[39m [][33m,[39m[0m

      at Object.toEqual (tests/unit/sync/engine.test.ts:158:22)

  ‚óè SyncEngine ‚Ä∫ sync operations ‚Ä∫ should handle sync conflicts

    expect(received).toEqual(expected) // deep equality

    Expected: {"conflicts": [{"conflictData": {"id": "1", "value": "server_value", "version": 2}, "message": "Conflict detected", "offlineId": "item1", "serverId": "server1", "status": "conflict"}], "failed": [], "successful": [], "totalProcessed": 1}
    Received: null

    [0m [90m 184 |[39m       [36mconst[39m result [33m=[39m [36mawait[39m syncEngine[33m.[39mtriggerSync()[33m;[39m
     [90m 185 |[39m
    [31m[1m>[22m[39m[90m 186 |[39m       expect(result)[33m.[39mtoEqual({
     [90m     |[39m                      [31m[1m^[22m[39m
     [90m 187 |[39m         successful[33m:[39m [][33m,[39m
     [90m 188 |[39m         conflicts[33m:[39m mockResponse[33m,[39m
     [90m 189 |[39m         failed[33m:[39m [][33m,[39m[0m

      at Object.toEqual (tests/unit/sync/engine.test.ts:186:22)

  ‚óè SyncEngine ‚Ä∫ sync operations ‚Ä∫ should handle sync failures with retry

    expect(received).toEqual(expected) // deep equality

    Expected: {"conflicts": [], "failed": [{"message": "Server error", "offlineId": "item1", "serverId": "", "status": "failed"}], "successful": [], "totalProcessed": 1}
    Received: null

    [0m [90m 212 |[39m       [36mconst[39m result [33m=[39m [36mawait[39m syncEngine[33m.[39mtriggerSync()[33m;[39m
     [90m 213 |[39m
    [31m[1m>[22m[39m[90m 214 |[39m       expect(result)[33m.[39mtoEqual({
     [90m     |[39m                      [31m[1m^[22m[39m
     [90m 215 |[39m         successful[33m:[39m [][33m,[39m
     [90m 216 |[39m         conflicts[33m:[39m [][33m,[39m
     [90m 217 |[39m         failed[33m:[39m mockResponse[33m,[39m[0m

      at Object.toEqual (tests/unit/sync/engine.test.ts:214:22)

  ‚óè SyncEngine ‚Ä∫ sync operations ‚Ä∫ should handle network errors

    expect(received).toEqual(expected) // deep equality

    Expected: {"conflicts": [], "failed": [{"message": "Network error", "offlineId": "item1", "serverId": "", "status": "failed"}], "successful": [], "totalProcessed": 1}
    Received: null

    [0m [90m 235 |[39m       [36mconst[39m result [33m=[39m [36mawait[39m syncEngine[33m.[39mtriggerSync()[33m;[39m
     [90m 236 |[39m
    [31m[1m>[22m[39m[90m 237 |[39m       expect(result)[33m.[39mtoEqual({
     [90m     |[39m                      [31m[1m^[22m[39m
     [90m 238 |[39m         successful[33m:[39m [][33m,[39m
     [90m 239 |[39m         conflicts[33m:[39m [][33m,[39m
     [90m 240 |[39m         failed[33m:[39m [[0m

      at Object.toEqual (tests/unit/sync/engine.test.ts:237:22)

  ‚óè SyncEngine ‚Ä∫ sync operations ‚Ä∫ should respect max batch size

    expect(received).toBe(expected) // Object.is equality

    Expected: 100
    Received: undefined

    [0m [90m 275 |[39m       [36mconst[39m result [33m=[39m [36mawait[39m syncEngine[33m.[39mtriggerSync()[33m;[39m
     [90m 276 |[39m
    [31m[1m>[22m[39m[90m 277 |[39m       expect(result[33m?[39m[33m.[39mtotalProcessed)[33m.[39mtoBe([35m100[39m)[33m;[39m
     [90m     |[39m                                      [31m[1m^[22m[39m
     [90m 278 |[39m       expect(mockFetch)[33m.[39mtoHaveBeenCalledWith(
     [90m 279 |[39m         [32m'/api/v1/sync/batch'[39m[33m,[39m
     [90m 280 |[39m         expect[33m.[39mobjectContaining({[0m

      at Object.toBe (tests/unit/sync/engine.test.ts:277:38)

  ‚óè SyncEngine ‚Ä∫ queue management ‚Ä∫ should add items to sync queue

    TypeError: crypto.randomUUID is not a function

    [0m [90m 498 |[39m   )[33m:[39m [33mPromise[39m[33m<[39m[36mvoid[39m[33m>[39m {
     [90m 499 |[39m     [36mawait[39m offlineDB[33m.[39maddToSyncQueue({
    [31m[1m>[22m[39m[90m 500 |[39m       uuid[33m:[39m crypto[33m.[39mrandomUUID()[33m,[39m
     [90m     |[39m                    [31m[1m^[22m[39m
     [90m 501 |[39m       type[33m,[39m
     [90m 502 |[39m       action[33m,[39m
     [90m 503 |[39m       entityUuid[33m,[39m[0m

      at SyncEngine.randomUUID (src/lib/sync/engine.ts:500:20)
      at Object.addToQueue (tests/unit/sync/engine.test.ts:292:24)

  ‚óè SyncEngine ‚Ä∫ queue management ‚Ä∫ should trigger background sync when adding to queue

    TypeError: crypto.randomUUID is not a function

    [0m [90m 498 |[39m   )[33m:[39m [33mPromise[39m[33m<[39m[36mvoid[39m[33m>[39m {
     [90m 499 |[39m     [36mawait[39m offlineDB[33m.[39maddToSyncQueue({
    [31m[1m>[22m[39m[90m 500 |[39m       uuid[33m:[39m crypto[33m.[39mrandomUUID()[33m,[39m
     [90m     |[39m                    [31m[1m^[22m[39m
     [90m 501 |[39m       type[33m,[39m
     [90m 502 |[39m       action[33m,[39m
     [90m 503 |[39m       entityUuid[33m,[39m[0m

      at SyncEngine.randomUUID (src/lib/sync/engine.ts:500:20)
      at Object.addToQueue (tests/unit/sync/engine.test.ts:308:24)

  ‚óè SyncEngine ‚Ä∫ queue management ‚Ä∫ should get queue status

    expect(received).toEqual(expected) // deep equality

    - Expected  - 1
    + Received  + 1

      Object {
        "failedItems": 1,
    -   "isOnline": true,
    +   "isOnline": false,
        "oldestItem": 2024-01-01T00:00:00.000Z,
        "pendingItems": 1,
        "syncInProgress": false,
        "totalItems": 2,
      }

    [0m [90m 335 |[39m       [36mconst[39m status [33m=[39m [36mawait[39m syncEngine[33m.[39mgetQueueStatus()[33m;[39m
     [90m 336 |[39m
    [31m[1m>[22m[39m[90m 337 |[39m       expect(status)[33m.[39mtoEqual({
     [90m     |[39m                      [31m[1m^[22m[39m
     [90m 338 |[39m         totalItems[33m:[39m [35m2[39m[33m,[39m
     [90m 339 |[39m         pendingItems[33m:[39m [35m1[39m[33m,[39m [90m// Only item1 (attempts < 3)[39m
     [90m 340 |[39m         failedItems[33m:[39m [35m1[39m[33m,[39m  [90m// Only item2 (attempts >= 3)[39m[0m

      at Object.toEqual (tests/unit/sync/engine.test.ts:337:22)

  ‚óè SyncEngine ‚Ä∫ queue management ‚Ä∫ should retry failed items

    expect(jest.fn()).toHaveBeenCalled()

    Expected number of calls: >= 1
    Received number of calls:    0

    [0m [90m 375 |[39m       [36mawait[39m syncEngine[33m.[39mretryFailedItems()[33m;[39m
     [90m 376 |[39m
    [31m[1m>[22m[39m[90m 377 |[39m       expect(triggerSyncSpy)[33m.[39mtoHaveBeenCalled()[33m;[39m
     [90m     |[39m                              [31m[1m^[22m[39m
     [90m 378 |[39m     })[33m;[39m
     [90m 379 |[39m   })[33m;[39m
     [90m 380 |[39m[0m

      at Object.toHaveBeenCalled (tests/unit/sync/engine.test.ts:377:30)

  ‚óè SyncEngine ‚Ä∫ retry logic ‚Ä∫ should implement exponential backoff

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "item1", ObjectContaining {"attempts": 2, "nextRetry": Any<Date>}

    Number of calls: 0

    [0m [90m 410 |[39m       [36mawait[39m syncEngine[33m.[39mtriggerSync()[33m;[39m
     [90m 411 |[39m
    [31m[1m>[22m[39m[90m 412 |[39m       expect(offlineDB[33m.[39mupdateSyncQueueItem)[33m.[39mtoHaveBeenCalledWith(
     [90m     |[39m                                             [31m[1m^[22m[39m
     [90m 413 |[39m         [32m'item1'[39m[33m,[39m
     [90m 414 |[39m         expect[33m.[39mobjectContaining({
     [90m 415 |[39m           attempts[33m:[39m [35m2[39m[33m,[39m[0m

      at Object.toHaveBeenCalledWith (tests/unit/sync/engine.test.ts:412:45)

  ‚óè SyncEngine ‚Ä∫ retry logic ‚Ä∫ should give up after max retries

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "item1"

    Number of calls: 0

    [0m [90m 449 |[39m       [36mawait[39m syncEngine[33m.[39mtriggerSync()[33m;[39m
     [90m 450 |[39m
    [31m[1m>[22m[39m[90m 451 |[39m       expect(offlineDB[33m.[39mremoveSyncQueueItem)[33m.[39mtoHaveBeenCalledWith([32m'item1'[39m)[33m;[39m
     [90m     |[39m                                             [31m[1m^[22m[39m
     [90m 452 |[39m     })[33m;[39m
     [90m 453 |[39m   })[33m;[39m
     [90m 454 |[39m[0m

      at Object.toHaveBeenCalledWith (tests/unit/sync/engine.test.ts:451:45)

  ‚óè SyncEngine ‚Ä∫ error handling ‚Ä∫ should handle malformed server responses

    expect(received).toHaveLength(expected)

    Matcher error: received value must have a length property whose value must be a number

    Received has value: undefined

    [0m [90m 475 |[39m       [36mconst[39m result [33m=[39m [36mawait[39m syncEngine[33m.[39mtriggerSync()[33m;[39m
     [90m 476 |[39m
    [31m[1m>[22m[39m[90m 477 |[39m       expect(result[33m?[39m[33m.[39mfailed)[33m.[39mtoHaveLength([35m1[39m)[33m;[39m
     [90m     |[39m                              [31m[1m^[22m[39m
     [90m 478 |[39m       expect(result[33m?[39m[33m.[39mfailed[[35m0[39m][33m.[39mmessage)[33m.[39mtoContain([32m'Invalid JSON'[39m)[33m;[39m
     [90m 479 |[39m     })[33m;[39m
     [90m 480 |[39m[0m

      at Object.toHaveLength (tests/unit/sync/engine.test.ts:477:30)

  ‚óè SyncEngine ‚Ä∫ error handling ‚Ä∫ should handle HTTP error responses

    expect(received).toHaveLength(expected)

    Matcher error: received value must have a length property whose value must be a number

    Received has value: undefined

    [0m [90m 488 |[39m       [36mconst[39m result [33m=[39m [36mawait[39m syncEngine[33m.[39mtriggerSync()[33m;[39m
     [90m 489 |[39m
    [31m[1m>[22m[39m[90m 490 |[39m       expect(result[33m?[39m[33m.[39mfailed)[33m.[39mtoHaveLength([35m1[39m)[33m;[39m
     [90m     |[39m                              [31m[1m^[22m[39m
     [90m 491 |[39m       expect(result[33m?[39m[33m.[39mfailed[[35m0[39m][33m.[39mmessage)[33m.[39mtoContain([32m'500'[39m)[33m;[39m
     [90m 492 |[39m     })[33m;[39m
     [90m 493 |[39m   })[33m;[39m[0m

      at Object.toHaveLength (tests/unit/sync/engine.test.ts:490:30)

PASS tests/unit/api/preliminary-assessment.test.ts
FAIL tests/unit/services/auto-assignment.test.ts
  ‚óè Console

    console.log
      Auto-assigned user user123 to entity entity123 (COMMUNITY)

      at Function.log [as autoAssignOnCreation] (src/lib/assignment/auto-assignment.ts:141:15)

    console.error
      Entity not found: nonexistent

    [0m [90m  96 |[39m
     [90m  97 |[39m       [36mif[39m ([33m![39mentity) {
    [31m[1m>[22m[39m[90m  98 |[39m         console[33m.[39merror([32m`Entity not found: ${entityId}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m  99 |[39m         [36mreturn[39m [36mfalse[39m[33m;[39m
     [90m 100 |[39m       }
     [90m 101 |[39m[0m

      at Function.error [as autoAssignOnCreation] (src/lib/assignment/auto-assignment.ts:98:17)
      at Object.<anonymous> (tests/unit/services/auto-assignment.test.ts:151:22)

    console.error
      Error in auto-assignment: Error: Database error
          at Object.<anonymous> (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\services\auto-assignment.test.ts:163:65)
          at Promise.then.completed (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:316:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
          at run (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
          at runTestInternal (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:367:16)
          at runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:444:34)
          at Object.worker (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\testWorker.js:106:12)

    [0m [90m 143 |[39m
     [90m 144 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 145 |[39m       console[33m.[39merror([32m'Error in auto-assignment:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 146 |[39m       [36mreturn[39m [36mfalse[39m[33m;[39m
     [90m 147 |[39m     }
     [90m 148 |[39m   }[0m

      at Function.error [as autoAssignOnCreation] (src/lib/assignment/auto-assignment.ts:145:15)
      at Object.<anonymous> (tests/unit/services/auto-assignment.test.ts:165:22)

    console.log
      Inherited assignment for user user123 from entity123 to target123

      at Function.log [as inheritAssignments] (src/lib/assignment/auto-assignment.ts:220:15)

  ‚óè AutoAssignmentService ‚Ä∫ bulkAutoAssignOnEntityCreation ‚Ä∫ should auto-assign creator when they have appropriate roles

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "creator123", "entity123", "RESPONDER", "creator123"
    Received: "creator123", "entity123", "ASSESSOR", "creator123"

    Number of calls: 1

    [0m [90m 343 |[39m
     [90m 344 |[39m       expect(autoAssignSpy)[33m.[39mtoHaveBeenCalledWith([32m'creator123'[39m[33m,[39m [32m'entity123'[39m[33m,[39m [32m'ASSESSOR'[39m[33m,[39m [32m'creator123'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 345 |[39m       expect(autoAssignSpy)[33m.[39mtoHaveBeenCalledWith([32m'creator123'[39m[33m,[39m [32m'entity123'[39m[33m,[39m [32m'RESPONDER'[39m[33m,[39m [32m'creator123'[39m)[33m;[39m
     [90m     |[39m                             [31m[1m^[22m[39m
     [90m 346 |[39m
     [90m 347 |[39m       autoAssignSpy[33m.[39mmockRestore()[33m;[39m
     [90m 348 |[39m     })[33m;[39m[0m

      at Object.toHaveBeenCalledWith (tests/unit/services/auto-assignment.test.ts:345:29)

FAIL tests/integration/assignments/assignment-workflow.test.ts
  ‚óè Assignment Workflow Integration Tests ‚Ä∫ Complete Assignment Creation Workflow ‚Ä∫ should create assignment and trigger auto-assignment

    TypeError: Cannot read properties of undefined (reading 'findUnique')

    [0m [90m 67 |[39m       [90m// Mock Prisma operations for assignment creation[39m
     [90m 68 |[39m       [36mconst[39m mockPrisma [33m=[39m require([32m'@/lib/db/client'[39m)[33m.[39mprisma[33m;[39m
    [31m[1m>[22m[39m[90m 69 |[39m       mockPrisma[33m.[39muser[33m.[39mfindUnique[33m.[39mmockResolvedValue(mockAssessor)[33m;[39m
     [90m    |[39m                       [31m[1m^[22m[39m
     [90m 70 |[39m       mockPrisma[33m.[39mentity[33m.[39mfindUnique[33m.[39mmockResolvedValue(mockEntity)[33m;[39m
     [90m 71 |[39m       mockPrisma[33m.[39mentityAssignment[33m.[39mfindUnique[33m.[39mmockResolvedValue([36mnull[39m)[33m;[39m
     [90m 72 |[39m       mockPrisma[33m.[39mentityAssignment[33m.[39mcreate[33m.[39mmockResolvedValue(mockAssignment)[33m;[39m[0m

      at Object.findUnique (tests/integration/assignments/assignment-workflow.test.ts:69:23)

  ‚óè Assignment Workflow Integration Tests ‚Ä∫ Complete Assignment Creation Workflow ‚Ä∫ should handle bulk assignment with collaboration tracking

    TypeError: Cannot read properties of undefined (reading 'findMany')

    [0m [90m 126 |[39m
     [90m 127 |[39m       [36mconst[39m mockPrisma [33m=[39m require([32m'@/lib/db/client'[39m)[33m.[39mprisma[33m;[39m
    [31m[1m>[22m[39m[90m 128 |[39m       mockPrisma[33m.[39muser[33m.[39mfindMany[33m.[39mmockResolvedValue([mockAssessor[33m,[39m mockResponder])[33m;[39m
     [90m     |[39m                       [31m[1m^[22m[39m
     [90m 129 |[39m       mockPrisma[33m.[39mentity[33m.[39mfindMany[33m.[39mmockResolvedValue([mockEntity])[33m;[39m
     [90m 130 |[39m       mockPrisma[33m.[39mentityAssignment[33m.[39mfindMany[33m.[39mmockResolvedValue([])[33m;[39m
     [90m 131 |[39m       mockPrisma[33m.[39m$transaction[33m.[39mmockResolvedValue(mockBulkAssignments)[33m;[39m[0m

      at Object.findMany (tests/integration/assignments/assignment-workflow.test.ts:128:23)

  ‚óè Assignment Workflow Integration Tests ‚Ä∫ Error Handling and Edge Cases ‚Ä∫ should handle auto-assignment rule configuration

    expect(received).toBe(expected) // Object.is equality

    Expected: false
    Received: undefined

    [0m [90m 241 |[39m       })[33m;[39m
     [90m 242 |[39m
    [31m[1m>[22m[39m[90m 243 |[39m       expect([33mAutoAssignmentService[39m[33m.[39misAutoAssignmentEnabled([32m'COMMUNITY'[39m[33m,[39m [32m'ASSESSOR'[39m))[33m.[39mtoBe([36mfalse[39m)[33m;[39m
     [90m     |[39m                                                                                      [31m[1m^[22m[39m
     [90m 244 |[39m
     [90m 245 |[39m       [90m// Re-enable auto-assignment[39m
     [90m 246 |[39m       [33mAutoAssignmentService[39m[33m.[39mupdateConfig({[0m

      at Object.toBe (tests/integration/assignments/assignment-workflow.test.ts:243:86)

  ‚óè Assignment Workflow Integration Tests ‚Ä∫ Performance and Scalability ‚Ä∫ should handle large bulk assignments efficiently

    TypeError: Cannot read properties of undefined (reading 'findMany')

    [0m [90m 294 |[39m
     [90m 295 |[39m       [36mconst[39m mockPrisma [33m=[39m require([32m'@/lib/db/client'[39m)[33m.[39mprisma[33m;[39m
    [31m[1m>[22m[39m[90m 296 |[39m       mockPrisma[33m.[39muser[33m.[39mfindMany[33m.[39mmockResolvedValue(largeUserList)[33m;[39m
     [90m     |[39m                       [31m[1m^[22m[39m
     [90m 297 |[39m       mockPrisma[33m.[39mentity[33m.[39mfindMany[33m.[39mmockResolvedValue(largeEntityList)[33m;[39m
     [90m 298 |[39m       mockPrisma[33m.[39mentityAssignment[33m.[39mfindMany[33m.[39mmockResolvedValue([])[33m;[39m
     [90m 299 |[39m[0m

      at Object.findMany (tests/integration/assignments/assignment-workflow.test.ts:296:23)

  ‚óè Assignment Workflow Integration Tests ‚Ä∫ Data Consistency and Validation ‚Ä∫ should maintain data consistency during concurrent operations

    TypeError: Cannot read properties of undefined (reading 'findUnique')

    [0m [90m 380 |[39m       
     [90m 381 |[39m       [90m// First request succeeds[39m
    [31m[1m>[22m[39m[90m 382 |[39m       mockPrisma[33m.[39mentityAssignment[33m.[39mfindUnique
     [90m     |[39m                                   [31m[1m^[22m[39m
     [90m 383 |[39m         [33m.[39mmockResolvedValueOnce([36mnull[39m) [90m// No existing assignment[39m
     [90m 384 |[39m         [33m.[39mmockResolvedValueOnce(mockAssignment)[33m;[39m [90m// Assignment exists on second check[39m
     [90m 385 |[39m[0m

      at Object.findUnique (tests/integration/assignments/assignment-workflow.test.ts:382:35)

  ‚óè Assignment Workflow Integration Tests ‚Ä∫ Data Consistency and Validation ‚Ä∫ should validate role-based access throughout workflow

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/integration/assignments/assignment-workflow.test.ts:435:23)

FAIL tests/integration/auth/endpoints.test.ts
  ‚óè Authentication API Endpoints ‚Ä∫ POST /api/v1/auth/login ‚Ä∫ should authenticate user successfully

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/integration/auth/endpoints.test.ts:46:23)

  ‚óè Authentication API Endpoints ‚Ä∫ POST /api/v1/auth/login ‚Ä∫ should return 400 for invalid input

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/integration/auth/endpoints.test.ts:67:23)

  ‚óè Authentication API Endpoints ‚Ä∫ POST /api/v1/auth/login ‚Ä∫ should return 401 for invalid credentials

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/integration/auth/endpoints.test.ts:89:23)

  ‚óè Authentication API Endpoints ‚Ä∫ POST /api/v1/auth/login ‚Ä∫ should handle account locked error

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/integration/auth/endpoints.test.ts:110:23)

  ‚óè Authentication API Endpoints ‚Ä∫ GET /api/v1/auth/me ‚Ä∫ should return current user data

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/integration/auth/endpoints.test.ts:157:23)

  ‚óè Authentication API Endpoints ‚Ä∫ GET /api/v1/auth/me ‚Ä∫ should return 401 for missing token

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/integration/auth/endpoints.test.ts:173:23)

  ‚óè Authentication API Endpoints ‚Ä∫ GET /api/v1/auth/me ‚Ä∫ should return 401 for invalid token

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/integration/auth/endpoints.test.ts:189:23)

  ‚óè Authentication API Endpoints ‚Ä∫ POST /api/v1/auth/refresh ‚Ä∫ should refresh token successfully

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/integration/auth/endpoints.test.ts:217:23)

  ‚óè Authentication API Endpoints ‚Ä∫ POST /api/v1/auth/refresh ‚Ä∫ should return 401 for expired token

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/integration/auth/endpoints.test.ts:236:23)

PASS tests/unit/auth/service.test.ts
FAIL tests/unit/components/EntityAssignmentInterface.test.tsx
  ‚óè Test suite failed to run

    Configuration error:

    Could not locate module @/components/features/assignments/AssignmentTable mapped as:
    B:\Dev\Claude Code\dms-v3-bmad-archon\src\$1.

    Please check your configuration for these entries:
    {
      "moduleNameMapper": {
        "/^@\/(.*)$/": "B:\Dev\Claude Code\dms-v3-bmad-archon\src\$1"
      },
      "resolver": undefined
    }

    [0m [90m 11 |[39m
     [90m 12 |[39m [90m// Mock the child components[39m
    [31m[1m>[22m[39m[90m 13 |[39m jest[33m.[39mmock([32m'@/components/features/assignments/AssignmentTable'[39m[33m,[39m () [33m=>[39m ({
     [90m    |[39m      [31m[1m^[22m[39m
     [90m 14 |[39m   [33mAssignmentTable[39m[33m:[39m ({ assignments[33m,[39m onDeleteAssignment }[33m:[39m any) [33m=>[39m (
     [90m 15 |[39m     [33m<[39m[33mdiv[39m data[33m-[39mtestid[33m=[39m[32m"assignment-table"[39m[33m>[39m
     [90m 16 |[39m       {assignments[33m.[39mmap((assignment[33m:[39m any) [33m=>[39m ([0m

      at createNoMappedModuleFoundError (node_modules/jest-resolve/build/resolver.js:759:17)
      at Object.mock (tests/unit/components/EntityAssignmentInterface.test.tsx:13:6)

FAIL tests/unit/api/entity-assignments.test.ts
  ‚óè Entity Assignment API Endpoints ‚Ä∫ POST /api/v1/entity-assignments ‚Ä∫ should create a new assignment successfully

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/unit/api/entity-assignments.test.ts:97:23)

  ‚óè Entity Assignment API Endpoints ‚Ä∫ POST /api/v1/entity-assignments ‚Ä∫ should reject assignment if user lacks coordinator role

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/unit/api/entity-assignments.test.ts:135:23)

  ‚óè Entity Assignment API Endpoints ‚Ä∫ POST /api/v1/entity-assignments ‚Ä∫ should reject assignment if target user not found

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/unit/api/entity-assignments.test.ts:163:23)

  ‚óè Entity Assignment API Endpoints ‚Ä∫ POST /api/v1/entity-assignments ‚Ä∫ should reject assignment if user lacks appropriate role

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/unit/api/entity-assignments.test.ts:196:23)

  ‚óè Entity Assignment API Endpoints ‚Ä∫ POST /api/v1/entity-assignments ‚Ä∫ should reject assignment if assignment already exists

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/unit/api/entity-assignments.test.ts:226:23)

  ‚óè Entity Assignment API Endpoints ‚Ä∫ GET /api/v1/entity-assignments ‚Ä∫ should fetch assignments with pagination

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/unit/api/entity-assignments.test.ts:258:23)

  ‚óè Entity Assignment API Endpoints ‚Ä∫ DELETE /api/v1/entity-assignments/[id] ‚Ä∫ should delete assignment successfully

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/unit/api/entity-assignments.test.ts:291:9)

  ‚óè Entity Assignment API Endpoints ‚Ä∫ DELETE /api/v1/entity-assignments/[id] ‚Ä∫ should return 404 if assignment not found

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/unit/api/entity-assignments.test.ts:317:9)

  ‚óè Entity Assignment API Endpoints ‚Ä∫ POST /api/v1/entity-assignments/bulk ‚Ä∫ should create bulk assignments successfully

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/unit/api/entity-assignments.test.ts:347:23)

  ‚óè Entity Assignment API Endpoints ‚Ä∫ POST /api/v1/entity-assignments/bulk ‚Ä∫ should handle missing users in bulk assignment

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/unit/api/entity-assignments.test.ts:378:23)

  ‚óè Entity Assignment API Endpoints ‚Ä∫ POST /api/v1/entity-assignments/bulk ‚Ä∫ should skip existing assignments in bulk operation

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/unit/api/entity-assignments.test.ts:413:23)

FAIL tests/integration/response-planning/api.test.ts
  ‚óè Test suite failed to run

    Cannot find module '../helpers/test-client' from 'tests/integration/response-planning/api.test.ts'

    [0m [90m 4 |[39m
     [90m 5 |[39m describe([32m'Response Planning API Integration'[39m[33m,[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   [36mlet[39m testClient[33m:[39m [33mTestClient[39m
     [90m   |[39m                     [31m[1m^[22m[39m
     [90m 7 |[39m   [36mlet[39m testUserId[33m:[39m string
     [90m 8 |[39m   [36mlet[39m testEntityId[33m:[39m string
     [90m 9 |[39m   [36mlet[39m testAssessmentId[33m:[39m string[0m

      at Resolver._throwModNotFoundError (node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.<anonymous> (tests/integration/response-planning/api.test.ts:6:21)

PASS tests/unit/auth/role-switching.test.ts
FAIL tests/integration/rapid-assessments/workflows.test.ts
  ‚óè Test suite failed to run

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     ‚Ä¢ If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     ‚Ä¢ If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     ‚Ä¢ To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     ‚Ä¢ If you need a custom transformation specify a "transform" option in your config.
     ‚Ä¢ If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\uuid\dist\index.js:1
    ({"Object.<anonymous>":function(module,exports,require,__dirname,__filename,jest){export { default as MAX } from './max.js';
                                                                                      ^^^^^^

    SyntaxError: Unexpected token 'export'

    [0m[0m

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at Object.<anonymous> (src/app/api/v1/rapid-assessments/route.ts:1041:27)
      at Object.<anonymous> (tests/integration/rapid-assessments/workflows.test.ts:22:16)

FAIL tests/unit/components/PreliminaryAssessmentForm.test.tsx
  ‚óè Test suite failed to run

    Cannot find module '@testing-library/user-event' from 'tests/unit/components/PreliminaryAssessmentForm.test.tsx'

    [0m [90m 29 |[39m     user[33m:[39m {
     [90m 30 |[39m       id[33m:[39m [32m'test-user'[39m[33m,[39m
    [31m[1m>[22m[39m[90m 31 |[39m       name[33m:[39m [32m'Test User'[39m[33m,[39m
     [90m    |[39m                                                       [31m[1m^[22m[39m
     [90m 32 |[39m       email[33m:[39m [32m'test@example.com'[39m[33m,[39m
     [90m 33 |[39m     }[33m,[39m
     [90m 34 |[39m   })[33m,[39m[0m

      at Resolver._throwModNotFoundError (node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.<anonymous> (tests/unit/components/PreliminaryAssessmentForm.test.tsx:31:59)

FAIL tests/integration/assessments/preliminary-assessment-workflow.test.ts
  ‚óè Test suite failed to run

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     ‚Ä¢ If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     ‚Ä¢ If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     ‚Ä¢ To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     ‚Ä¢ If you need a custom transformation specify a "transform" option in your config.
     ‚Ä¢ If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\uuid\dist\index.js:1
    ({"Object.<anonymous>":function(module,exports,require,__dirname,__filename,jest){export { default as MAX } from './max.js';
                                                                                      ^^^^^^

    SyntaxError: Unexpected token 'export'

    [0m[0m

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at Object.<anonymous> (src/app/api/v1/preliminary-assessments/route.ts:349:27)
      at Object.<anonymous> (tests/integration/assessments/preliminary-assessment-workflow.test.ts:7:16)

FAIL tests/integration/auth/role-switching.test.ts
  ‚óè Test suite failed to run

    Cannot find module 'supertest' from 'tests/integration/auth/role-switching.test.ts'

    [0m [90m 3 |[39m [36mimport[39m { app } [36mfrom[39m [32m'next/app'[39m[33m;[39m [90m// Note: This might need adjustment based on your setup[39m
     [90m 4 |[39m
    [31m[1m>[22m[39m[90m 5 |[39m describe([32m'Role Switching Integration Tests'[39m[33m,[39m () [33m=>[39m {
     [90m   |[39m                                                           [31m[1m^[22m[39m
     [90m 6 |[39m   [36mlet[39m authToken[33m:[39m string[33m;[39m
     [90m 7 |[39m   [36mlet[39m userId[33m:[39m string[33m;[39m
     [90m 8 |[39m[0m

      at Resolver._throwModNotFoundError (node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.<anonymous> (tests/integration/auth/role-switching.test.ts:5:59)

FAIL tests/unit/api/rapid-assessment-endpoints.test.ts
  ‚óè Test suite failed to run

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     ‚Ä¢ If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     ‚Ä¢ If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     ‚Ä¢ To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     ‚Ä¢ If you need a custom transformation specify a "transform" option in your config.
     ‚Ä¢ If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\uuid\dist\index.js:1
    ({"Object.<anonymous>":function(module,exports,require,__dirname,__filename,jest){export { default as MAX } from './max.js';
                                                                                      ^^^^^^

    SyntaxError: Unexpected token 'export'

    [0m[0m

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at Object.<anonymous> (src/app/api/v1/rapid-assessments/route.ts:1041:27)
      at Object.<anonymous> (tests/unit/api/rapid-assessment-endpoints.test.ts:23:16)

FAIL tests/unit/forms/health-assessment-form.test.tsx
  ‚óè Test suite failed to run

    Cannot find module '@testing-library/user-event' from 'tests/unit/forms/health-assessment-form.test.tsx'

    [0m [90m 69 |[39m   jest[33m.[39mclearAllMocks()
     [90m 70 |[39m })
    [31m[1m>[22m[39m[90m 71 |[39m
     [90m    |[39m [31m[1m^[22m[39m
     [90m 72 |[39m describe([32m'HealthAssessmentForm'[39m[33m,[39m () [33m=>[39m {
     [90m 73 |[39m   [36mconst[39m defaultProps [33m=[39m {
     [90m 74 |[39m     entityId[33m:[39m [32m'entity-1'[39m[33m,[39m[0m

      at Resolver._throwModNotFoundError (node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.<anonymous> (tests/unit/forms/health-assessment-form.test.tsx:71:59)

FAIL tests/unit/components/ResponsePlanningForm.test.tsx
  ‚óè ResponsePlanningForm Component ‚Ä∫ Form Rendering ‚Ä∫ should render all form fields in create mode

    TypeError: mockUseOffline.mockReturnValue is not a function

    [0m [90m 79 |[39m
     [90m 80 |[39m     [90m// Setup default offline mock[39m
    [31m[1m>[22m[39m[90m 81 |[39m     mockUseOffline[33m.[39mmockReturnValue({
     [90m    |[39m                    [31m[1m^[22m[39m
     [90m 82 |[39m       isOnline[33m:[39m [36mtrue[39m[33m,[39m
     [90m 83 |[39m       isSyncing[33m:[39m [36mfalse[39m[33m,[39m
     [90m 84 |[39m       syncProgress[33m:[39m [35m0[39m[33m,[39m[0m

      at Object.mockReturnValue (tests/unit/components/ResponsePlanningForm.test.tsx:81:20)

  ‚óè ResponsePlanningForm Component ‚Ä∫ Form Rendering ‚Ä∫ should render in edit mode with correct title

    TypeError: mockUseOffline.mockReturnValue is not a function

    [0m [90m 79 |[39m
     [90m 80 |[39m     [90m// Setup default offline mock[39m
    [31m[1m>[22m[39m[90m 81 |[39m     mockUseOffline[33m.[39mmockReturnValue({
     [90m    |[39m                    [31m[1m^[22m[39m
     [90m 82 |[39m       isOnline[33m:[39m [36mtrue[39m[33m,[39m
     [90m 83 |[39m       isSyncing[33m:[39m [36mfalse[39m[33m,[39m
     [90m 84 |[39m       syncProgress[33m:[39m [35m0[39m[33m,[39m[0m

      at Object.mockReturnValue (tests/unit/components/ResponsePlanningForm.test.tsx:81:20)

  ‚óè ResponsePlanningForm Component ‚Ä∫ Form Rendering ‚Ä∫ should show online status indicators

    TypeError: mockUseOffline.mockReturnValue is not a function

    [0m [90m 79 |[39m
     [90m 80 |[39m     [90m// Setup default offline mock[39m
    [31m[1m>[22m[39m[90m 81 |[39m     mockUseOffline[33m.[39mmockReturnValue({
     [90m    |[39m                    [31m[1m^[22m[39m
     [90m 82 |[39m       isOnline[33m:[39m [36mtrue[39m[33m,[39m
     [90m 83 |[39m       isSyncing[33m:[39m [36mfalse[39m[33m,[39m
     [90m 84 |[39m       syncProgress[33m:[39m [35m0[39m[33m,[39m[0m

      at Object.mockReturnValue (tests/unit/components/ResponsePlanningForm.test.tsx:81:20)

  ‚óè ResponsePlanningForm Component ‚Ä∫ Form Rendering ‚Ä∫ should show offline status indicators

    TypeError: mockUseOffline.mockReturnValue is not a function

    [0m [90m 79 |[39m
     [90m 80 |[39m     [90m// Setup default offline mock[39m
    [31m[1m>[22m[39m[90m 81 |[39m     mockUseOffline[33m.[39mmockReturnValue({
     [90m    |[39m                    [31m[1m^[22m[39m
     [90m 82 |[39m       isOnline[33m:[39m [36mtrue[39m[33m,[39m
     [90m 83 |[39m       isSyncing[33m:[39m [36mfalse[39m[33m,[39m
     [90m 84 |[39m       syncProgress[33m:[39m [35m0[39m[33m,[39m[0m

      at Object.mockReturnValue (tests/unit/components/ResponsePlanningForm.test.tsx:81:20)

  ‚óè ResponsePlanningForm Component ‚Ä∫ Form Rendering ‚Ä∫ should show sync progress when syncing

    TypeError: mockUseOffline.mockReturnValue is not a function

    [0m [90m 79 |[39m
     [90m 80 |[39m     [90m// Setup default offline mock[39m
    [31m[1m>[22m[39m[90m 81 |[39m     mockUseOffline[33m.[39mmockReturnValue({
     [90m    |[39m                    [31m[1m^[22m[39m
     [90m 82 |[39m       isOnline[33m:[39m [36mtrue[39m[33m,[39m
     [90m 83 |[39m       isSyncing[33m:[39m [36mfalse[39m[33m,[39m
     [90m 84 |[39m       syncProgress[33m:[39m [35m0[39m[33m,[39m[0m

      at Object.mockReturnValue (tests/unit/components/ResponsePlanningForm.test.tsx:81:20)

  ‚óè ResponsePlanningForm Component ‚Ä∫ Form Validation ‚Ä∫ should validate required fields

    TypeError: mockUseOffline.mockReturnValue is not a function

    [0m [90m 79 |[39m
     [90m 80 |[39m     [90m// Setup default offline mock[39m
    [31m[1m>[22m[39m[90m 81 |[39m     mockUseOffline[33m.[39mmockReturnValue({
     [90m    |[39m                    [31m[1m^[22m[39m
     [90m 82 |[39m       isOnline[33m:[39m [36mtrue[39m[33m,[39m
     [90m 83 |[39m       isSyncing[33m:[39m [36mfalse[39m[33m,[39m
     [90m 84 |[39m       syncProgress[33m:[39m [35m0[39m[33m,[39m[0m

      at Object.mockReturnValue (tests/unit/components/ResponsePlanningForm.test.tsx:81:20)

  ‚óè ResponsePlanningForm Component ‚Ä∫ Form Validation ‚Ä∫ should validate item fields

    TypeError: mockUseOffline.mockReturnValue is not a function

    [0m [90m 79 |[39m
     [90m 80 |[39m     [90m// Setup default offline mock[39m
    [31m[1m>[22m[39m[90m 81 |[39m     mockUseOffline[33m.[39mmockReturnValue({
     [90m    |[39m                    [31m[1m^[22m[39m
     [90m 82 |[39m       isOnline[33m:[39m [36mtrue[39m[33m,[39m
     [90m 83 |[39m       isSyncing[33m:[39m [36mfalse[39m[33m,[39m
     [90m 84 |[39m       syncProgress[33m:[39m [35m0[39m[33m,[39m[0m

      at Object.mockReturnValue (tests/unit/components/ResponsePlanningForm.test.tsx:81:20)

  ‚óè ResponsePlanningForm Component ‚Ä∫ Form Validation ‚Ä∫ should validate positive quantities

    TypeError: mockUseOffline.mockReturnValue is not a function

    [0m [90m 79 |[39m
     [90m 80 |[39m     [90m// Setup default offline mock[39m
    [31m[1m>[22m[39m[90m 81 |[39m     mockUseOffline[33m.[39mmockReturnValue({
     [90m    |[39m                    [31m[1m^[22m[39m
     [90m 82 |[39m       isOnline[33m:[39m [36mtrue[39m[33m,[39m
     [90m 83 |[39m       isSyncing[33m:[39m [36mfalse[39m[33m,[39m
     [90m 84 |[39m       syncProgress[33m:[39m [35m0[39m[33m,[39m[0m

      at Object.mockReturnValue (tests/unit/components/ResponsePlanningForm.test.tsx:81:20)

  ‚óè ResponsePlanningForm Component ‚Ä∫ Item Management ‚Ä∫ should add new items dynamically

    TypeError: mockUseOffline.mockReturnValue is not a function

    [0m [90m 79 |[39m
     [90m 80 |[39m     [90m// Setup default offline mock[39m
    [31m[1m>[22m[39m[90m 81 |[39m     mockUseOffline[33m.[39mmockReturnValue({
     [90m    |[39m                    [31m[1m^[22m[39m
     [90m 82 |[39m       isOnline[33m:[39m [36mtrue[39m[33m,[39m
     [90m 83 |[39m       isSyncing[33m:[39m [36mfalse[39m[33m,[39m
     [90m 84 |[39m       syncProgress[33m:[39m [35m0[39m[33m,[39m[0m

      at Object.mockReturnValue (tests/unit/components/ResponsePlanningForm.test.tsx:81:20)

  ‚óè ResponsePlanningForm Component ‚Ä∫ Item Management ‚Ä∫ should remove items when there are multiple

    TypeError: mockUseOffline.mockReturnValue is not a function

    [0m [90m 79 |[39m
     [90m 80 |[39m     [90m// Setup default offline mock[39m
    [31m[1m>[22m[39m[90m 81 |[39m     mockUseOffline[33m.[39mmockReturnValue({
     [90m    |[39m                    [31m[1m^[22m[39m
     [90m 82 |[39m       isOnline[33m:[39m [36mtrue[39m[33m,[39m
     [90m 83 |[39m       isSyncing[33m:[39m [36mfalse[39m[33m,[39m
     [90m 84 |[39m       syncProgress[33m:[39m [35m0[39m[33m,[39m[0m

      at Object.mockReturnValue (tests/unit/components/ResponsePlanningForm.test.tsx:81:20)

  ‚óè ResponsePlanningForm Component ‚Ä∫ Item Management ‚Ä∫ should not allow removing the last item

    TypeError: mockUseOffline.mockReturnValue is not a function

    [0m [90m 79 |[39m
     [90m 80 |[39m     [90m// Setup default offline mock[39m
    [31m[1m>[22m[39m[90m 81 |[39m     mockUseOffline[33m.[39mmockReturnValue({
     [90m    |[39m                    [31m[1m^[22m[39m
     [90m 82 |[39m       isOnline[33m:[39m [36mtrue[39m[33m,[39m
     [90m 83 |[39m       isSyncing[33m:[39m [36mfalse[39m[33m,[39m
     [90m 84 |[39m       syncProgress[33m:[39m [35m0[39m[33m,[39m[0m

      at Object.mockReturnValue (tests/unit/components/ResponsePlanningForm.test.tsx:81:20)

  ‚óè ResponsePlanningForm Component ‚Ä∫ Form Submission ‚Ä∫ should submit valid form successfully

    TypeError: mockUseOffline.mockReturnValue is not a function

    [0m [90m 79 |[39m
     [90m 80 |[39m     [90m// Setup default offline mock[39m
    [31m[1m>[22m[39m[90m 81 |[39m     mockUseOffline[33m.[39mmockReturnValue({
     [90m    |[39m                    [31m[1m^[22m[39m
     [90m 82 |[39m       isOnline[33m:[39m [36mtrue[39m[33m,[39m
     [90m 83 |[39m       isSyncing[33m:[39m [36mfalse[39m[33m,[39m
     [90m 84 |[39m       syncProgress[33m:[39m [35m0[39m[33m,[39m[0m

      at Object.mockReturnValue (tests/unit/components/ResponsePlanningForm.test.tsx:81:20)

  ‚óè ResponsePlanningForm Component ‚Ä∫ Form Submission ‚Ä∫ should handle offline submission

    TypeError: mockUseOffline.mockReturnValue is not a function

    [0m [90m 79 |[39m
     [90m 80 |[39m     [90m// Setup default offline mock[39m
    [31m[1m>[22m[39m[90m 81 |[39m     mockUseOffline[33m.[39mmockReturnValue({
     [90m    |[39m                    [31m[1m^[22m[39m
     [90m 82 |[39m       isOnline[33m:[39m [36mtrue[39m[33m,[39m
     [90m 83 |[39m       isSyncing[33m:[39m [36mfalse[39m[33m,[39m
     [90m 84 |[39m       syncProgress[33m:[39m [35m0[39m[33m,[39m[0m

      at Object.mockReturnValue (tests/unit/components/ResponsePlanningForm.test.tsx:81:20)

  ‚óè ResponsePlanningForm Component ‚Ä∫ Form Submission ‚Ä∫ should handle submission errors

    TypeError: mockUseOffline.mockReturnValue is not a function

    [0m [90m 79 |[39m
     [90m 80 |[39m     [90m// Setup default offline mock[39m
    [31m[1m>[22m[39m[90m 81 |[39m     mockUseOffline[33m.[39mmockReturnValue({
     [90m    |[39m                    [31m[1m^[22m[39m
     [90m 82 |[39m       isOnline[33m:[39m [36mtrue[39m[33m,[39m
     [90m 83 |[39m       isSyncing[33m:[39m [36mfalse[39m[33m,[39m
     [90m 84 |[39m       syncProgress[33m:[39m [35m0[39m[33m,[39m[0m

      at Object.mockReturnValue (tests/unit/components/ResponsePlanningForm.test.tsx:81:20)

  ‚óè ResponsePlanningForm Component ‚Ä∫ Collaboration Features ‚Ä∫ should show collaboration status in edit mode

    TypeError: mockUseOffline.mockReturnValue is not a function

    [0m [90m 79 |[39m
     [90m 80 |[39m     [90m// Setup default offline mock[39m
    [31m[1m>[22m[39m[90m 81 |[39m     mockUseOffline[33m.[39mmockReturnValue({
     [90m    |[39m                    [31m[1m^[22m[39m
     [90m 82 |[39m       isOnline[33m:[39m [36mtrue[39m[33m,[39m
     [90m 83 |[39m       isSyncing[33m:[39m [36mfalse[39m[33m,[39m
     [90m 84 |[39m       syncProgress[33m:[39m [35m0[39m[33m,[39m[0m

      at Object.mockReturnValue (tests/unit/components/ResponsePlanningForm.test.tsx:81:20)

  ‚óè ResponsePlanningForm Component ‚Ä∫ Cancel Behavior ‚Ä∫ should call onCancel when cancel button is clicked

    TypeError: mockUseOffline.mockReturnValue is not a function

    [0m [90m 79 |[39m
     [90m 80 |[39m     [90m// Setup default offline mock[39m
    [31m[1m>[22m[39m[90m 81 |[39m     mockUseOffline[33m.[39mmockReturnValue({
     [90m    |[39m                    [31m[1m^[22m[39m
     [90m 82 |[39m       isOnline[33m:[39m [36mtrue[39m[33m,[39m
     [90m 83 |[39m       isSyncing[33m:[39m [36mfalse[39m[33m,[39m
     [90m 84 |[39m       syncProgress[33m:[39m [35m0[39m[33m,[39m[0m

      at Object.mockReturnValue (tests/unit/components/ResponsePlanningForm.test.tsx:81:20)

  ‚óè ResponsePlanningForm Component ‚Ä∫ Cancel Behavior ‚Ä∫ should show confirmation dialog when form is dirty

    TypeError: mockUseOffline.mockReturnValue is not a function

    [0m [90m 79 |[39m
     [90m 80 |[39m     [90m// Setup default offline mock[39m
    [31m[1m>[22m[39m[90m 81 |[39m     mockUseOffline[33m.[39mmockReturnValue({
     [90m    |[39m                    [31m[1m^[22m[39m
     [90m 82 |[39m       isOnline[33m:[39m [36mtrue[39m[33m,[39m
     [90m 83 |[39m       isSyncing[33m:[39m [36mfalse[39m[33m,[39m
     [90m 84 |[39m       syncProgress[33m:[39m [35m0[39m[33m,[39m[0m

      at Object.mockReturnValue (tests/unit/components/ResponsePlanningForm.test.tsx:81:20)

FAIL tests/unit/components/HealthAssessmentForm.test.tsx
  ‚óè Console

    console.error
      Error: Uncaught [TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')]
          at reportException (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\helpers\runtime-script-errors.js:66:24)
          at innerInvokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:353:9)
          at invokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:286:3)
          at HTMLUnknownElementImpl._dispatch (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:233:9)
          at HTMLUnknownElementImpl.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:104:17)
          at HTMLUnknownElement.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:241:34)
          at Object.invokeGuardedCallbackDev (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4213:16)
          at invokeGuardedCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4277:31)
          at beginWork$1 (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:27490:7)
          at performUnitOfWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26599:12)
          at workLoopSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26505:5)
          at renderRootSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26473:7)
          at performConcurrentWorkOnRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25777:74)
          at flushActQueue (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2667:24)
          at act (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2582:11)
          at B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\act-compat.js:47:25
          at renderRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:190:26)
          at render (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:292:10)
          at renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:73:18)
          at Object.renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:85:5)
          at Promise.then.completed (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:316:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
          at run (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
          at runTestInternal (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:367:16)
          at runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:444:34)
          at Object.worker (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\testWorker.js:106:12) {
        detail: TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')
            at B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:131:56
            at Array.filter (<anonymous>)
            at filter (B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:131:26)
            at renderWithHooks (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:15486:18)
            at mountIndeterminateComponent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:20103:13)
            at beginWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:21626:16)
            at HTMLUnknownElement.callCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4164:14)
            at HTMLUnknownElement.callTheUserObjectsOperation (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventListener.js:26:30)
            at innerInvokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:350:25)
            at invokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:286:3)
            at HTMLUnknownElementImpl._dispatch (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:233:9)
            at HTMLUnknownElementImpl.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:104:17)
            at HTMLUnknownElement.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:241:34)
            at Object.invokeGuardedCallbackDev (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4213:16)
            at invokeGuardedCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4277:31)
            at beginWork$1 (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:27490:7)
            at performUnitOfWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26599:12)
            at workLoopSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26505:5)
            at renderRootSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26473:7)
            at performConcurrentWorkOnRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25777:74)
            at flushActQueue (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2667:24)
            at act (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2582:11)
            at B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\act-compat.js:47:25
            at renderRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:190:26)
            at render (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:292:10)
            at renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:73:18)
            at Object.renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:85:5)
            at Promise.then.completed (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:298:28)
            at new Promise (<anonymous>)
            at callAsyncCircusFn (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:231:10)
            at _callCircusTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:316:40)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at _runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:252:3)
            at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:126:9)
            at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
            at run (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:71:3)
            at runAndTransformResultsToJestFormat (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
            at jestAdapter (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
            at runTestInternal (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:367:16)
            at runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:444:34)
            at Object.worker (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\testWorker.js:106:12),
        type: 'unhandled exception'
      }

    [0m [90m 71 |[39m
     [90m 72 |[39m   [36mconst[39m renderForm [33m=[39m (initialData [33m=[39m {}) [33m=>[39m {
    [31m[1m>[22m[39m[90m 73 |[39m     [36mreturn[39m render(
     [90m    |[39m                  [31m[1m^[22m[39m
     [90m 74 |[39m       [33m<[39m[33mHealthAssessmentForm[39m
     [90m 75 |[39m         onSubmit[33m=[39m{mockOnSubmit}
     [90m 76 |[39m         onCancel[33m=[39m{mockOnCancel}[0m

      at VirtualConsole.<anonymous> (node_modules/jest-environment-jsdom/build/index.js:63:23)
      at reportException (node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:70:28)
      at innerInvokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
      at invokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
      at HTMLUnknownElementImpl._dispatch (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
      at HTMLUnknownElementImpl.dispatchEvent (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
      at HTMLUnknownElement.dispatchEvent (node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
      at Object.invokeGuardedCallbackDev (node_modules/react-dom/cjs/react-dom.development.js:4213:16)
      at invokeGuardedCallback (node_modules/react-dom/cjs/react-dom.development.js:4277:31)
      at beginWork$1 (node_modules/react-dom/cjs/react-dom.development.js:27490:7)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26599:12)
      at workLoopSync (node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25777:74)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:85:5)

    console.error
      Error: Uncaught [TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')]
          at reportException (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\helpers\runtime-script-errors.js:66:24)
          at innerInvokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:353:9)
          at invokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:286:3)
          at HTMLUnknownElementImpl._dispatch (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:233:9)
          at HTMLUnknownElementImpl.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:104:17)
          at HTMLUnknownElement.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:241:34)
          at Object.invokeGuardedCallbackDev (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4213:16)
          at invokeGuardedCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4277:31)
          at beginWork$1 (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:27490:7)
          at performUnitOfWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26599:12)
          at workLoopSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26505:5)
          at renderRootSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26473:7)
          at recoverFromConcurrentError (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25889:20)
          at performConcurrentWorkOnRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25789:22)
          at flushActQueue (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2667:24)
          at act (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2582:11)
          at B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\act-compat.js:47:25
          at renderRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:190:26)
          at render (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:292:10)
          at renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:73:18)
          at Object.renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:85:5)
          at Promise.then.completed (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:316:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
          at run (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
          at runTestInternal (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:367:16)
          at runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:444:34)
          at Object.worker (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\testWorker.js:106:12) {
        detail: TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')
            at B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:131:56
            at Array.filter (<anonymous>)
            at filter (B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:131:26)
            at renderWithHooks (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:15486:18)
            at mountIndeterminateComponent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:20103:13)
            at beginWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:21626:16)
            at HTMLUnknownElement.callCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4164:14)
            at HTMLUnknownElement.callTheUserObjectsOperation (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventListener.js:26:30)
            at innerInvokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:350:25)
            at invokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:286:3)
            at HTMLUnknownElementImpl._dispatch (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:233:9)
            at HTMLUnknownElementImpl.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:104:17)
            at HTMLUnknownElement.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:241:34)
            at Object.invokeGuardedCallbackDev (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4213:16)
            at invokeGuardedCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4277:31)
            at beginWork$1 (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:27490:7)
            at performUnitOfWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26599:12)
            at workLoopSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26505:5)
            at renderRootSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26473:7)
            at recoverFromConcurrentError (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25889:20)
            at performConcurrentWorkOnRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25789:22)
            at flushActQueue (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2667:24)
            at act (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2582:11)
            at B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\act-compat.js:47:25
            at renderRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:190:26)
            at render (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:292:10)
            at renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:73:18)
            at Object.renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:85:5)
            at Promise.then.completed (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:298:28)
            at new Promise (<anonymous>)
            at callAsyncCircusFn (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:231:10)
            at _callCircusTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:316:40)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at _runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:252:3)
            at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:126:9)
            at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
            at run (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:71:3)
            at runAndTransformResultsToJestFormat (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
            at jestAdapter (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
            at runTestInternal (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:367:16)
            at runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:444:34)
            at Object.worker (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\testWorker.js:106:12),
        type: 'unhandled exception'
      }

    [0m [90m 71 |[39m
     [90m 72 |[39m   [36mconst[39m renderForm [33m=[39m (initialData [33m=[39m {}) [33m=>[39m {
    [31m[1m>[22m[39m[90m 73 |[39m     [36mreturn[39m render(
     [90m    |[39m                  [31m[1m^[22m[39m
     [90m 74 |[39m       [33m<[39m[33mHealthAssessmentForm[39m
     [90m 75 |[39m         onSubmit[33m=[39m{mockOnSubmit}
     [90m 76 |[39m         onCancel[33m=[39m{mockOnCancel}[0m

      at VirtualConsole.<anonymous> (node_modules/jest-environment-jsdom/build/index.js:63:23)
      at reportException (node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:70:28)
      at innerInvokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
      at invokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
      at HTMLUnknownElementImpl._dispatch (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
      at HTMLUnknownElementImpl.dispatchEvent (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
      at HTMLUnknownElement.dispatchEvent (node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
      at Object.invokeGuardedCallbackDev (node_modules/react-dom/cjs/react-dom.development.js:4213:16)
      at invokeGuardedCallback (node_modules/react-dom/cjs/react-dom.development.js:4277:31)
      at beginWork$1 (node_modules/react-dom/cjs/react-dom.development.js:27490:7)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26599:12)
      at workLoopSync (node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at recoverFromConcurrentError (node_modules/react-dom/cjs/react-dom.development.js:25889:20)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25789:22)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:85:5)

    console.error
      The above error occurred in the <HealthAssessmentForm> component:
      
          at entityId (B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:90:3)
      
      Consider adding an error boundary to your tree to customize error handling behavior.
      Visit https://reactjs.org/link/error-boundaries to learn more about error boundaries.

    [0m [90m 71 |[39m
     [90m 72 |[39m   [36mconst[39m renderForm [33m=[39m (initialData [33m=[39m {}) [33m=>[39m {
    [31m[1m>[22m[39m[90m 73 |[39m     [36mreturn[39m render(
     [90m    |[39m                  [31m[1m^[22m[39m
     [90m 74 |[39m       [33m<[39m[33mHealthAssessmentForm[39m
     [90m 75 |[39m         onSubmit[33m=[39m{mockOnSubmit}
     [90m 76 |[39m         onCancel[33m=[39m{mockOnCancel}[0m

      at logCapturedError (node_modules/react-dom/cjs/react-dom.development.js:18704:23)
      at update.callback (node_modules/react-dom/cjs/react-dom.development.js:18737:5)
      at callCallback (node_modules/react-dom/cjs/react-dom.development.js:15036:12)
      at commitUpdateQueue (node_modules/react-dom/cjs/react-dom.development.js:15057:9)
      at commitLayoutEffectOnFiber (node_modules/react-dom/cjs/react-dom.development.js:23430:13)
      at commitLayoutMountEffects_complete (node_modules/react-dom/cjs/react-dom.development.js:24727:9)
      at commitLayoutEffects_begin (node_modules/react-dom/cjs/react-dom.development.js:24713:7)
      at commitLayoutEffects (node_modules/react-dom/cjs/react-dom.development.js:24651:3)
      at commitRootImpl (node_modules/react-dom/cjs/react-dom.development.js:26862:5)
      at commitRoot (node_modules/react-dom/cjs/react-dom.development.js:26721:5)
      at finishConcurrentRender (node_modules/react-dom/cjs/react-dom.development.js:25931:9)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25848:7)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:85:5)

    console.error
      Error: Uncaught [TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')]
          at reportException (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\helpers\runtime-script-errors.js:66:24)
          at innerInvokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:353:9)
          at invokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:286:3)
          at HTMLUnknownElementImpl._dispatch (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:233:9)
          at HTMLUnknownElementImpl.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:104:17)
          at HTMLUnknownElement.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:241:34)
          at Object.invokeGuardedCallbackDev (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4213:16)
          at invokeGuardedCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4277:31)
          at beginWork$1 (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:27490:7)
          at performUnitOfWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26599:12)
          at workLoopSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26505:5)
          at renderRootSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26473:7)
          at performConcurrentWorkOnRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25777:74)
          at flushActQueue (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2667:24)
          at act (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2582:11)
          at B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\act-compat.js:47:25
          at renderRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:190:26)
          at render (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:292:10)
          at renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:73:18)
          at Object.renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:117:5)
          at Promise.then.completed (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:316:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
          at run (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
          at runTestInternal (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:367:16)
          at runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:444:34)
          at Object.worker (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\testWorker.js:106:12) {
        detail: TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')
            at B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:131:56
            at Array.filter (<anonymous>)
            at filter (B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:131:26)
            at renderWithHooks (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:15486:18)
            at mountIndeterminateComponent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:20103:13)
            at beginWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:21626:16)
            at HTMLUnknownElement.callCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4164:14)
            at HTMLUnknownElement.callTheUserObjectsOperation (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventListener.js:26:30)
            at innerInvokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:350:25)
            at invokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:286:3)
            at HTMLUnknownElementImpl._dispatch (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:233:9)
            at HTMLUnknownElementImpl.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:104:17)
            at HTMLUnknownElement.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:241:34)
            at Object.invokeGuardedCallbackDev (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4213:16)
            at invokeGuardedCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4277:31)
            at beginWork$1 (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:27490:7)
            at performUnitOfWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26599:12)
            at workLoopSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26505:5)
            at renderRootSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26473:7)
            at performConcurrentWorkOnRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25777:74)
            at flushActQueue (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2667:24)
            at act (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2582:11)
            at B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\act-compat.js:47:25
            at renderRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:190:26)
            at render (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:292:10)
            at renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:73:18)
            at Object.renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:117:5)
            at Promise.then.completed (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:298:28)
            at new Promise (<anonymous>)
            at callAsyncCircusFn (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:231:10)
            at _callCircusTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:316:40)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at _runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:252:3)
            at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:126:9)
            at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
            at run (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:71:3)
            at runAndTransformResultsToJestFormat (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
            at jestAdapter (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
            at runTestInternal (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:367:16)
            at runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:444:34)
            at Object.worker (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\testWorker.js:106:12),
        type: 'unhandled exception'
      }

    [0m [90m 71 |[39m
     [90m 72 |[39m   [36mconst[39m renderForm [33m=[39m (initialData [33m=[39m {}) [33m=>[39m {
    [31m[1m>[22m[39m[90m 73 |[39m     [36mreturn[39m render(
     [90m    |[39m                  [31m[1m^[22m[39m
     [90m 74 |[39m       [33m<[39m[33mHealthAssessmentForm[39m
     [90m 75 |[39m         onSubmit[33m=[39m{mockOnSubmit}
     [90m 76 |[39m         onCancel[33m=[39m{mockOnCancel}[0m

      at VirtualConsole.<anonymous> (node_modules/jest-environment-jsdom/build/index.js:63:23)
      at reportException (node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:70:28)
      at innerInvokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
      at invokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
      at HTMLUnknownElementImpl._dispatch (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
      at HTMLUnknownElementImpl.dispatchEvent (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
      at HTMLUnknownElement.dispatchEvent (node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
      at Object.invokeGuardedCallbackDev (node_modules/react-dom/cjs/react-dom.development.js:4213:16)
      at invokeGuardedCallback (node_modules/react-dom/cjs/react-dom.development.js:4277:31)
      at beginWork$1 (node_modules/react-dom/cjs/react-dom.development.js:27490:7)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26599:12)
      at workLoopSync (node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25777:74)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:117:5)

    console.error
      Error: Uncaught [TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')]
          at reportException (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\helpers\runtime-script-errors.js:66:24)
          at innerInvokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:353:9)
          at invokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:286:3)
          at HTMLUnknownElementImpl._dispatch (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:233:9)
          at HTMLUnknownElementImpl.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:104:17)
          at HTMLUnknownElement.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:241:34)
          at Object.invokeGuardedCallbackDev (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4213:16)
          at invokeGuardedCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4277:31)
          at beginWork$1 (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:27490:7)
          at performUnitOfWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26599:12)
          at workLoopSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26505:5)
          at renderRootSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26473:7)
          at recoverFromConcurrentError (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25889:20)
          at performConcurrentWorkOnRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25789:22)
          at flushActQueue (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2667:24)
          at act (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2582:11)
          at B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\act-compat.js:47:25
          at renderRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:190:26)
          at render (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:292:10)
          at renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:73:18)
          at Object.renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:117:5)
          at Promise.then.completed (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:316:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
          at run (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
          at runTestInternal (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:367:16)
          at runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:444:34)
          at Object.worker (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\testWorker.js:106:12) {
        detail: TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')
            at B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:131:56
            at Array.filter (<anonymous>)
            at filter (B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:131:26)
            at renderWithHooks (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:15486:18)
            at mountIndeterminateComponent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:20103:13)
            at beginWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:21626:16)
            at HTMLUnknownElement.callCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4164:14)
            at HTMLUnknownElement.callTheUserObjectsOperation (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventListener.js:26:30)
            at innerInvokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:350:25)
            at invokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:286:3)
            at HTMLUnknownElementImpl._dispatch (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:233:9)
            at HTMLUnknownElementImpl.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:104:17)
            at HTMLUnknownElement.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:241:34)
            at Object.invokeGuardedCallbackDev (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4213:16)
            at invokeGuardedCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4277:31)
            at beginWork$1 (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:27490:7)
            at performUnitOfWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26599:12)
            at workLoopSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26505:5)
            at renderRootSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26473:7)
            at recoverFromConcurrentError (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25889:20)
            at performConcurrentWorkOnRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25789:22)
            at flushActQueue (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2667:24)
            at act (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2582:11)
            at B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\act-compat.js:47:25
            at renderRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:190:26)
            at render (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:292:10)
            at renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:73:18)
            at Object.renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:117:5)
            at Promise.then.completed (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:298:28)
            at new Promise (<anonymous>)
            at callAsyncCircusFn (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:231:10)
            at _callCircusTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:316:40)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at _runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:252:3)
            at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:126:9)
            at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
            at run (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:71:3)
            at runAndTransformResultsToJestFormat (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
            at jestAdapter (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
            at runTestInternal (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:367:16)
            at runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:444:34)
            at Object.worker (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\testWorker.js:106:12),
        type: 'unhandled exception'
      }

    [0m [90m 71 |[39m
     [90m 72 |[39m   [36mconst[39m renderForm [33m=[39m (initialData [33m=[39m {}) [33m=>[39m {
    [31m[1m>[22m[39m[90m 73 |[39m     [36mreturn[39m render(
     [90m    |[39m                  [31m[1m^[22m[39m
     [90m 74 |[39m       [33m<[39m[33mHealthAssessmentForm[39m
     [90m 75 |[39m         onSubmit[33m=[39m{mockOnSubmit}
     [90m 76 |[39m         onCancel[33m=[39m{mockOnCancel}[0m

      at VirtualConsole.<anonymous> (node_modules/jest-environment-jsdom/build/index.js:63:23)
      at reportException (node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:70:28)
      at innerInvokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
      at invokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
      at HTMLUnknownElementImpl._dispatch (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
      at HTMLUnknownElementImpl.dispatchEvent (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
      at HTMLUnknownElement.dispatchEvent (node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
      at Object.invokeGuardedCallbackDev (node_modules/react-dom/cjs/react-dom.development.js:4213:16)
      at invokeGuardedCallback (node_modules/react-dom/cjs/react-dom.development.js:4277:31)
      at beginWork$1 (node_modules/react-dom/cjs/react-dom.development.js:27490:7)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26599:12)
      at workLoopSync (node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at recoverFromConcurrentError (node_modules/react-dom/cjs/react-dom.development.js:25889:20)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25789:22)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:117:5)

    console.error
      The above error occurred in the <HealthAssessmentForm> component:
      
          at entityId (B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:90:3)
      
      Consider adding an error boundary to your tree to customize error handling behavior.
      Visit https://reactjs.org/link/error-boundaries to learn more about error boundaries.

    [0m [90m 71 |[39m
     [90m 72 |[39m   [36mconst[39m renderForm [33m=[39m (initialData [33m=[39m {}) [33m=>[39m {
    [31m[1m>[22m[39m[90m 73 |[39m     [36mreturn[39m render(
     [90m    |[39m                  [31m[1m^[22m[39m
     [90m 74 |[39m       [33m<[39m[33mHealthAssessmentForm[39m
     [90m 75 |[39m         onSubmit[33m=[39m{mockOnSubmit}
     [90m 76 |[39m         onCancel[33m=[39m{mockOnCancel}[0m

      at logCapturedError (node_modules/react-dom/cjs/react-dom.development.js:18704:23)
      at update.callback (node_modules/react-dom/cjs/react-dom.development.js:18737:5)
      at callCallback (node_modules/react-dom/cjs/react-dom.development.js:15036:12)
      at commitUpdateQueue (node_modules/react-dom/cjs/react-dom.development.js:15057:9)
      at commitLayoutEffectOnFiber (node_modules/react-dom/cjs/react-dom.development.js:23430:13)
      at commitLayoutMountEffects_complete (node_modules/react-dom/cjs/react-dom.development.js:24727:9)
      at commitLayoutEffects_begin (node_modules/react-dom/cjs/react-dom.development.js:24713:7)
      at commitLayoutEffects (node_modules/react-dom/cjs/react-dom.development.js:24651:3)
      at commitRootImpl (node_modules/react-dom/cjs/react-dom.development.js:26862:5)
      at commitRoot (node_modules/react-dom/cjs/react-dom.development.js:26721:5)
      at finishConcurrentRender (node_modules/react-dom/cjs/react-dom.development.js:25931:9)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25848:7)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:117:5)

    console.error
      Error: Uncaught [TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')]
          at reportException (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\helpers\runtime-script-errors.js:66:24)
          at innerInvokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:353:9)
          at invokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:286:3)
          at HTMLUnknownElementImpl._dispatch (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:233:9)
          at HTMLUnknownElementImpl.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:104:17)
          at HTMLUnknownElement.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:241:34)
          at Object.invokeGuardedCallbackDev (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4213:16)
          at invokeGuardedCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4277:31)
          at beginWork$1 (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:27490:7)
          at performUnitOfWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26599:12)
          at workLoopSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26505:5)
          at renderRootSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26473:7)
          at performConcurrentWorkOnRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25777:74)
          at flushActQueue (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2667:24)
          at act (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2582:11)
          at B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\act-compat.js:47:25
          at renderRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:190:26)
          at render (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:292:10)
          at renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:73:18)
          at Object.renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:135:5)
          at Promise.then.completed (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:316:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
          at run (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
          at runTestInternal (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:367:16)
          at runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:444:34)
          at Object.worker (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\testWorker.js:106:12) {
        detail: TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')
            at B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:131:56
            at Array.filter (<anonymous>)
            at filter (B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:131:26)
            at renderWithHooks (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:15486:18)
            at mountIndeterminateComponent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:20103:13)
            at beginWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:21626:16)
            at HTMLUnknownElement.callCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4164:14)
            at HTMLUnknownElement.callTheUserObjectsOperation (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventListener.js:26:30)
            at innerInvokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:350:25)
            at invokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:286:3)
            at HTMLUnknownElementImpl._dispatch (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:233:9)
            at HTMLUnknownElementImpl.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:104:17)
            at HTMLUnknownElement.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:241:34)
            at Object.invokeGuardedCallbackDev (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4213:16)
            at invokeGuardedCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4277:31)
            at beginWork$1 (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:27490:7)
            at performUnitOfWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26599:12)
            at workLoopSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26505:5)
            at renderRootSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26473:7)
            at performConcurrentWorkOnRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25777:74)
            at flushActQueue (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2667:24)
            at act (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2582:11)
            at B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\act-compat.js:47:25
            at renderRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:190:26)
            at render (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:292:10)
            at renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:73:18)
            at Object.renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:135:5)
            at Promise.then.completed (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:298:28)
            at new Promise (<anonymous>)
            at callAsyncCircusFn (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:231:10)
            at _callCircusTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:316:40)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at _runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:252:3)
            at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:126:9)
            at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
            at run (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:71:3)
            at runAndTransformResultsToJestFormat (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
            at jestAdapter (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
            at runTestInternal (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:367:16)
            at runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:444:34)
            at Object.worker (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\testWorker.js:106:12),
        type: 'unhandled exception'
      }

    [0m [90m 71 |[39m
     [90m 72 |[39m   [36mconst[39m renderForm [33m=[39m (initialData [33m=[39m {}) [33m=>[39m {
    [31m[1m>[22m[39m[90m 73 |[39m     [36mreturn[39m render(
     [90m    |[39m                  [31m[1m^[22m[39m
     [90m 74 |[39m       [33m<[39m[33mHealthAssessmentForm[39m
     [90m 75 |[39m         onSubmit[33m=[39m{mockOnSubmit}
     [90m 76 |[39m         onCancel[33m=[39m{mockOnCancel}[0m

      at VirtualConsole.<anonymous> (node_modules/jest-environment-jsdom/build/index.js:63:23)
      at reportException (node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:70:28)
      at innerInvokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
      at invokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
      at HTMLUnknownElementImpl._dispatch (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
      at HTMLUnknownElementImpl.dispatchEvent (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
      at HTMLUnknownElement.dispatchEvent (node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
      at Object.invokeGuardedCallbackDev (node_modules/react-dom/cjs/react-dom.development.js:4213:16)
      at invokeGuardedCallback (node_modules/react-dom/cjs/react-dom.development.js:4277:31)
      at beginWork$1 (node_modules/react-dom/cjs/react-dom.development.js:27490:7)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26599:12)
      at workLoopSync (node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25777:74)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:135:5)

    console.error
      Error: Uncaught [TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')]
          at reportException (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\helpers\runtime-script-errors.js:66:24)
          at innerInvokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:353:9)
          at invokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:286:3)
          at HTMLUnknownElementImpl._dispatch (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:233:9)
          at HTMLUnknownElementImpl.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:104:17)
          at HTMLUnknownElement.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:241:34)
          at Object.invokeGuardedCallbackDev (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4213:16)
          at invokeGuardedCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4277:31)
          at beginWork$1 (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:27490:7)
          at performUnitOfWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26599:12)
          at workLoopSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26505:5)
          at renderRootSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26473:7)
          at recoverFromConcurrentError (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25889:20)
          at performConcurrentWorkOnRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25789:22)
          at flushActQueue (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2667:24)
          at act (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2582:11)
          at B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\act-compat.js:47:25
          at renderRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:190:26)
          at render (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:292:10)
          at renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:73:18)
          at Object.renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:135:5)
          at Promise.then.completed (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:316:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
          at run (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
          at runTestInternal (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:367:16)
          at runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:444:34)
          at Object.worker (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\testWorker.js:106:12) {
        detail: TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')
            at B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:131:56
            at Array.filter (<anonymous>)
            at filter (B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:131:26)
            at renderWithHooks (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:15486:18)
            at mountIndeterminateComponent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:20103:13)
            at beginWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:21626:16)
            at HTMLUnknownElement.callCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4164:14)
            at HTMLUnknownElement.callTheUserObjectsOperation (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventListener.js:26:30)
            at innerInvokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:350:25)
            at invokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:286:3)
            at HTMLUnknownElementImpl._dispatch (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:233:9)
            at HTMLUnknownElementImpl.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:104:17)
            at HTMLUnknownElement.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:241:34)
            at Object.invokeGuardedCallbackDev (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4213:16)
            at invokeGuardedCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4277:31)
            at beginWork$1 (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:27490:7)
            at performUnitOfWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26599:12)
            at workLoopSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26505:5)
            at renderRootSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26473:7)
            at recoverFromConcurrentError (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25889:20)
            at performConcurrentWorkOnRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25789:22)
            at flushActQueue (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2667:24)
            at act (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2582:11)
            at B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\act-compat.js:47:25
            at renderRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:190:26)
            at render (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:292:10)
            at renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:73:18)
            at Object.renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:135:5)
            at Promise.then.completed (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:298:28)
            at new Promise (<anonymous>)
            at callAsyncCircusFn (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:231:10)
            at _callCircusTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:316:40)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at _runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:252:3)
            at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:126:9)
            at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
            at run (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:71:3)
            at runAndTransformResultsToJestFormat (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
            at jestAdapter (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
            at runTestInternal (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:367:16)
            at runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:444:34)
            at Object.worker (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\testWorker.js:106:12),
        type: 'unhandled exception'
      }

    [0m [90m 71 |[39m
     [90m 72 |[39m   [36mconst[39m renderForm [33m=[39m (initialData [33m=[39m {}) [33m=>[39m {
    [31m[1m>[22m[39m[90m 73 |[39m     [36mreturn[39m render(
     [90m    |[39m                  [31m[1m^[22m[39m
     [90m 74 |[39m       [33m<[39m[33mHealthAssessmentForm[39m
     [90m 75 |[39m         onSubmit[33m=[39m{mockOnSubmit}
     [90m 76 |[39m         onCancel[33m=[39m{mockOnCancel}[0m

      at VirtualConsole.<anonymous> (node_modules/jest-environment-jsdom/build/index.js:63:23)
      at reportException (node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:70:28)
      at innerInvokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
      at invokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
      at HTMLUnknownElementImpl._dispatch (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
      at HTMLUnknownElementImpl.dispatchEvent (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
      at HTMLUnknownElement.dispatchEvent (node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
      at Object.invokeGuardedCallbackDev (node_modules/react-dom/cjs/react-dom.development.js:4213:16)
      at invokeGuardedCallback (node_modules/react-dom/cjs/react-dom.development.js:4277:31)
      at beginWork$1 (node_modules/react-dom/cjs/react-dom.development.js:27490:7)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26599:12)
      at workLoopSync (node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at recoverFromConcurrentError (node_modules/react-dom/cjs/react-dom.development.js:25889:20)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25789:22)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:135:5)

    console.error
      The above error occurred in the <HealthAssessmentForm> component:
      
          at entityId (B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:90:3)
      
      Consider adding an error boundary to your tree to customize error handling behavior.
      Visit https://reactjs.org/link/error-boundaries to learn more about error boundaries.

    [0m [90m 71 |[39m
     [90m 72 |[39m   [36mconst[39m renderForm [33m=[39m (initialData [33m=[39m {}) [33m=>[39m {
    [31m[1m>[22m[39m[90m 73 |[39m     [36mreturn[39m render(
     [90m    |[39m                  [31m[1m^[22m[39m
     [90m 74 |[39m       [33m<[39m[33mHealthAssessmentForm[39m
     [90m 75 |[39m         onSubmit[33m=[39m{mockOnSubmit}
     [90m 76 |[39m         onCancel[33m=[39m{mockOnCancel}[0m

      at logCapturedError (node_modules/react-dom/cjs/react-dom.development.js:18704:23)
      at update.callback (node_modules/react-dom/cjs/react-dom.development.js:18737:5)
      at callCallback (node_modules/react-dom/cjs/react-dom.development.js:15036:12)
      at commitUpdateQueue (node_modules/react-dom/cjs/react-dom.development.js:15057:9)
      at commitLayoutEffectOnFiber (node_modules/react-dom/cjs/react-dom.development.js:23430:13)
      at commitLayoutMountEffects_complete (node_modules/react-dom/cjs/react-dom.development.js:24727:9)
      at commitLayoutEffects_begin (node_modules/react-dom/cjs/react-dom.development.js:24713:7)
      at commitLayoutEffects (node_modules/react-dom/cjs/react-dom.development.js:24651:3)
      at commitRootImpl (node_modules/react-dom/cjs/react-dom.development.js:26862:5)
      at commitRoot (node_modules/react-dom/cjs/react-dom.development.js:26721:5)
      at finishConcurrentRender (node_modules/react-dom/cjs/react-dom.development.js:25931:9)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25848:7)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:135:5)

    console.error
      Error: Uncaught [TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')]
          at reportException (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\helpers\runtime-script-errors.js:66:24)
          at innerInvokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:353:9)
          at invokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:286:3)
          at HTMLUnknownElementImpl._dispatch (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:233:9)
          at HTMLUnknownElementImpl.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:104:17)
          at HTMLUnknownElement.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:241:34)
          at Object.invokeGuardedCallbackDev (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4213:16)
          at invokeGuardedCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4277:31)
          at beginWork$1 (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:27490:7)
          at performUnitOfWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26599:12)
          at workLoopSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26505:5)
          at renderRootSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26473:7)
          at performConcurrentWorkOnRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25777:74)
          at flushActQueue (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2667:24)
          at act (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2582:11)
          at B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\act-compat.js:47:25
          at renderRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:190:26)
          at render (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:292:10)
          at renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:73:18)
          at Object.renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:154:5)
          at Promise.then.completed (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:316:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
          at run (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
          at runTestInternal (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:367:16)
          at runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:444:34)
          at Object.worker (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\testWorker.js:106:12) {
        detail: TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')
            at B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:131:56
            at Array.filter (<anonymous>)
            at filter (B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:131:26)
            at renderWithHooks (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:15486:18)
            at mountIndeterminateComponent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:20103:13)
            at beginWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:21626:16)
            at HTMLUnknownElement.callCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4164:14)
            at HTMLUnknownElement.callTheUserObjectsOperation (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventListener.js:26:30)
            at innerInvokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:350:25)
            at invokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:286:3)
            at HTMLUnknownElementImpl._dispatch (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:233:9)
            at HTMLUnknownElementImpl.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:104:17)
            at HTMLUnknownElement.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:241:34)
            at Object.invokeGuardedCallbackDev (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4213:16)
            at invokeGuardedCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4277:31)
            at beginWork$1 (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:27490:7)
            at performUnitOfWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26599:12)
            at workLoopSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26505:5)
            at renderRootSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26473:7)
            at performConcurrentWorkOnRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25777:74)
            at flushActQueue (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2667:24)
            at act (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2582:11)
            at B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\act-compat.js:47:25
            at renderRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:190:26)
            at render (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:292:10)
            at renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:73:18)
            at Object.renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:154:5)
            at Promise.then.completed (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:298:28)
            at new Promise (<anonymous>)
            at callAsyncCircusFn (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:231:10)
            at _callCircusTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:316:40)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at _runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:252:3)
            at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:126:9)
            at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
            at run (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:71:3)
            at runAndTransformResultsToJestFormat (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
            at jestAdapter (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
            at runTestInternal (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:367:16)
            at runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:444:34)
            at Object.worker (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\testWorker.js:106:12),
        type: 'unhandled exception'
      }

    [0m [90m 71 |[39m
     [90m 72 |[39m   [36mconst[39m renderForm [33m=[39m (initialData [33m=[39m {}) [33m=>[39m {
    [31m[1m>[22m[39m[90m 73 |[39m     [36mreturn[39m render(
     [90m    |[39m                  [31m[1m^[22m[39m
     [90m 74 |[39m       [33m<[39m[33mHealthAssessmentForm[39m
     [90m 75 |[39m         onSubmit[33m=[39m{mockOnSubmit}
     [90m 76 |[39m         onCancel[33m=[39m{mockOnCancel}[0m

      at VirtualConsole.<anonymous> (node_modules/jest-environment-jsdom/build/index.js:63:23)
      at reportException (node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:70:28)
      at innerInvokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
      at invokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
      at HTMLUnknownElementImpl._dispatch (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
      at HTMLUnknownElementImpl.dispatchEvent (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
      at HTMLUnknownElement.dispatchEvent (node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
      at Object.invokeGuardedCallbackDev (node_modules/react-dom/cjs/react-dom.development.js:4213:16)
      at invokeGuardedCallback (node_modules/react-dom/cjs/react-dom.development.js:4277:31)
      at beginWork$1 (node_modules/react-dom/cjs/react-dom.development.js:27490:7)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26599:12)
      at workLoopSync (node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25777:74)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:154:5)

    console.error
      Error: Uncaught [TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')]
          at reportException (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\helpers\runtime-script-errors.js:66:24)
          at innerInvokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:353:9)
          at invokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:286:3)
          at HTMLUnknownElementImpl._dispatch (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:233:9)
          at HTMLUnknownElementImpl.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:104:17)
          at HTMLUnknownElement.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:241:34)
          at Object.invokeGuardedCallbackDev (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4213:16)
          at invokeGuardedCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4277:31)
          at beginWork$1 (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:27490:7)
          at performUnitOfWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26599:12)
          at workLoopSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26505:5)
          at renderRootSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26473:7)
          at recoverFromConcurrentError (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25889:20)
          at performConcurrentWorkOnRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25789:22)
          at flushActQueue (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2667:24)
          at act (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2582:11)
          at B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\act-compat.js:47:25
          at renderRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:190:26)
          at render (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:292:10)
          at renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:73:18)
          at Object.renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:154:5)
          at Promise.then.completed (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:316:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
          at run (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
          at runTestInternal (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:367:16)
          at runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:444:34)
          at Object.worker (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\testWorker.js:106:12) {
        detail: TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')
            at B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:131:56
            at Array.filter (<anonymous>)
            at filter (B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:131:26)
            at renderWithHooks (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:15486:18)
            at mountIndeterminateComponent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:20103:13)
            at beginWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:21626:16)
            at HTMLUnknownElement.callCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4164:14)
            at HTMLUnknownElement.callTheUserObjectsOperation (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventListener.js:26:30)
            at innerInvokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:350:25)
            at invokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:286:3)
            at HTMLUnknownElementImpl._dispatch (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:233:9)
            at HTMLUnknownElementImpl.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:104:17)
            at HTMLUnknownElement.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:241:34)
            at Object.invokeGuardedCallbackDev (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4213:16)
            at invokeGuardedCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4277:31)
            at beginWork$1 (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:27490:7)
            at performUnitOfWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26599:12)
            at workLoopSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26505:5)
            at renderRootSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26473:7)
            at recoverFromConcurrentError (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25889:20)
            at performConcurrentWorkOnRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25789:22)
            at flushActQueue (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2667:24)
            at act (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2582:11)
            at B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\act-compat.js:47:25
            at renderRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:190:26)
            at render (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:292:10)
            at renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:73:18)
            at Object.renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:154:5)
            at Promise.then.completed (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:298:28)
            at new Promise (<anonymous>)
            at callAsyncCircusFn (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:231:10)
            at _callCircusTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:316:40)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at _runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:252:3)
            at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:126:9)
            at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
            at run (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:71:3)
            at runAndTransformResultsToJestFormat (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
            at jestAdapter (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
            at runTestInternal (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:367:16)
            at runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:444:34)
            at Object.worker (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\testWorker.js:106:12),
        type: 'unhandled exception'
      }

    [0m [90m 71 |[39m
     [90m 72 |[39m   [36mconst[39m renderForm [33m=[39m (initialData [33m=[39m {}) [33m=>[39m {
    [31m[1m>[22m[39m[90m 73 |[39m     [36mreturn[39m render(
     [90m    |[39m                  [31m[1m^[22m[39m
     [90m 74 |[39m       [33m<[39m[33mHealthAssessmentForm[39m
     [90m 75 |[39m         onSubmit[33m=[39m{mockOnSubmit}
     [90m 76 |[39m         onCancel[33m=[39m{mockOnCancel}[0m

      at VirtualConsole.<anonymous> (node_modules/jest-environment-jsdom/build/index.js:63:23)
      at reportException (node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:70:28)
      at innerInvokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
      at invokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
      at HTMLUnknownElementImpl._dispatch (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
      at HTMLUnknownElementImpl.dispatchEvent (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
      at HTMLUnknownElement.dispatchEvent (node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
      at Object.invokeGuardedCallbackDev (node_modules/react-dom/cjs/react-dom.development.js:4213:16)
      at invokeGuardedCallback (node_modules/react-dom/cjs/react-dom.development.js:4277:31)
      at beginWork$1 (node_modules/react-dom/cjs/react-dom.development.js:27490:7)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26599:12)
      at workLoopSync (node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at recoverFromConcurrentError (node_modules/react-dom/cjs/react-dom.development.js:25889:20)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25789:22)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:154:5)

    console.error
      The above error occurred in the <HealthAssessmentForm> component:
      
          at entityId (B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:90:3)
      
      Consider adding an error boundary to your tree to customize error handling behavior.
      Visit https://reactjs.org/link/error-boundaries to learn more about error boundaries.

    [0m [90m 71 |[39m
     [90m 72 |[39m   [36mconst[39m renderForm [33m=[39m (initialData [33m=[39m {}) [33m=>[39m {
    [31m[1m>[22m[39m[90m 73 |[39m     [36mreturn[39m render(
     [90m    |[39m                  [31m[1m^[22m[39m
     [90m 74 |[39m       [33m<[39m[33mHealthAssessmentForm[39m
     [90m 75 |[39m         onSubmit[33m=[39m{mockOnSubmit}
     [90m 76 |[39m         onCancel[33m=[39m{mockOnCancel}[0m

      at logCapturedError (node_modules/react-dom/cjs/react-dom.development.js:18704:23)
      at update.callback (node_modules/react-dom/cjs/react-dom.development.js:18737:5)
      at callCallback (node_modules/react-dom/cjs/react-dom.development.js:15036:12)
      at commitUpdateQueue (node_modules/react-dom/cjs/react-dom.development.js:15057:9)
      at commitLayoutEffectOnFiber (node_modules/react-dom/cjs/react-dom.development.js:23430:13)
      at commitLayoutMountEffects_complete (node_modules/react-dom/cjs/react-dom.development.js:24727:9)
      at commitLayoutEffects_begin (node_modules/react-dom/cjs/react-dom.development.js:24713:7)
      at commitLayoutEffects (node_modules/react-dom/cjs/react-dom.development.js:24651:3)
      at commitRootImpl (node_modules/react-dom/cjs/react-dom.development.js:26862:5)
      at commitRoot (node_modules/react-dom/cjs/react-dom.development.js:26721:5)
      at finishConcurrentRender (node_modules/react-dom/cjs/react-dom.development.js:25931:9)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25848:7)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:154:5)

    console.error
      Error: Uncaught [TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')]
          at reportException (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\helpers\runtime-script-errors.js:66:24)
          at innerInvokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:353:9)
          at invokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:286:3)
          at HTMLUnknownElementImpl._dispatch (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:233:9)
          at HTMLUnknownElementImpl.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:104:17)
          at HTMLUnknownElement.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:241:34)
          at Object.invokeGuardedCallbackDev (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4213:16)
          at invokeGuardedCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4277:31)
          at beginWork$1 (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:27490:7)
          at performUnitOfWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26599:12)
          at workLoopSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26505:5)
          at renderRootSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26473:7)
          at performConcurrentWorkOnRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25777:74)
          at flushActQueue (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2667:24)
          at act (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2582:11)
          at B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\act-compat.js:47:25
          at renderRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:190:26)
          at render (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:292:10)
          at renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:73:18)
          at Object.renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:172:5)
          at Promise.then.completed (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:316:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
          at run (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
          at runTestInternal (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:367:16)
          at runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:444:34)
          at Object.worker (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\testWorker.js:106:12) {
        detail: TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')
            at B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:131:56
            at Array.filter (<anonymous>)
            at filter (B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:131:26)
            at renderWithHooks (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:15486:18)
            at mountIndeterminateComponent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:20103:13)
            at beginWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:21626:16)
            at HTMLUnknownElement.callCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4164:14)
            at HTMLUnknownElement.callTheUserObjectsOperation (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventListener.js:26:30)
            at innerInvokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:350:25)
            at invokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:286:3)
            at HTMLUnknownElementImpl._dispatch (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:233:9)
            at HTMLUnknownElementImpl.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:104:17)
            at HTMLUnknownElement.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:241:34)
            at Object.invokeGuardedCallbackDev (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4213:16)
            at invokeGuardedCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4277:31)
            at beginWork$1 (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:27490:7)
            at performUnitOfWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26599:12)
            at workLoopSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26505:5)
            at renderRootSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26473:7)
            at performConcurrentWorkOnRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25777:74)
            at flushActQueue (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2667:24)
            at act (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2582:11)
            at B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\act-compat.js:47:25
            at renderRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:190:26)
            at render (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:292:10)
            at renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:73:18)
            at Object.renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:172:5)
            at Promise.then.completed (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:298:28)
            at new Promise (<anonymous>)
            at callAsyncCircusFn (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:231:10)
            at _callCircusTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:316:40)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at _runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:252:3)
            at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:126:9)
            at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
            at run (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:71:3)
            at runAndTransformResultsToJestFormat (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
            at jestAdapter (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
            at runTestInternal (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:367:16)
            at runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:444:34)
            at Object.worker (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\testWorker.js:106:12),
        type: 'unhandled exception'
      }

    [0m [90m 71 |[39m
     [90m 72 |[39m   [36mconst[39m renderForm [33m=[39m (initialData [33m=[39m {}) [33m=>[39m {
    [31m[1m>[22m[39m[90m 73 |[39m     [36mreturn[39m render(
     [90m    |[39m                  [31m[1m^[22m[39m
     [90m 74 |[39m       [33m<[39m[33mHealthAssessmentForm[39m
     [90m 75 |[39m         onSubmit[33m=[39m{mockOnSubmit}
     [90m 76 |[39m         onCancel[33m=[39m{mockOnCancel}[0m

      at VirtualConsole.<anonymous> (node_modules/jest-environment-jsdom/build/index.js:63:23)
      at reportException (node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:70:28)
      at innerInvokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
      at invokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
      at HTMLUnknownElementImpl._dispatch (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
      at HTMLUnknownElementImpl.dispatchEvent (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
      at HTMLUnknownElement.dispatchEvent (node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
      at Object.invokeGuardedCallbackDev (node_modules/react-dom/cjs/react-dom.development.js:4213:16)
      at invokeGuardedCallback (node_modules/react-dom/cjs/react-dom.development.js:4277:31)
      at beginWork$1 (node_modules/react-dom/cjs/react-dom.development.js:27490:7)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26599:12)
      at workLoopSync (node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25777:74)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:172:5)

    console.error
      Error: Uncaught [TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')]
          at reportException (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\helpers\runtime-script-errors.js:66:24)
          at innerInvokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:353:9)
          at invokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:286:3)
          at HTMLUnknownElementImpl._dispatch (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:233:9)
          at HTMLUnknownElementImpl.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:104:17)
          at HTMLUnknownElement.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:241:34)
          at Object.invokeGuardedCallbackDev (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4213:16)
          at invokeGuardedCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4277:31)
          at beginWork$1 (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:27490:7)
          at performUnitOfWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26599:12)
          at workLoopSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26505:5)
          at renderRootSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26473:7)
          at recoverFromConcurrentError (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25889:20)
          at performConcurrentWorkOnRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25789:22)
          at flushActQueue (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2667:24)
          at act (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2582:11)
          at B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\act-compat.js:47:25
          at renderRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:190:26)
          at render (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:292:10)
          at renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:73:18)
          at Object.renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:172:5)
          at Promise.then.completed (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:316:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
          at run (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
          at runTestInternal (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:367:16)
          at runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:444:34)
          at Object.worker (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\testWorker.js:106:12) {
        detail: TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')
            at B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:131:56
            at Array.filter (<anonymous>)
            at filter (B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:131:26)
            at renderWithHooks (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:15486:18)
            at mountIndeterminateComponent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:20103:13)
            at beginWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:21626:16)
            at HTMLUnknownElement.callCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4164:14)
            at HTMLUnknownElement.callTheUserObjectsOperation (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventListener.js:26:30)
            at innerInvokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:350:25)
            at invokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:286:3)
            at HTMLUnknownElementImpl._dispatch (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:233:9)
            at HTMLUnknownElementImpl.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:104:17)
            at HTMLUnknownElement.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:241:34)
            at Object.invokeGuardedCallbackDev (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4213:16)
            at invokeGuardedCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4277:31)
            at beginWork$1 (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:27490:7)
            at performUnitOfWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26599:12)
            at workLoopSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26505:5)
            at renderRootSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26473:7)
            at recoverFromConcurrentError (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25889:20)
            at performConcurrentWorkOnRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25789:22)
            at flushActQueue (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2667:24)
            at act (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2582:11)
            at B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\act-compat.js:47:25
            at renderRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:190:26)
            at render (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:292:10)
            at renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:73:18)
            at Object.renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:172:5)
            at Promise.then.completed (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:298:28)
            at new Promise (<anonymous>)
            at callAsyncCircusFn (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:231:10)
            at _callCircusTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:316:40)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at _runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:252:3)
            at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:126:9)
            at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
            at run (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:71:3)
            at runAndTransformResultsToJestFormat (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
            at jestAdapter (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
            at runTestInternal (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:367:16)
            at runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:444:34)
            at Object.worker (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\testWorker.js:106:12),
        type: 'unhandled exception'
      }

    [0m [90m 71 |[39m
     [90m 72 |[39m   [36mconst[39m renderForm [33m=[39m (initialData [33m=[39m {}) [33m=>[39m {
    [31m[1m>[22m[39m[90m 73 |[39m     [36mreturn[39m render(
     [90m    |[39m                  [31m[1m^[22m[39m
     [90m 74 |[39m       [33m<[39m[33mHealthAssessmentForm[39m
     [90m 75 |[39m         onSubmit[33m=[39m{mockOnSubmit}
     [90m 76 |[39m         onCancel[33m=[39m{mockOnCancel}[0m

      at VirtualConsole.<anonymous> (node_modules/jest-environment-jsdom/build/index.js:63:23)
      at reportException (node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:70:28)
      at innerInvokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
      at invokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
      at HTMLUnknownElementImpl._dispatch (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
      at HTMLUnknownElementImpl.dispatchEvent (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
      at HTMLUnknownElement.dispatchEvent (node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
      at Object.invokeGuardedCallbackDev (node_modules/react-dom/cjs/react-dom.development.js:4213:16)
      at invokeGuardedCallback (node_modules/react-dom/cjs/react-dom.development.js:4277:31)
      at beginWork$1 (node_modules/react-dom/cjs/react-dom.development.js:27490:7)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26599:12)
      at workLoopSync (node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at recoverFromConcurrentError (node_modules/react-dom/cjs/react-dom.development.js:25889:20)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25789:22)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:172:5)

    console.error
      The above error occurred in the <HealthAssessmentForm> component:
      
          at entityId (B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:90:3)
      
      Consider adding an error boundary to your tree to customize error handling behavior.
      Visit https://reactjs.org/link/error-boundaries to learn more about error boundaries.

    [0m [90m 71 |[39m
     [90m 72 |[39m   [36mconst[39m renderForm [33m=[39m (initialData [33m=[39m {}) [33m=>[39m {
    [31m[1m>[22m[39m[90m 73 |[39m     [36mreturn[39m render(
     [90m    |[39m                  [31m[1m^[22m[39m
     [90m 74 |[39m       [33m<[39m[33mHealthAssessmentForm[39m
     [90m 75 |[39m         onSubmit[33m=[39m{mockOnSubmit}
     [90m 76 |[39m         onCancel[33m=[39m{mockOnCancel}[0m

      at logCapturedError (node_modules/react-dom/cjs/react-dom.development.js:18704:23)
      at update.callback (node_modules/react-dom/cjs/react-dom.development.js:18737:5)
      at callCallback (node_modules/react-dom/cjs/react-dom.development.js:15036:12)
      at commitUpdateQueue (node_modules/react-dom/cjs/react-dom.development.js:15057:9)
      at commitLayoutEffectOnFiber (node_modules/react-dom/cjs/react-dom.development.js:23430:13)
      at commitLayoutMountEffects_complete (node_modules/react-dom/cjs/react-dom.development.js:24727:9)
      at commitLayoutEffects_begin (node_modules/react-dom/cjs/react-dom.development.js:24713:7)
      at commitLayoutEffects (node_modules/react-dom/cjs/react-dom.development.js:24651:3)
      at commitRootImpl (node_modules/react-dom/cjs/react-dom.development.js:26862:5)
      at commitRoot (node_modules/react-dom/cjs/react-dom.development.js:26721:5)
      at finishConcurrentRender (node_modules/react-dom/cjs/react-dom.development.js:25931:9)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25848:7)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:172:5)

    console.error
      Error: Uncaught [TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')]
          at reportException (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\helpers\runtime-script-errors.js:66:24)
          at innerInvokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:353:9)
          at invokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:286:3)
          at HTMLUnknownElementImpl._dispatch (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:233:9)
          at HTMLUnknownElementImpl.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:104:17)
          at HTMLUnknownElement.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:241:34)
          at Object.invokeGuardedCallbackDev (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4213:16)
          at invokeGuardedCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4277:31)
          at beginWork$1 (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:27490:7)
          at performUnitOfWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26599:12)
          at workLoopSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26505:5)
          at renderRootSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26473:7)
          at performConcurrentWorkOnRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25777:74)
          at flushActQueue (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2667:24)
          at act (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2582:11)
          at B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\act-compat.js:47:25
          at renderRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:190:26)
          at render (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:292:10)
          at renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:73:18)
          at Object.renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:191:5)
          at Promise.then.completed (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:316:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
          at run (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
          at runTestInternal (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:367:16)
          at runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:444:34)
          at Object.worker (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\testWorker.js:106:12) {
        detail: TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')
            at B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:131:56
            at Array.filter (<anonymous>)
            at filter (B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:131:26)
            at renderWithHooks (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:15486:18)
            at mountIndeterminateComponent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:20103:13)
            at beginWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:21626:16)
            at HTMLUnknownElement.callCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4164:14)
            at HTMLUnknownElement.callTheUserObjectsOperation (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventListener.js:26:30)
            at innerInvokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:350:25)
            at invokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:286:3)
            at HTMLUnknownElementImpl._dispatch (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:233:9)
            at HTMLUnknownElementImpl.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:104:17)
            at HTMLUnknownElement.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:241:34)
            at Object.invokeGuardedCallbackDev (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4213:16)
            at invokeGuardedCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4277:31)
            at beginWork$1 (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:27490:7)
            at performUnitOfWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26599:12)
            at workLoopSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26505:5)
            at renderRootSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26473:7)
            at performConcurrentWorkOnRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25777:74)
            at flushActQueue (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2667:24)
            at act (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2582:11)
            at B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\act-compat.js:47:25
            at renderRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:190:26)
            at render (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:292:10)
            at renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:73:18)
            at Object.renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:191:5)
            at Promise.then.completed (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:298:28)
            at new Promise (<anonymous>)
            at callAsyncCircusFn (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:231:10)
            at _callCircusTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:316:40)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at _runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:252:3)
            at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:126:9)
            at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
            at run (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:71:3)
            at runAndTransformResultsToJestFormat (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
            at jestAdapter (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
            at runTestInternal (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:367:16)
            at runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:444:34)
            at Object.worker (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\testWorker.js:106:12),
        type: 'unhandled exception'
      }

    [0m [90m 71 |[39m
     [90m 72 |[39m   [36mconst[39m renderForm [33m=[39m (initialData [33m=[39m {}) [33m=>[39m {
    [31m[1m>[22m[39m[90m 73 |[39m     [36mreturn[39m render(
     [90m    |[39m                  [31m[1m^[22m[39m
     [90m 74 |[39m       [33m<[39m[33mHealthAssessmentForm[39m
     [90m 75 |[39m         onSubmit[33m=[39m{mockOnSubmit}
     [90m 76 |[39m         onCancel[33m=[39m{mockOnCancel}[0m

      at VirtualConsole.<anonymous> (node_modules/jest-environment-jsdom/build/index.js:63:23)
      at reportException (node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:70:28)
      at innerInvokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
      at invokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
      at HTMLUnknownElementImpl._dispatch (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
      at HTMLUnknownElementImpl.dispatchEvent (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
      at HTMLUnknownElement.dispatchEvent (node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
      at Object.invokeGuardedCallbackDev (node_modules/react-dom/cjs/react-dom.development.js:4213:16)
      at invokeGuardedCallback (node_modules/react-dom/cjs/react-dom.development.js:4277:31)
      at beginWork$1 (node_modules/react-dom/cjs/react-dom.development.js:27490:7)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26599:12)
      at workLoopSync (node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25777:74)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:191:5)

    console.error
      Error: Uncaught [TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')]
          at reportException (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\helpers\runtime-script-errors.js:66:24)
          at innerInvokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:353:9)
          at invokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:286:3)
          at HTMLUnknownElementImpl._dispatch (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:233:9)
          at HTMLUnknownElementImpl.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:104:17)
          at HTMLUnknownElement.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:241:34)
          at Object.invokeGuardedCallbackDev (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4213:16)
          at invokeGuardedCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4277:31)
          at beginWork$1 (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:27490:7)
          at performUnitOfWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26599:12)
          at workLoopSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26505:5)
          at renderRootSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26473:7)
          at recoverFromConcurrentError (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25889:20)
          at performConcurrentWorkOnRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25789:22)
          at flushActQueue (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2667:24)
          at act (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2582:11)
          at B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\act-compat.js:47:25
          at renderRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:190:26)
          at render (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:292:10)
          at renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:73:18)
          at Object.renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:191:5)
          at Promise.then.completed (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:316:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
          at run (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
          at runTestInternal (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:367:16)
          at runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:444:34)
          at Object.worker (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\testWorker.js:106:12) {
        detail: TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')
            at B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:131:56
            at Array.filter (<anonymous>)
            at filter (B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:131:26)
            at renderWithHooks (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:15486:18)
            at mountIndeterminateComponent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:20103:13)
            at beginWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:21626:16)
            at HTMLUnknownElement.callCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4164:14)
            at HTMLUnknownElement.callTheUserObjectsOperation (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventListener.js:26:30)
            at innerInvokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:350:25)
            at invokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:286:3)
            at HTMLUnknownElementImpl._dispatch (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:233:9)
            at HTMLUnknownElementImpl.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:104:17)
            at HTMLUnknownElement.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:241:34)
            at Object.invokeGuardedCallbackDev (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4213:16)
            at invokeGuardedCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4277:31)
            at beginWork$1 (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:27490:7)
            at performUnitOfWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26599:12)
            at workLoopSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26505:5)
            at renderRootSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26473:7)
            at recoverFromConcurrentError (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25889:20)
            at performConcurrentWorkOnRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25789:22)
            at flushActQueue (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2667:24)
            at act (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2582:11)
            at B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\act-compat.js:47:25
            at renderRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:190:26)
            at render (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:292:10)
            at renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:73:18)
            at Object.renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:191:5)
            at Promise.then.completed (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:298:28)
            at new Promise (<anonymous>)
            at callAsyncCircusFn (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:231:10)
            at _callCircusTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:316:40)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at _runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:252:3)
            at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:126:9)
            at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
            at run (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:71:3)
            at runAndTransformResultsToJestFormat (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
            at jestAdapter (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
            at runTestInternal (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:367:16)
            at runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:444:34)
            at Object.worker (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\testWorker.js:106:12),
        type: 'unhandled exception'
      }

    [0m [90m 71 |[39m
     [90m 72 |[39m   [36mconst[39m renderForm [33m=[39m (initialData [33m=[39m {}) [33m=>[39m {
    [31m[1m>[22m[39m[90m 73 |[39m     [36mreturn[39m render(
     [90m    |[39m                  [31m[1m^[22m[39m
     [90m 74 |[39m       [33m<[39m[33mHealthAssessmentForm[39m
     [90m 75 |[39m         onSubmit[33m=[39m{mockOnSubmit}
     [90m 76 |[39m         onCancel[33m=[39m{mockOnCancel}[0m

      at VirtualConsole.<anonymous> (node_modules/jest-environment-jsdom/build/index.js:63:23)
      at reportException (node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:70:28)
      at innerInvokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
      at invokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
      at HTMLUnknownElementImpl._dispatch (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
      at HTMLUnknownElementImpl.dispatchEvent (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
      at HTMLUnknownElement.dispatchEvent (node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
      at Object.invokeGuardedCallbackDev (node_modules/react-dom/cjs/react-dom.development.js:4213:16)
      at invokeGuardedCallback (node_modules/react-dom/cjs/react-dom.development.js:4277:31)
      at beginWork$1 (node_modules/react-dom/cjs/react-dom.development.js:27490:7)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26599:12)
      at workLoopSync (node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at recoverFromConcurrentError (node_modules/react-dom/cjs/react-dom.development.js:25889:20)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25789:22)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:191:5)

    console.error
      The above error occurred in the <HealthAssessmentForm> component:
      
          at entityId (B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:90:3)
      
      Consider adding an error boundary to your tree to customize error handling behavior.
      Visit https://reactjs.org/link/error-boundaries to learn more about error boundaries.

    [0m [90m 71 |[39m
     [90m 72 |[39m   [36mconst[39m renderForm [33m=[39m (initialData [33m=[39m {}) [33m=>[39m {
    [31m[1m>[22m[39m[90m 73 |[39m     [36mreturn[39m render(
     [90m    |[39m                  [31m[1m^[22m[39m
     [90m 74 |[39m       [33m<[39m[33mHealthAssessmentForm[39m
     [90m 75 |[39m         onSubmit[33m=[39m{mockOnSubmit}
     [90m 76 |[39m         onCancel[33m=[39m{mockOnCancel}[0m

      at logCapturedError (node_modules/react-dom/cjs/react-dom.development.js:18704:23)
      at update.callback (node_modules/react-dom/cjs/react-dom.development.js:18737:5)
      at callCallback (node_modules/react-dom/cjs/react-dom.development.js:15036:12)
      at commitUpdateQueue (node_modules/react-dom/cjs/react-dom.development.js:15057:9)
      at commitLayoutEffectOnFiber (node_modules/react-dom/cjs/react-dom.development.js:23430:13)
      at commitLayoutMountEffects_complete (node_modules/react-dom/cjs/react-dom.development.js:24727:9)
      at commitLayoutEffects_begin (node_modules/react-dom/cjs/react-dom.development.js:24713:7)
      at commitLayoutEffects (node_modules/react-dom/cjs/react-dom.development.js:24651:3)
      at commitRootImpl (node_modules/react-dom/cjs/react-dom.development.js:26862:5)
      at commitRoot (node_modules/react-dom/cjs/react-dom.development.js:26721:5)
      at finishConcurrentRender (node_modules/react-dom/cjs/react-dom.development.js:25931:9)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25848:7)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:191:5)

    console.error
      Error: Uncaught [TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')]
          at reportException (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\helpers\runtime-script-errors.js:66:24)
          at innerInvokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:353:9)
          at invokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:286:3)
          at HTMLUnknownElementImpl._dispatch (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:233:9)
          at HTMLUnknownElementImpl.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:104:17)
          at HTMLUnknownElement.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:241:34)
          at Object.invokeGuardedCallbackDev (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4213:16)
          at invokeGuardedCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4277:31)
          at beginWork$1 (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:27490:7)
          at performUnitOfWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26599:12)
          at workLoopSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26505:5)
          at renderRootSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26473:7)
          at performConcurrentWorkOnRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25777:74)
          at flushActQueue (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2667:24)
          at act (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2582:11)
          at B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\act-compat.js:47:25
          at renderRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:190:26)
          at render (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:292:10)
          at renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:73:18)
          at Object.renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:203:5)
          at Promise.then.completed (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:316:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
          at run (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
          at runTestInternal (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:367:16)
          at runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:444:34)
          at Object.worker (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\testWorker.js:106:12) {
        detail: TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')
            at B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:131:56
            at Array.filter (<anonymous>)
            at filter (B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:131:26)
            at renderWithHooks (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:15486:18)
            at mountIndeterminateComponent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:20103:13)
            at beginWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:21626:16)
            at HTMLUnknownElement.callCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4164:14)
            at HTMLUnknownElement.callTheUserObjectsOperation (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventListener.js:26:30)
            at innerInvokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:350:25)
            at invokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:286:3)
            at HTMLUnknownElementImpl._dispatch (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:233:9)
            at HTMLUnknownElementImpl.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:104:17)
            at HTMLUnknownElement.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:241:34)
            at Object.invokeGuardedCallbackDev (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4213:16)
            at invokeGuardedCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4277:31)
            at beginWork$1 (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:27490:7)
            at performUnitOfWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26599:12)
            at workLoopSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26505:5)
            at renderRootSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26473:7)
            at performConcurrentWorkOnRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25777:74)
            at flushActQueue (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2667:24)
            at act (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2582:11)
            at B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\act-compat.js:47:25
            at renderRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:190:26)
            at render (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:292:10)
            at renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:73:18)
            at Object.renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:203:5)
            at Promise.then.completed (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:298:28)
            at new Promise (<anonymous>)
            at callAsyncCircusFn (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:231:10)
            at _callCircusTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:316:40)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at _runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:252:3)
            at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:126:9)
            at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
            at run (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:71:3)
            at runAndTransformResultsToJestFormat (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
            at jestAdapter (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
            at runTestInternal (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:367:16)
            at runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:444:34)
            at Object.worker (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\testWorker.js:106:12),
        type: 'unhandled exception'
      }

    [0m [90m 71 |[39m
     [90m 72 |[39m   [36mconst[39m renderForm [33m=[39m (initialData [33m=[39m {}) [33m=>[39m {
    [31m[1m>[22m[39m[90m 73 |[39m     [36mreturn[39m render(
     [90m    |[39m                  [31m[1m^[22m[39m
     [90m 74 |[39m       [33m<[39m[33mHealthAssessmentForm[39m
     [90m 75 |[39m         onSubmit[33m=[39m{mockOnSubmit}
     [90m 76 |[39m         onCancel[33m=[39m{mockOnCancel}[0m

      at VirtualConsole.<anonymous> (node_modules/jest-environment-jsdom/build/index.js:63:23)
      at reportException (node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:70:28)
      at innerInvokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
      at invokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
      at HTMLUnknownElementImpl._dispatch (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
      at HTMLUnknownElementImpl.dispatchEvent (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
      at HTMLUnknownElement.dispatchEvent (node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
      at Object.invokeGuardedCallbackDev (node_modules/react-dom/cjs/react-dom.development.js:4213:16)
      at invokeGuardedCallback (node_modules/react-dom/cjs/react-dom.development.js:4277:31)
      at beginWork$1 (node_modules/react-dom/cjs/react-dom.development.js:27490:7)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26599:12)
      at workLoopSync (node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25777:74)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:203:5)

    console.error
      Error: Uncaught [TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')]
          at reportException (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\helpers\runtime-script-errors.js:66:24)
          at innerInvokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:353:9)
          at invokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:286:3)
          at HTMLUnknownElementImpl._dispatch (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:233:9)
          at HTMLUnknownElementImpl.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:104:17)
          at HTMLUnknownElement.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:241:34)
          at Object.invokeGuardedCallbackDev (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4213:16)
          at invokeGuardedCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4277:31)
          at beginWork$1 (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:27490:7)
          at performUnitOfWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26599:12)
          at workLoopSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26505:5)
          at renderRootSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26473:7)
          at recoverFromConcurrentError (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25889:20)
          at performConcurrentWorkOnRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25789:22)
          at flushActQueue (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2667:24)
          at act (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2582:11)
          at B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\act-compat.js:47:25
          at renderRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:190:26)
          at render (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:292:10)
          at renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:73:18)
          at Object.renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:203:5)
          at Promise.then.completed (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:316:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
          at run (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
          at runTestInternal (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:367:16)
          at runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:444:34)
          at Object.worker (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\testWorker.js:106:12) {
        detail: TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')
            at B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:131:56
            at Array.filter (<anonymous>)
            at filter (B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:131:26)
            at renderWithHooks (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:15486:18)
            at mountIndeterminateComponent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:20103:13)
            at beginWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:21626:16)
            at HTMLUnknownElement.callCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4164:14)
            at HTMLUnknownElement.callTheUserObjectsOperation (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventListener.js:26:30)
            at innerInvokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:350:25)
            at invokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:286:3)
            at HTMLUnknownElementImpl._dispatch (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:233:9)
            at HTMLUnknownElementImpl.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:104:17)
            at HTMLUnknownElement.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:241:34)
            at Object.invokeGuardedCallbackDev (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4213:16)
            at invokeGuardedCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4277:31)
            at beginWork$1 (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:27490:7)
            at performUnitOfWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26599:12)
            at workLoopSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26505:5)
            at renderRootSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26473:7)
            at recoverFromConcurrentError (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25889:20)
            at performConcurrentWorkOnRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25789:22)
            at flushActQueue (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2667:24)
            at act (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2582:11)
            at B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\act-compat.js:47:25
            at renderRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:190:26)
            at render (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:292:10)
            at renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:73:18)
            at Object.renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:203:5)
            at Promise.then.completed (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:298:28)
            at new Promise (<anonymous>)
            at callAsyncCircusFn (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:231:10)
            at _callCircusTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:316:40)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at _runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:252:3)
            at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:126:9)
            at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
            at run (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:71:3)
            at runAndTransformResultsToJestFormat (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
            at jestAdapter (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
            at runTestInternal (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:367:16)
            at runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:444:34)
            at Object.worker (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\testWorker.js:106:12),
        type: 'unhandled exception'
      }

    [0m [90m 71 |[39m
     [90m 72 |[39m   [36mconst[39m renderForm [33m=[39m (initialData [33m=[39m {}) [33m=>[39m {
    [31m[1m>[22m[39m[90m 73 |[39m     [36mreturn[39m render(
     [90m    |[39m                  [31m[1m^[22m[39m
     [90m 74 |[39m       [33m<[39m[33mHealthAssessmentForm[39m
     [90m 75 |[39m         onSubmit[33m=[39m{mockOnSubmit}
     [90m 76 |[39m         onCancel[33m=[39m{mockOnCancel}[0m

      at VirtualConsole.<anonymous> (node_modules/jest-environment-jsdom/build/index.js:63:23)
      at reportException (node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:70:28)
      at innerInvokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
      at invokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
      at HTMLUnknownElementImpl._dispatch (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
      at HTMLUnknownElementImpl.dispatchEvent (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
      at HTMLUnknownElement.dispatchEvent (node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
      at Object.invokeGuardedCallbackDev (node_modules/react-dom/cjs/react-dom.development.js:4213:16)
      at invokeGuardedCallback (node_modules/react-dom/cjs/react-dom.development.js:4277:31)
      at beginWork$1 (node_modules/react-dom/cjs/react-dom.development.js:27490:7)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26599:12)
      at workLoopSync (node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at recoverFromConcurrentError (node_modules/react-dom/cjs/react-dom.development.js:25889:20)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25789:22)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:203:5)

    console.error
      The above error occurred in the <HealthAssessmentForm> component:
      
          at entityId (B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:90:3)
      
      Consider adding an error boundary to your tree to customize error handling behavior.
      Visit https://reactjs.org/link/error-boundaries to learn more about error boundaries.

    [0m [90m 71 |[39m
     [90m 72 |[39m   [36mconst[39m renderForm [33m=[39m (initialData [33m=[39m {}) [33m=>[39m {
    [31m[1m>[22m[39m[90m 73 |[39m     [36mreturn[39m render(
     [90m    |[39m                  [31m[1m^[22m[39m
     [90m 74 |[39m       [33m<[39m[33mHealthAssessmentForm[39m
     [90m 75 |[39m         onSubmit[33m=[39m{mockOnSubmit}
     [90m 76 |[39m         onCancel[33m=[39m{mockOnCancel}[0m

      at logCapturedError (node_modules/react-dom/cjs/react-dom.development.js:18704:23)
      at update.callback (node_modules/react-dom/cjs/react-dom.development.js:18737:5)
      at callCallback (node_modules/react-dom/cjs/react-dom.development.js:15036:12)
      at commitUpdateQueue (node_modules/react-dom/cjs/react-dom.development.js:15057:9)
      at commitLayoutEffectOnFiber (node_modules/react-dom/cjs/react-dom.development.js:23430:13)
      at commitLayoutMountEffects_complete (node_modules/react-dom/cjs/react-dom.development.js:24727:9)
      at commitLayoutEffects_begin (node_modules/react-dom/cjs/react-dom.development.js:24713:7)
      at commitLayoutEffects (node_modules/react-dom/cjs/react-dom.development.js:24651:3)
      at commitRootImpl (node_modules/react-dom/cjs/react-dom.development.js:26862:5)
      at commitRoot (node_modules/react-dom/cjs/react-dom.development.js:26721:5)
      at finishConcurrentRender (node_modules/react-dom/cjs/react-dom.development.js:25931:9)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25848:7)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:203:5)

    console.error
      Error: Uncaught [TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')]
          at reportException (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\helpers\runtime-script-errors.js:66:24)
          at innerInvokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:353:9)
          at invokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:286:3)
          at HTMLUnknownElementImpl._dispatch (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:233:9)
          at HTMLUnknownElementImpl.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:104:17)
          at HTMLUnknownElement.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:241:34)
          at Object.invokeGuardedCallbackDev (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4213:16)
          at invokeGuardedCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4277:31)
          at beginWork$1 (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:27490:7)
          at performUnitOfWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26599:12)
          at workLoopSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26505:5)
          at renderRootSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26473:7)
          at performConcurrentWorkOnRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25777:74)
          at flushActQueue (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2667:24)
          at act (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2582:11)
          at B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\act-compat.js:47:25
          at renderRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:190:26)
          at render (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:292:10)
          at renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:73:18)
          at Object.renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:214:5)
          at Promise.then.completed (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:316:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
          at run (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
          at runTestInternal (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:367:16)
          at runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:444:34)
          at Object.worker (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\testWorker.js:106:12) {
        detail: TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')
            at B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:131:56
            at Array.filter (<anonymous>)
            at filter (B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:131:26)
            at renderWithHooks (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:15486:18)
            at mountIndeterminateComponent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:20103:13)
            at beginWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:21626:16)
            at HTMLUnknownElement.callCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4164:14)
            at HTMLUnknownElement.callTheUserObjectsOperation (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventListener.js:26:30)
            at innerInvokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:350:25)
            at invokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:286:3)
            at HTMLUnknownElementImpl._dispatch (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:233:9)
            at HTMLUnknownElementImpl.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:104:17)
            at HTMLUnknownElement.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:241:34)
            at Object.invokeGuardedCallbackDev (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4213:16)
            at invokeGuardedCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4277:31)
            at beginWork$1 (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:27490:7)
            at performUnitOfWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26599:12)
            at workLoopSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26505:5)
            at renderRootSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26473:7)
            at performConcurrentWorkOnRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25777:74)
            at flushActQueue (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2667:24)
            at act (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2582:11)
            at B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\act-compat.js:47:25
            at renderRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:190:26)
            at render (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:292:10)
            at renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:73:18)
            at Object.renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:214:5)
            at Promise.then.completed (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:298:28)
            at new Promise (<anonymous>)
            at callAsyncCircusFn (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:231:10)
            at _callCircusTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:316:40)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at _runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:252:3)
            at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:126:9)
            at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
            at run (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:71:3)
            at runAndTransformResultsToJestFormat (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
            at jestAdapter (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
            at runTestInternal (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:367:16)
            at runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:444:34)
            at Object.worker (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\testWorker.js:106:12),
        type: 'unhandled exception'
      }

    [0m [90m 71 |[39m
     [90m 72 |[39m   [36mconst[39m renderForm [33m=[39m (initialData [33m=[39m {}) [33m=>[39m {
    [31m[1m>[22m[39m[90m 73 |[39m     [36mreturn[39m render(
     [90m    |[39m                  [31m[1m^[22m[39m
     [90m 74 |[39m       [33m<[39m[33mHealthAssessmentForm[39m
     [90m 75 |[39m         onSubmit[33m=[39m{mockOnSubmit}
     [90m 76 |[39m         onCancel[33m=[39m{mockOnCancel}[0m

      at VirtualConsole.<anonymous> (node_modules/jest-environment-jsdom/build/index.js:63:23)
      at reportException (node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:70:28)
      at innerInvokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
      at invokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
      at HTMLUnknownElementImpl._dispatch (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
      at HTMLUnknownElementImpl.dispatchEvent (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
      at HTMLUnknownElement.dispatchEvent (node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
      at Object.invokeGuardedCallbackDev (node_modules/react-dom/cjs/react-dom.development.js:4213:16)
      at invokeGuardedCallback (node_modules/react-dom/cjs/react-dom.development.js:4277:31)
      at beginWork$1 (node_modules/react-dom/cjs/react-dom.development.js:27490:7)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26599:12)
      at workLoopSync (node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25777:74)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:214:5)

    console.error
      Error: Uncaught [TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')]
          at reportException (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\helpers\runtime-script-errors.js:66:24)
          at innerInvokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:353:9)
          at invokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:286:3)
          at HTMLUnknownElementImpl._dispatch (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:233:9)
          at HTMLUnknownElementImpl.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:104:17)
          at HTMLUnknownElement.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:241:34)
          at Object.invokeGuardedCallbackDev (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4213:16)
          at invokeGuardedCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4277:31)
          at beginWork$1 (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:27490:7)
          at performUnitOfWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26599:12)
          at workLoopSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26505:5)
          at renderRootSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26473:7)
          at recoverFromConcurrentError (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25889:20)
          at performConcurrentWorkOnRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25789:22)
          at flushActQueue (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2667:24)
          at act (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2582:11)
          at B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\act-compat.js:47:25
          at renderRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:190:26)
          at render (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:292:10)
          at renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:73:18)
          at Object.renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:214:5)
          at Promise.then.completed (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:316:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
          at run (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
          at runTestInternal (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:367:16)
          at runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:444:34)
          at Object.worker (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\testWorker.js:106:12) {
        detail: TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')
            at B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:131:56
            at Array.filter (<anonymous>)
            at filter (B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:131:26)
            at renderWithHooks (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:15486:18)
            at mountIndeterminateComponent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:20103:13)
            at beginWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:21626:16)
            at HTMLUnknownElement.callCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4164:14)
            at HTMLUnknownElement.callTheUserObjectsOperation (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventListener.js:26:30)
            at innerInvokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:350:25)
            at invokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:286:3)
            at HTMLUnknownElementImpl._dispatch (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:233:9)
            at HTMLUnknownElementImpl.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:104:17)
            at HTMLUnknownElement.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:241:34)
            at Object.invokeGuardedCallbackDev (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4213:16)
            at invokeGuardedCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4277:31)
            at beginWork$1 (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:27490:7)
            at performUnitOfWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26599:12)
            at workLoopSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26505:5)
            at renderRootSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26473:7)
            at recoverFromConcurrentError (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25889:20)
            at performConcurrentWorkOnRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25789:22)
            at flushActQueue (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2667:24)
            at act (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2582:11)
            at B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\act-compat.js:47:25
            at renderRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:190:26)
            at render (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:292:10)
            at renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:73:18)
            at Object.renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:214:5)
            at Promise.then.completed (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:298:28)
            at new Promise (<anonymous>)
            at callAsyncCircusFn (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:231:10)
            at _callCircusTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:316:40)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at _runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:252:3)
            at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:126:9)
            at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
            at run (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:71:3)
            at runAndTransformResultsToJestFormat (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
            at jestAdapter (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
            at runTestInternal (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:367:16)
            at runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:444:34)
            at Object.worker (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\testWorker.js:106:12),
        type: 'unhandled exception'
      }

    [0m [90m 71 |[39m
     [90m 72 |[39m   [36mconst[39m renderForm [33m=[39m (initialData [33m=[39m {}) [33m=>[39m {
    [31m[1m>[22m[39m[90m 73 |[39m     [36mreturn[39m render(
     [90m    |[39m                  [31m[1m^[22m[39m
     [90m 74 |[39m       [33m<[39m[33mHealthAssessmentForm[39m
     [90m 75 |[39m         onSubmit[33m=[39m{mockOnSubmit}
     [90m 76 |[39m         onCancel[33m=[39m{mockOnCancel}[0m

      at VirtualConsole.<anonymous> (node_modules/jest-environment-jsdom/build/index.js:63:23)
      at reportException (node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:70:28)
      at innerInvokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
      at invokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
      at HTMLUnknownElementImpl._dispatch (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
      at HTMLUnknownElementImpl.dispatchEvent (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
      at HTMLUnknownElement.dispatchEvent (node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
      at Object.invokeGuardedCallbackDev (node_modules/react-dom/cjs/react-dom.development.js:4213:16)
      at invokeGuardedCallback (node_modules/react-dom/cjs/react-dom.development.js:4277:31)
      at beginWork$1 (node_modules/react-dom/cjs/react-dom.development.js:27490:7)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26599:12)
      at workLoopSync (node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at recoverFromConcurrentError (node_modules/react-dom/cjs/react-dom.development.js:25889:20)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25789:22)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:214:5)

    console.error
      The above error occurred in the <HealthAssessmentForm> component:
      
          at entityId (B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:90:3)
      
      Consider adding an error boundary to your tree to customize error handling behavior.
      Visit https://reactjs.org/link/error-boundaries to learn more about error boundaries.

    [0m [90m 71 |[39m
     [90m 72 |[39m   [36mconst[39m renderForm [33m=[39m (initialData [33m=[39m {}) [33m=>[39m {
    [31m[1m>[22m[39m[90m 73 |[39m     [36mreturn[39m render(
     [90m    |[39m                  [31m[1m^[22m[39m
     [90m 74 |[39m       [33m<[39m[33mHealthAssessmentForm[39m
     [90m 75 |[39m         onSubmit[33m=[39m{mockOnSubmit}
     [90m 76 |[39m         onCancel[33m=[39m{mockOnCancel}[0m

      at logCapturedError (node_modules/react-dom/cjs/react-dom.development.js:18704:23)
      at update.callback (node_modules/react-dom/cjs/react-dom.development.js:18737:5)
      at callCallback (node_modules/react-dom/cjs/react-dom.development.js:15036:12)
      at commitUpdateQueue (node_modules/react-dom/cjs/react-dom.development.js:15057:9)
      at commitLayoutEffectOnFiber (node_modules/react-dom/cjs/react-dom.development.js:23430:13)
      at commitLayoutMountEffects_complete (node_modules/react-dom/cjs/react-dom.development.js:24727:9)
      at commitLayoutEffects_begin (node_modules/react-dom/cjs/react-dom.development.js:24713:7)
      at commitLayoutEffects (node_modules/react-dom/cjs/react-dom.development.js:24651:3)
      at commitRootImpl (node_modules/react-dom/cjs/react-dom.development.js:26862:5)
      at commitRoot (node_modules/react-dom/cjs/react-dom.development.js:26721:5)
      at finishConcurrentRender (node_modules/react-dom/cjs/react-dom.development.js:25931:9)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25848:7)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:214:5)

    console.error
      Error: Uncaught [TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')]
          at reportException (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\helpers\runtime-script-errors.js:66:24)
          at innerInvokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:353:9)
          at invokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:286:3)
          at HTMLUnknownElementImpl._dispatch (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:233:9)
          at HTMLUnknownElementImpl.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:104:17)
          at HTMLUnknownElement.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:241:34)
          at Object.invokeGuardedCallbackDev (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4213:16)
          at invokeGuardedCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4277:31)
          at beginWork$1 (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:27490:7)
          at performUnitOfWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26599:12)
          at workLoopSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26505:5)
          at renderRootSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26473:7)
          at performConcurrentWorkOnRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25777:74)
          at flushActQueue (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2667:24)
          at act (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2582:11)
          at B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\act-compat.js:47:25
          at renderRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:190:26)
          at render (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:292:10)
          at renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:73:18)
          at Object.renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:259:5)
          at Promise.then.completed (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:316:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
          at run (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
          at runTestInternal (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:367:16)
          at runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:444:34)
          at Object.worker (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\testWorker.js:106:12) {
        detail: TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')
            at B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:131:56
            at Array.filter (<anonymous>)
            at filter (B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:131:26)
            at renderWithHooks (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:15486:18)
            at mountIndeterminateComponent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:20103:13)
            at beginWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:21626:16)
            at HTMLUnknownElement.callCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4164:14)
            at HTMLUnknownElement.callTheUserObjectsOperation (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventListener.js:26:30)
            at innerInvokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:350:25)
            at invokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:286:3)
            at HTMLUnknownElementImpl._dispatch (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:233:9)
            at HTMLUnknownElementImpl.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:104:17)
            at HTMLUnknownElement.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:241:34)
            at Object.invokeGuardedCallbackDev (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4213:16)
            at invokeGuardedCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4277:31)
            at beginWork$1 (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:27490:7)
            at performUnitOfWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26599:12)
            at workLoopSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26505:5)
            at renderRootSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26473:7)
            at performConcurrentWorkOnRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25777:74)
            at flushActQueue (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2667:24)
            at act (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2582:11)
            at B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\act-compat.js:47:25
            at renderRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:190:26)
            at render (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:292:10)
            at renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:73:18)
            at Object.renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:259:5)
            at Promise.then.completed (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:298:28)
            at new Promise (<anonymous>)
            at callAsyncCircusFn (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:231:10)
            at _callCircusTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:316:40)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at _runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:252:3)
            at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:126:9)
            at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
            at run (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:71:3)
            at runAndTransformResultsToJestFormat (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
            at jestAdapter (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
            at runTestInternal (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:367:16)
            at runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:444:34)
            at Object.worker (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\testWorker.js:106:12),
        type: 'unhandled exception'
      }

    [0m [90m 71 |[39m
     [90m 72 |[39m   [36mconst[39m renderForm [33m=[39m (initialData [33m=[39m {}) [33m=>[39m {
    [31m[1m>[22m[39m[90m 73 |[39m     [36mreturn[39m render(
     [90m    |[39m                  [31m[1m^[22m[39m
     [90m 74 |[39m       [33m<[39m[33mHealthAssessmentForm[39m
     [90m 75 |[39m         onSubmit[33m=[39m{mockOnSubmit}
     [90m 76 |[39m         onCancel[33m=[39m{mockOnCancel}[0m

      at VirtualConsole.<anonymous> (node_modules/jest-environment-jsdom/build/index.js:63:23)
      at reportException (node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:70:28)
      at innerInvokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
      at invokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
      at HTMLUnknownElementImpl._dispatch (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
      at HTMLUnknownElementImpl.dispatchEvent (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
      at HTMLUnknownElement.dispatchEvent (node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
      at Object.invokeGuardedCallbackDev (node_modules/react-dom/cjs/react-dom.development.js:4213:16)
      at invokeGuardedCallback (node_modules/react-dom/cjs/react-dom.development.js:4277:31)
      at beginWork$1 (node_modules/react-dom/cjs/react-dom.development.js:27490:7)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26599:12)
      at workLoopSync (node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25777:74)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:259:5)

    console.error
      Error: Uncaught [TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')]
          at reportException (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\helpers\runtime-script-errors.js:66:24)
          at innerInvokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:353:9)
          at invokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:286:3)
          at HTMLUnknownElementImpl._dispatch (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:233:9)
          at HTMLUnknownElementImpl.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:104:17)
          at HTMLUnknownElement.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:241:34)
          at Object.invokeGuardedCallbackDev (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4213:16)
          at invokeGuardedCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4277:31)
          at beginWork$1 (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:27490:7)
          at performUnitOfWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26599:12)
          at workLoopSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26505:5)
          at renderRootSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26473:7)
          at recoverFromConcurrentError (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25889:20)
          at performConcurrentWorkOnRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25789:22)
          at flushActQueue (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2667:24)
          at act (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2582:11)
          at B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\act-compat.js:47:25
          at renderRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:190:26)
          at render (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:292:10)
          at renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:73:18)
          at Object.renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:259:5)
          at Promise.then.completed (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:316:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
          at run (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
          at runTestInternal (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:367:16)
          at runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:444:34)
          at Object.worker (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\testWorker.js:106:12) {
        detail: TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')
            at B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:131:56
            at Array.filter (<anonymous>)
            at filter (B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:131:26)
            at renderWithHooks (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:15486:18)
            at mountIndeterminateComponent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:20103:13)
            at beginWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:21626:16)
            at HTMLUnknownElement.callCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4164:14)
            at HTMLUnknownElement.callTheUserObjectsOperation (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventListener.js:26:30)
            at innerInvokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:350:25)
            at invokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:286:3)
            at HTMLUnknownElementImpl._dispatch (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:233:9)
            at HTMLUnknownElementImpl.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:104:17)
            at HTMLUnknownElement.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:241:34)
            at Object.invokeGuardedCallbackDev (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4213:16)
            at invokeGuardedCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4277:31)
            at beginWork$1 (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:27490:7)
            at performUnitOfWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26599:12)
            at workLoopSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26505:5)
            at renderRootSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26473:7)
            at recoverFromConcurrentError (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25889:20)
            at performConcurrentWorkOnRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25789:22)
            at flushActQueue (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2667:24)
            at act (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2582:11)
            at B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\act-compat.js:47:25
            at renderRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:190:26)
            at render (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:292:10)
            at renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:73:18)
            at Object.renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:259:5)
            at Promise.then.completed (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:298:28)
            at new Promise (<anonymous>)
            at callAsyncCircusFn (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:231:10)
            at _callCircusTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:316:40)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at _runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:252:3)
            at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:126:9)
            at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
            at run (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:71:3)
            at runAndTransformResultsToJestFormat (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
            at jestAdapter (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
            at runTestInternal (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:367:16)
            at runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:444:34)
            at Object.worker (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\testWorker.js:106:12),
        type: 'unhandled exception'
      }

    [0m [90m 71 |[39m
     [90m 72 |[39m   [36mconst[39m renderForm [33m=[39m (initialData [33m=[39m {}) [33m=>[39m {
    [31m[1m>[22m[39m[90m 73 |[39m     [36mreturn[39m render(
     [90m    |[39m                  [31m[1m^[22m[39m
     [90m 74 |[39m       [33m<[39m[33mHealthAssessmentForm[39m
     [90m 75 |[39m         onSubmit[33m=[39m{mockOnSubmit}
     [90m 76 |[39m         onCancel[33m=[39m{mockOnCancel}[0m

      at VirtualConsole.<anonymous> (node_modules/jest-environment-jsdom/build/index.js:63:23)
      at reportException (node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:70:28)
      at innerInvokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
      at invokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
      at HTMLUnknownElementImpl._dispatch (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
      at HTMLUnknownElementImpl.dispatchEvent (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
      at HTMLUnknownElement.dispatchEvent (node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
      at Object.invokeGuardedCallbackDev (node_modules/react-dom/cjs/react-dom.development.js:4213:16)
      at invokeGuardedCallback (node_modules/react-dom/cjs/react-dom.development.js:4277:31)
      at beginWork$1 (node_modules/react-dom/cjs/react-dom.development.js:27490:7)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26599:12)
      at workLoopSync (node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at recoverFromConcurrentError (node_modules/react-dom/cjs/react-dom.development.js:25889:20)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25789:22)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:259:5)

    console.error
      The above error occurred in the <HealthAssessmentForm> component:
      
          at entityId (B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:90:3)
      
      Consider adding an error boundary to your tree to customize error handling behavior.
      Visit https://reactjs.org/link/error-boundaries to learn more about error boundaries.

    [0m [90m 71 |[39m
     [90m 72 |[39m   [36mconst[39m renderForm [33m=[39m (initialData [33m=[39m {}) [33m=>[39m {
    [31m[1m>[22m[39m[90m 73 |[39m     [36mreturn[39m render(
     [90m    |[39m                  [31m[1m^[22m[39m
     [90m 74 |[39m       [33m<[39m[33mHealthAssessmentForm[39m
     [90m 75 |[39m         onSubmit[33m=[39m{mockOnSubmit}
     [90m 76 |[39m         onCancel[33m=[39m{mockOnCancel}[0m

      at logCapturedError (node_modules/react-dom/cjs/react-dom.development.js:18704:23)
      at update.callback (node_modules/react-dom/cjs/react-dom.development.js:18737:5)
      at callCallback (node_modules/react-dom/cjs/react-dom.development.js:15036:12)
      at commitUpdateQueue (node_modules/react-dom/cjs/react-dom.development.js:15057:9)
      at commitLayoutEffectOnFiber (node_modules/react-dom/cjs/react-dom.development.js:23430:13)
      at commitLayoutMountEffects_complete (node_modules/react-dom/cjs/react-dom.development.js:24727:9)
      at commitLayoutEffects_begin (node_modules/react-dom/cjs/react-dom.development.js:24713:7)
      at commitLayoutEffects (node_modules/react-dom/cjs/react-dom.development.js:24651:3)
      at commitRootImpl (node_modules/react-dom/cjs/react-dom.development.js:26862:5)
      at commitRoot (node_modules/react-dom/cjs/react-dom.development.js:26721:5)
      at finishConcurrentRender (node_modules/react-dom/cjs/react-dom.development.js:25931:9)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25848:7)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:259:5)

    console.error
      Error: Uncaught [TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')]
          at reportException (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\helpers\runtime-script-errors.js:66:24)
          at innerInvokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:353:9)
          at invokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:286:3)
          at HTMLUnknownElementImpl._dispatch (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:233:9)
          at HTMLUnknownElementImpl.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:104:17)
          at HTMLUnknownElement.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:241:34)
          at Object.invokeGuardedCallbackDev (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4213:16)
          at invokeGuardedCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4277:31)
          at beginWork$1 (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:27490:7)
          at performUnitOfWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26599:12)
          at workLoopSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26505:5)
          at renderRootSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26473:7)
          at performConcurrentWorkOnRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25777:74)
          at flushActQueue (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2667:24)
          at act (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2582:11)
          at B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\act-compat.js:47:25
          at renderRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:190:26)
          at render (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:292:10)
          at renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:73:18)
          at Object.renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:270:5)
          at Promise.then.completed (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:316:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
          at run (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
          at runTestInternal (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:367:16)
          at runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:444:34)
          at Object.worker (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\testWorker.js:106:12) {
        detail: TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')
            at B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:131:56
            at Array.filter (<anonymous>)
            at filter (B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:131:26)
            at renderWithHooks (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:15486:18)
            at mountIndeterminateComponent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:20103:13)
            at beginWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:21626:16)
            at HTMLUnknownElement.callCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4164:14)
            at HTMLUnknownElement.callTheUserObjectsOperation (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventListener.js:26:30)
            at innerInvokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:350:25)
            at invokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:286:3)
            at HTMLUnknownElementImpl._dispatch (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:233:9)
            at HTMLUnknownElementImpl.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:104:17)
            at HTMLUnknownElement.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:241:34)
            at Object.invokeGuardedCallbackDev (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4213:16)
            at invokeGuardedCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4277:31)
            at beginWork$1 (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:27490:7)
            at performUnitOfWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26599:12)
            at workLoopSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26505:5)
            at renderRootSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26473:7)
            at performConcurrentWorkOnRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25777:74)
            at flushActQueue (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2667:24)
            at act (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2582:11)
            at B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\act-compat.js:47:25
            at renderRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:190:26)
            at render (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:292:10)
            at renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:73:18)
            at Object.renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:270:5)
            at Promise.then.completed (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:298:28)
            at new Promise (<anonymous>)
            at callAsyncCircusFn (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:231:10)
            at _callCircusTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:316:40)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at _runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:252:3)
            at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:126:9)
            at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
            at run (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:71:3)
            at runAndTransformResultsToJestFormat (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
            at jestAdapter (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
            at runTestInternal (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:367:16)
            at runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:444:34)
            at Object.worker (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\testWorker.js:106:12),
        type: 'unhandled exception'
      }

    [0m [90m 71 |[39m
     [90m 72 |[39m   [36mconst[39m renderForm [33m=[39m (initialData [33m=[39m {}) [33m=>[39m {
    [31m[1m>[22m[39m[90m 73 |[39m     [36mreturn[39m render(
     [90m    |[39m                  [31m[1m^[22m[39m
     [90m 74 |[39m       [33m<[39m[33mHealthAssessmentForm[39m
     [90m 75 |[39m         onSubmit[33m=[39m{mockOnSubmit}
     [90m 76 |[39m         onCancel[33m=[39m{mockOnCancel}[0m

      at VirtualConsole.<anonymous> (node_modules/jest-environment-jsdom/build/index.js:63:23)
      at reportException (node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:70:28)
      at innerInvokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
      at invokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
      at HTMLUnknownElementImpl._dispatch (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
      at HTMLUnknownElementImpl.dispatchEvent (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
      at HTMLUnknownElement.dispatchEvent (node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
      at Object.invokeGuardedCallbackDev (node_modules/react-dom/cjs/react-dom.development.js:4213:16)
      at invokeGuardedCallback (node_modules/react-dom/cjs/react-dom.development.js:4277:31)
      at beginWork$1 (node_modules/react-dom/cjs/react-dom.development.js:27490:7)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26599:12)
      at workLoopSync (node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25777:74)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:270:5)

    console.error
      Error: Uncaught [TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')]
          at reportException (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\helpers\runtime-script-errors.js:66:24)
          at innerInvokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:353:9)
          at invokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:286:3)
          at HTMLUnknownElementImpl._dispatch (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:233:9)
          at HTMLUnknownElementImpl.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:104:17)
          at HTMLUnknownElement.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:241:34)
          at Object.invokeGuardedCallbackDev (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4213:16)
          at invokeGuardedCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4277:31)
          at beginWork$1 (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:27490:7)
          at performUnitOfWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26599:12)
          at workLoopSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26505:5)
          at renderRootSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26473:7)
          at recoverFromConcurrentError (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25889:20)
          at performConcurrentWorkOnRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25789:22)
          at flushActQueue (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2667:24)
          at act (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2582:11)
          at B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\act-compat.js:47:25
          at renderRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:190:26)
          at render (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:292:10)
          at renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:73:18)
          at Object.renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:270:5)
          at Promise.then.completed (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:316:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
          at run (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
          at runTestInternal (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:367:16)
          at runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:444:34)
          at Object.worker (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\testWorker.js:106:12) {
        detail: TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')
            at B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:131:56
            at Array.filter (<anonymous>)
            at filter (B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:131:26)
            at renderWithHooks (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:15486:18)
            at mountIndeterminateComponent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:20103:13)
            at beginWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:21626:16)
            at HTMLUnknownElement.callCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4164:14)
            at HTMLUnknownElement.callTheUserObjectsOperation (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventListener.js:26:30)
            at innerInvokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:350:25)
            at invokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:286:3)
            at HTMLUnknownElementImpl._dispatch (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:233:9)
            at HTMLUnknownElementImpl.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:104:17)
            at HTMLUnknownElement.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:241:34)
            at Object.invokeGuardedCallbackDev (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4213:16)
            at invokeGuardedCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4277:31)
            at beginWork$1 (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:27490:7)
            at performUnitOfWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26599:12)
            at workLoopSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26505:5)
            at renderRootSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26473:7)
            at recoverFromConcurrentError (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25889:20)
            at performConcurrentWorkOnRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25789:22)
            at flushActQueue (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2667:24)
            at act (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2582:11)
            at B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\act-compat.js:47:25
            at renderRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:190:26)
            at render (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:292:10)
            at renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:73:18)
            at Object.renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:270:5)
            at Promise.then.completed (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:298:28)
            at new Promise (<anonymous>)
            at callAsyncCircusFn (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:231:10)
            at _callCircusTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:316:40)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at _runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:252:3)
            at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:126:9)
            at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
            at run (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:71:3)
            at runAndTransformResultsToJestFormat (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
            at jestAdapter (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
            at runTestInternal (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:367:16)
            at runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:444:34)
            at Object.worker (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\testWorker.js:106:12),
        type: 'unhandled exception'
      }

    [0m [90m 71 |[39m
     [90m 72 |[39m   [36mconst[39m renderForm [33m=[39m (initialData [33m=[39m {}) [33m=>[39m {
    [31m[1m>[22m[39m[90m 73 |[39m     [36mreturn[39m render(
     [90m    |[39m                  [31m[1m^[22m[39m
     [90m 74 |[39m       [33m<[39m[33mHealthAssessmentForm[39m
     [90m 75 |[39m         onSubmit[33m=[39m{mockOnSubmit}
     [90m 76 |[39m         onCancel[33m=[39m{mockOnCancel}[0m

      at VirtualConsole.<anonymous> (node_modules/jest-environment-jsdom/build/index.js:63:23)
      at reportException (node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:70:28)
      at innerInvokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
      at invokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
      at HTMLUnknownElementImpl._dispatch (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
      at HTMLUnknownElementImpl.dispatchEvent (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
      at HTMLUnknownElement.dispatchEvent (node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
      at Object.invokeGuardedCallbackDev (node_modules/react-dom/cjs/react-dom.development.js:4213:16)
      at invokeGuardedCallback (node_modules/react-dom/cjs/react-dom.development.js:4277:31)
      at beginWork$1 (node_modules/react-dom/cjs/react-dom.development.js:27490:7)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26599:12)
      at workLoopSync (node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at recoverFromConcurrentError (node_modules/react-dom/cjs/react-dom.development.js:25889:20)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25789:22)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:270:5)

    console.error
      The above error occurred in the <HealthAssessmentForm> component:
      
          at entityId (B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:90:3)
      
      Consider adding an error boundary to your tree to customize error handling behavior.
      Visit https://reactjs.org/link/error-boundaries to learn more about error boundaries.

    [0m [90m 71 |[39m
     [90m 72 |[39m   [36mconst[39m renderForm [33m=[39m (initialData [33m=[39m {}) [33m=>[39m {
    [31m[1m>[22m[39m[90m 73 |[39m     [36mreturn[39m render(
     [90m    |[39m                  [31m[1m^[22m[39m
     [90m 74 |[39m       [33m<[39m[33mHealthAssessmentForm[39m
     [90m 75 |[39m         onSubmit[33m=[39m{mockOnSubmit}
     [90m 76 |[39m         onCancel[33m=[39m{mockOnCancel}[0m

      at logCapturedError (node_modules/react-dom/cjs/react-dom.development.js:18704:23)
      at update.callback (node_modules/react-dom/cjs/react-dom.development.js:18737:5)
      at callCallback (node_modules/react-dom/cjs/react-dom.development.js:15036:12)
      at commitUpdateQueue (node_modules/react-dom/cjs/react-dom.development.js:15057:9)
      at commitLayoutEffectOnFiber (node_modules/react-dom/cjs/react-dom.development.js:23430:13)
      at commitLayoutMountEffects_complete (node_modules/react-dom/cjs/react-dom.development.js:24727:9)
      at commitLayoutEffects_begin (node_modules/react-dom/cjs/react-dom.development.js:24713:7)
      at commitLayoutEffects (node_modules/react-dom/cjs/react-dom.development.js:24651:3)
      at commitRootImpl (node_modules/react-dom/cjs/react-dom.development.js:26862:5)
      at commitRoot (node_modules/react-dom/cjs/react-dom.development.js:26721:5)
      at finishConcurrentRender (node_modules/react-dom/cjs/react-dom.development.js:25931:9)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25848:7)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:270:5)

    console.error
      Error: Uncaught [TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')]
          at reportException (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\helpers\runtime-script-errors.js:66:24)
          at innerInvokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:353:9)
          at invokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:286:3)
          at HTMLUnknownElementImpl._dispatch (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:233:9)
          at HTMLUnknownElementImpl.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:104:17)
          at HTMLUnknownElement.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:241:34)
          at Object.invokeGuardedCallbackDev (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4213:16)
          at invokeGuardedCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4277:31)
          at beginWork$1 (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:27490:7)
          at performUnitOfWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26599:12)
          at workLoopSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26505:5)
          at renderRootSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26473:7)
          at performConcurrentWorkOnRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25777:74)
          at flushActQueue (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2667:24)
          at act (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2582:11)
          at B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\act-compat.js:47:25
          at renderRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:190:26)
          at render (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:292:10)
          at renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:73:18)
          at Object.renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:289:5)
          at Promise.then.completed (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:316:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
          at run (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
          at runTestInternal (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:367:16)
          at runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:444:34)
          at Object.worker (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\testWorker.js:106:12) {
        detail: TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')
            at B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:131:56
            at Array.filter (<anonymous>)
            at filter (B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:131:26)
            at renderWithHooks (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:15486:18)
            at mountIndeterminateComponent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:20103:13)
            at beginWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:21626:16)
            at HTMLUnknownElement.callCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4164:14)
            at HTMLUnknownElement.callTheUserObjectsOperation (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventListener.js:26:30)
            at innerInvokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:350:25)
            at invokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:286:3)
            at HTMLUnknownElementImpl._dispatch (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:233:9)
            at HTMLUnknownElementImpl.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:104:17)
            at HTMLUnknownElement.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:241:34)
            at Object.invokeGuardedCallbackDev (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4213:16)
            at invokeGuardedCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4277:31)
            at beginWork$1 (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:27490:7)
            at performUnitOfWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26599:12)
            at workLoopSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26505:5)
            at renderRootSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26473:7)
            at performConcurrentWorkOnRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25777:74)
            at flushActQueue (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2667:24)
            at act (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2582:11)
            at B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\act-compat.js:47:25
            at renderRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:190:26)
            at render (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:292:10)
            at renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:73:18)
            at Object.renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:289:5)
            at Promise.then.completed (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:298:28)
            at new Promise (<anonymous>)
            at callAsyncCircusFn (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:231:10)
            at _callCircusTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:316:40)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at _runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:252:3)
            at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:126:9)
            at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
            at run (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:71:3)
            at runAndTransformResultsToJestFormat (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
            at jestAdapter (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
            at runTestInternal (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:367:16)
            at runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:444:34)
            at Object.worker (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\testWorker.js:106:12),
        type: 'unhandled exception'
      }

    [0m [90m 71 |[39m
     [90m 72 |[39m   [36mconst[39m renderForm [33m=[39m (initialData [33m=[39m {}) [33m=>[39m {
    [31m[1m>[22m[39m[90m 73 |[39m     [36mreturn[39m render(
     [90m    |[39m                  [31m[1m^[22m[39m
     [90m 74 |[39m       [33m<[39m[33mHealthAssessmentForm[39m
     [90m 75 |[39m         onSubmit[33m=[39m{mockOnSubmit}
     [90m 76 |[39m         onCancel[33m=[39m{mockOnCancel}[0m

      at VirtualConsole.<anonymous> (node_modules/jest-environment-jsdom/build/index.js:63:23)
      at reportException (node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:70:28)
      at innerInvokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
      at invokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
      at HTMLUnknownElementImpl._dispatch (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
      at HTMLUnknownElementImpl.dispatchEvent (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
      at HTMLUnknownElement.dispatchEvent (node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
      at Object.invokeGuardedCallbackDev (node_modules/react-dom/cjs/react-dom.development.js:4213:16)
      at invokeGuardedCallback (node_modules/react-dom/cjs/react-dom.development.js:4277:31)
      at beginWork$1 (node_modules/react-dom/cjs/react-dom.development.js:27490:7)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26599:12)
      at workLoopSync (node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25777:74)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:289:5)

    console.error
      Error: Uncaught [TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')]
          at reportException (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\helpers\runtime-script-errors.js:66:24)
          at innerInvokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:353:9)
          at invokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:286:3)
          at HTMLUnknownElementImpl._dispatch (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:233:9)
          at HTMLUnknownElementImpl.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:104:17)
          at HTMLUnknownElement.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:241:34)
          at Object.invokeGuardedCallbackDev (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4213:16)
          at invokeGuardedCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4277:31)
          at beginWork$1 (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:27490:7)
          at performUnitOfWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26599:12)
          at workLoopSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26505:5)
          at renderRootSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26473:7)
          at recoverFromConcurrentError (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25889:20)
          at performConcurrentWorkOnRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25789:22)
          at flushActQueue (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2667:24)
          at act (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2582:11)
          at B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\act-compat.js:47:25
          at renderRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:190:26)
          at render (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:292:10)
          at renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:73:18)
          at Object.renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:289:5)
          at Promise.then.completed (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:316:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
          at run (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
          at runTestInternal (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:367:16)
          at runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:444:34)
          at Object.worker (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\testWorker.js:106:12) {
        detail: TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')
            at B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:131:56
            at Array.filter (<anonymous>)
            at filter (B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:131:26)
            at renderWithHooks (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:15486:18)
            at mountIndeterminateComponent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:20103:13)
            at beginWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:21626:16)
            at HTMLUnknownElement.callCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4164:14)
            at HTMLUnknownElement.callTheUserObjectsOperation (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventListener.js:26:30)
            at innerInvokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:350:25)
            at invokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:286:3)
            at HTMLUnknownElementImpl._dispatch (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:233:9)
            at HTMLUnknownElementImpl.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:104:17)
            at HTMLUnknownElement.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:241:34)
            at Object.invokeGuardedCallbackDev (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4213:16)
            at invokeGuardedCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4277:31)
            at beginWork$1 (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:27490:7)
            at performUnitOfWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26599:12)
            at workLoopSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26505:5)
            at renderRootSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26473:7)
            at recoverFromConcurrentError (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25889:20)
            at performConcurrentWorkOnRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25789:22)
            at flushActQueue (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2667:24)
            at act (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2582:11)
            at B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\act-compat.js:47:25
            at renderRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:190:26)
            at render (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:292:10)
            at renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:73:18)
            at Object.renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:289:5)
            at Promise.then.completed (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:298:28)
            at new Promise (<anonymous>)
            at callAsyncCircusFn (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:231:10)
            at _callCircusTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:316:40)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at _runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:252:3)
            at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:126:9)
            at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
            at run (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:71:3)
            at runAndTransformResultsToJestFormat (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
            at jestAdapter (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
            at runTestInternal (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:367:16)
            at runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:444:34)
            at Object.worker (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\testWorker.js:106:12),
        type: 'unhandled exception'
      }

    [0m [90m 71 |[39m
     [90m 72 |[39m   [36mconst[39m renderForm [33m=[39m (initialData [33m=[39m {}) [33m=>[39m {
    [31m[1m>[22m[39m[90m 73 |[39m     [36mreturn[39m render(
     [90m    |[39m                  [31m[1m^[22m[39m
     [90m 74 |[39m       [33m<[39m[33mHealthAssessmentForm[39m
     [90m 75 |[39m         onSubmit[33m=[39m{mockOnSubmit}
     [90m 76 |[39m         onCancel[33m=[39m{mockOnCancel}[0m

      at VirtualConsole.<anonymous> (node_modules/jest-environment-jsdom/build/index.js:63:23)
      at reportException (node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:70:28)
      at innerInvokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
      at invokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
      at HTMLUnknownElementImpl._dispatch (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
      at HTMLUnknownElementImpl.dispatchEvent (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
      at HTMLUnknownElement.dispatchEvent (node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
      at Object.invokeGuardedCallbackDev (node_modules/react-dom/cjs/react-dom.development.js:4213:16)
      at invokeGuardedCallback (node_modules/react-dom/cjs/react-dom.development.js:4277:31)
      at beginWork$1 (node_modules/react-dom/cjs/react-dom.development.js:27490:7)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26599:12)
      at workLoopSync (node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at recoverFromConcurrentError (node_modules/react-dom/cjs/react-dom.development.js:25889:20)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25789:22)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:289:5)

    console.error
      The above error occurred in the <HealthAssessmentForm> component:
      
          at entityId (B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:90:3)
      
      Consider adding an error boundary to your tree to customize error handling behavior.
      Visit https://reactjs.org/link/error-boundaries to learn more about error boundaries.

    [0m [90m 71 |[39m
     [90m 72 |[39m   [36mconst[39m renderForm [33m=[39m (initialData [33m=[39m {}) [33m=>[39m {
    [31m[1m>[22m[39m[90m 73 |[39m     [36mreturn[39m render(
     [90m    |[39m                  [31m[1m^[22m[39m
     [90m 74 |[39m       [33m<[39m[33mHealthAssessmentForm[39m
     [90m 75 |[39m         onSubmit[33m=[39m{mockOnSubmit}
     [90m 76 |[39m         onCancel[33m=[39m{mockOnCancel}[0m

      at logCapturedError (node_modules/react-dom/cjs/react-dom.development.js:18704:23)
      at update.callback (node_modules/react-dom/cjs/react-dom.development.js:18737:5)
      at callCallback (node_modules/react-dom/cjs/react-dom.development.js:15036:12)
      at commitUpdateQueue (node_modules/react-dom/cjs/react-dom.development.js:15057:9)
      at commitLayoutEffectOnFiber (node_modules/react-dom/cjs/react-dom.development.js:23430:13)
      at commitLayoutMountEffects_complete (node_modules/react-dom/cjs/react-dom.development.js:24727:9)
      at commitLayoutEffects_begin (node_modules/react-dom/cjs/react-dom.development.js:24713:7)
      at commitLayoutEffects (node_modules/react-dom/cjs/react-dom.development.js:24651:3)
      at commitRootImpl (node_modules/react-dom/cjs/react-dom.development.js:26862:5)
      at commitRoot (node_modules/react-dom/cjs/react-dom.development.js:26721:5)
      at finishConcurrentRender (node_modules/react-dom/cjs/react-dom.development.js:25931:9)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25848:7)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:289:5)

    console.error
      Error: Uncaught [TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')]
          at reportException (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\helpers\runtime-script-errors.js:66:24)
          at innerInvokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:353:9)
          at invokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:286:3)
          at HTMLUnknownElementImpl._dispatch (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:233:9)
          at HTMLUnknownElementImpl.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:104:17)
          at HTMLUnknownElement.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:241:34)
          at Object.invokeGuardedCallbackDev (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4213:16)
          at invokeGuardedCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4277:31)
          at beginWork$1 (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:27490:7)
          at performUnitOfWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26599:12)
          at workLoopSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26505:5)
          at renderRootSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26473:7)
          at performConcurrentWorkOnRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25777:74)
          at flushActQueue (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2667:24)
          at act (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2582:11)
          at B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\act-compat.js:47:25
          at renderRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:190:26)
          at render (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:292:10)
          at renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:73:18)
          at Object.renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:298:5)
          at Promise.then.completed (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:316:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
          at run (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
          at runTestInternal (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:367:16)
          at runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:444:34)
          at Object.worker (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\testWorker.js:106:12) {
        detail: TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')
            at B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:131:56
            at Array.filter (<anonymous>)
            at filter (B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:131:26)
            at renderWithHooks (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:15486:18)
            at mountIndeterminateComponent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:20103:13)
            at beginWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:21626:16)
            at HTMLUnknownElement.callCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4164:14)
            at HTMLUnknownElement.callTheUserObjectsOperation (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventListener.js:26:30)
            at innerInvokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:350:25)
            at invokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:286:3)
            at HTMLUnknownElementImpl._dispatch (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:233:9)
            at HTMLUnknownElementImpl.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:104:17)
            at HTMLUnknownElement.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:241:34)
            at Object.invokeGuardedCallbackDev (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4213:16)
            at invokeGuardedCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4277:31)
            at beginWork$1 (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:27490:7)
            at performUnitOfWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26599:12)
            at workLoopSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26505:5)
            at renderRootSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26473:7)
            at performConcurrentWorkOnRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25777:74)
            at flushActQueue (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2667:24)
            at act (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2582:11)
            at B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\act-compat.js:47:25
            at renderRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:190:26)
            at render (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:292:10)
            at renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:73:18)
            at Object.renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:298:5)
            at Promise.then.completed (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:298:28)
            at new Promise (<anonymous>)
            at callAsyncCircusFn (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:231:10)
            at _callCircusTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:316:40)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at _runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:252:3)
            at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:126:9)
            at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
            at run (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:71:3)
            at runAndTransformResultsToJestFormat (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
            at jestAdapter (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
            at runTestInternal (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:367:16)
            at runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:444:34)
            at Object.worker (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\testWorker.js:106:12),
        type: 'unhandled exception'
      }

    [0m [90m 71 |[39m
     [90m 72 |[39m   [36mconst[39m renderForm [33m=[39m (initialData [33m=[39m {}) [33m=>[39m {
    [31m[1m>[22m[39m[90m 73 |[39m     [36mreturn[39m render(
     [90m    |[39m                  [31m[1m^[22m[39m
     [90m 74 |[39m       [33m<[39m[33mHealthAssessmentForm[39m
     [90m 75 |[39m         onSubmit[33m=[39m{mockOnSubmit}
     [90m 76 |[39m         onCancel[33m=[39m{mockOnCancel}[0m

      at VirtualConsole.<anonymous> (node_modules/jest-environment-jsdom/build/index.js:63:23)
      at reportException (node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:70:28)
      at innerInvokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
      at invokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
      at HTMLUnknownElementImpl._dispatch (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
      at HTMLUnknownElementImpl.dispatchEvent (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
      at HTMLUnknownElement.dispatchEvent (node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
      at Object.invokeGuardedCallbackDev (node_modules/react-dom/cjs/react-dom.development.js:4213:16)
      at invokeGuardedCallback (node_modules/react-dom/cjs/react-dom.development.js:4277:31)
      at beginWork$1 (node_modules/react-dom/cjs/react-dom.development.js:27490:7)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26599:12)
      at workLoopSync (node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25777:74)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:298:5)

    console.error
      Error: Uncaught [TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')]
          at reportException (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\helpers\runtime-script-errors.js:66:24)
          at innerInvokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:353:9)
          at invokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:286:3)
          at HTMLUnknownElementImpl._dispatch (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:233:9)
          at HTMLUnknownElementImpl.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:104:17)
          at HTMLUnknownElement.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:241:34)
          at Object.invokeGuardedCallbackDev (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4213:16)
          at invokeGuardedCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4277:31)
          at beginWork$1 (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:27490:7)
          at performUnitOfWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26599:12)
          at workLoopSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26505:5)
          at renderRootSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26473:7)
          at recoverFromConcurrentError (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25889:20)
          at performConcurrentWorkOnRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25789:22)
          at flushActQueue (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2667:24)
          at act (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2582:11)
          at B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\act-compat.js:47:25
          at renderRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:190:26)
          at render (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:292:10)
          at renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:73:18)
          at Object.renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:298:5)
          at Promise.then.completed (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:316:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
          at run (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
          at runTestInternal (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:367:16)
          at runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:444:34)
          at Object.worker (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\testWorker.js:106:12) {
        detail: TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')
            at B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:131:56
            at Array.filter (<anonymous>)
            at filter (B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:131:26)
            at renderWithHooks (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:15486:18)
            at mountIndeterminateComponent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:20103:13)
            at beginWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:21626:16)
            at HTMLUnknownElement.callCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4164:14)
            at HTMLUnknownElement.callTheUserObjectsOperation (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventListener.js:26:30)
            at innerInvokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:350:25)
            at invokeEventListeners (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:286:3)
            at HTMLUnknownElementImpl._dispatch (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:233:9)
            at HTMLUnknownElementImpl.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:104:17)
            at HTMLUnknownElement.dispatchEvent (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:241:34)
            at Object.invokeGuardedCallbackDev (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4213:16)
            at invokeGuardedCallback (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:4277:31)
            at beginWork$1 (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:27490:7)
            at performUnitOfWork (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26599:12)
            at workLoopSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26505:5)
            at renderRootSync (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:26473:7)
            at recoverFromConcurrentError (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25889:20)
            at performConcurrentWorkOnRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react-dom\cjs\react-dom.development.js:25789:22)
            at flushActQueue (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2667:24)
            at act (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\react\cjs\react.development.js:2582:11)
            at B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\act-compat.js:47:25
            at renderRoot (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:190:26)
            at render (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\@testing-library\react\dist\pure.js:292:10)
            at renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:73:18)
            at Object.renderForm (B:\Dev\Claude Code\dms-v3-bmad-archon\tests\unit\components\HealthAssessmentForm.test.tsx:298:5)
            at Promise.then.completed (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:298:28)
            at new Promise (<anonymous>)
            at callAsyncCircusFn (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\utils.js:231:10)
            at _callCircusTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:316:40)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at _runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:252:3)
            at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:126:9)
            at _runTestsForDescribeBlock (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:121:9)
            at run (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\run.js:71:3)
            at runAndTransformResultsToJestFormat (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
            at jestAdapter (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
            at runTestInternal (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:367:16)
            at runTest (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\runTest.js:444:34)
            at Object.worker (B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\jest-runner\build\testWorker.js:106:12),
        type: 'unhandled exception'
      }

    [0m [90m 71 |[39m
     [90m 72 |[39m   [36mconst[39m renderForm [33m=[39m (initialData [33m=[39m {}) [33m=>[39m {
    [31m[1m>[22m[39m[90m 73 |[39m     [36mreturn[39m render(
     [90m    |[39m                  [31m[1m^[22m[39m
     [90m 74 |[39m       [33m<[39m[33mHealthAssessmentForm[39m
     [90m 75 |[39m         onSubmit[33m=[39m{mockOnSubmit}
     [90m 76 |[39m         onCancel[33m=[39m{mockOnCancel}[0m

      at VirtualConsole.<anonymous> (node_modules/jest-environment-jsdom/build/index.js:63:23)
      at reportException (node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:70:28)
      at innerInvokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
      at invokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
      at HTMLUnknownElementImpl._dispatch (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
      at HTMLUnknownElementImpl.dispatchEvent (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
      at HTMLUnknownElement.dispatchEvent (node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
      at Object.invokeGuardedCallbackDev (node_modules/react-dom/cjs/react-dom.development.js:4213:16)
      at invokeGuardedCallback (node_modules/react-dom/cjs/react-dom.development.js:4277:31)
      at beginWork$1 (node_modules/react-dom/cjs/react-dom.development.js:27490:7)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26599:12)
      at workLoopSync (node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at recoverFromConcurrentError (node_modules/react-dom/cjs/react-dom.development.js:25889:20)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25789:22)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:298:5)

    console.error
      The above error occurred in the <HealthAssessmentForm> component:
      
          at entityId (B:\Dev\Claude Code\dms-v3-bmad-archon\src\components\forms\assessment\HealthAssessmentForm.tsx:90:3)
      
      Consider adding an error boundary to your tree to customize error handling behavior.
      Visit https://reactjs.org/link/error-boundaries to learn more about error boundaries.

    [0m [90m 71 |[39m
     [90m 72 |[39m   [36mconst[39m renderForm [33m=[39m (initialData [33m=[39m {}) [33m=>[39m {
    [31m[1m>[22m[39m[90m 73 |[39m     [36mreturn[39m render(
     [90m    |[39m                  [31m[1m^[22m[39m
     [90m 74 |[39m       [33m<[39m[33mHealthAssessmentForm[39m
     [90m 75 |[39m         onSubmit[33m=[39m{mockOnSubmit}
     [90m 76 |[39m         onCancel[33m=[39m{mockOnCancel}[0m

      at logCapturedError (node_modules/react-dom/cjs/react-dom.development.js:18704:23)
      at update.callback (node_modules/react-dom/cjs/react-dom.development.js:18737:5)
      at callCallback (node_modules/react-dom/cjs/react-dom.development.js:15036:12)
      at commitUpdateQueue (node_modules/react-dom/cjs/react-dom.development.js:15057:9)
      at commitLayoutEffectOnFiber (node_modules/react-dom/cjs/react-dom.development.js:23430:13)
      at commitLayoutMountEffects_complete (node_modules/react-dom/cjs/react-dom.development.js:24727:9)
      at commitLayoutEffects_begin (node_modules/react-dom/cjs/react-dom.development.js:24713:7)
      at commitLayoutEffects (node_modules/react-dom/cjs/react-dom.development.js:24651:3)
      at commitRootImpl (node_modules/react-dom/cjs/react-dom.development.js:26862:5)
      at commitRoot (node_modules/react-dom/cjs/react-dom.development.js:26721:5)
      at finishConcurrentRender (node_modules/react-dom/cjs/react-dom.development.js:25931:9)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25848:7)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:298:5)

  ‚óè HealthAssessmentForm ‚Ä∫ renders all form fields correctly

    TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')

    [0m [90m 129 |[39m   ]
     [90m 130 |[39m
    [31m[1m>[22m[39m[90m 131 |[39m   [36mconst[39m gaps [33m=[39m gapFields[33m.[39mfilter(field [33m=>[39m [33m![39mwatchedValues[field[33m.[39mkey [36mas[39m keyof [33mFormData[39m])
     [90m     |[39m                                                        [31m[1m^[22m[39m
     [90m 132 |[39m   [36mconst[39m gapCount [33m=[39m gaps[33m.[39mlength
     [90m 133 |[39m
     [90m 134 |[39m   [36mconst[39m handleSubmit [33m=[39m [36masync[39m (data[33m:[39m [33mFormData[39m) [33m=>[39m {[0m

      at src/components/forms/assessment/HealthAssessmentForm.tsx:131:56
          at Array.filter (<anonymous>)
      at filter (src/components/forms/assessment/HealthAssessmentForm.tsx:131:26)
      at renderWithHooks (node_modules/react-dom/cjs/react-dom.development.js:15486:18)
      at mountIndeterminateComponent (node_modules/react-dom/cjs/react-dom.development.js:20103:13)
      at beginWork (node_modules/react-dom/cjs/react-dom.development.js:21626:16)
      at beginWork$1 (node_modules/react-dom/cjs/react-dom.development.js:27465:14)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26599:12)
      at workLoopSync (node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at recoverFromConcurrentError (node_modules/react-dom/cjs/react-dom.development.js:25889:20)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25789:22)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:85:5)

  ‚óè HealthAssessmentForm ‚Ä∫ populates form with initial data

    TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')

    [0m [90m 129 |[39m   ]
     [90m 130 |[39m
    [31m[1m>[22m[39m[90m 131 |[39m   [36mconst[39m gaps [33m=[39m gapFields[33m.[39mfilter(field [33m=>[39m [33m![39mwatchedValues[field[33m.[39mkey [36mas[39m keyof [33mFormData[39m])
     [90m     |[39m                                                        [31m[1m^[22m[39m
     [90m 132 |[39m   [36mconst[39m gapCount [33m=[39m gaps[33m.[39mlength
     [90m 133 |[39m
     [90m 134 |[39m   [36mconst[39m handleSubmit [33m=[39m [36masync[39m (data[33m:[39m [33mFormData[39m) [33m=>[39m {[0m

      at src/components/forms/assessment/HealthAssessmentForm.tsx:131:56
          at Array.filter (<anonymous>)
      at filter (src/components/forms/assessment/HealthAssessmentForm.tsx:131:26)
      at renderWithHooks (node_modules/react-dom/cjs/react-dom.development.js:15486:18)
      at mountIndeterminateComponent (node_modules/react-dom/cjs/react-dom.development.js:20103:13)
      at beginWork (node_modules/react-dom/cjs/react-dom.development.js:21626:16)
      at beginWork$1 (node_modules/react-dom/cjs/react-dom.development.js:27465:14)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26599:12)
      at workLoopSync (node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at recoverFromConcurrentError (node_modules/react-dom/cjs/react-dom.development.js:25889:20)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25789:22)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:117:5)

  ‚óè HealthAssessmentForm ‚Ä∫ requires validation for required fields

    TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')

    [0m [90m 129 |[39m   ]
     [90m 130 |[39m
    [31m[1m>[22m[39m[90m 131 |[39m   [36mconst[39m gaps [33m=[39m gapFields[33m.[39mfilter(field [33m=>[39m [33m![39mwatchedValues[field[33m.[39mkey [36mas[39m keyof [33mFormData[39m])
     [90m     |[39m                                                        [31m[1m^[22m[39m
     [90m 132 |[39m   [36mconst[39m gapCount [33m=[39m gaps[33m.[39mlength
     [90m 133 |[39m
     [90m 134 |[39m   [36mconst[39m handleSubmit [33m=[39m [36masync[39m (data[33m:[39m [33mFormData[39m) [33m=>[39m {[0m

      at src/components/forms/assessment/HealthAssessmentForm.tsx:131:56
          at Array.filter (<anonymous>)
      at filter (src/components/forms/assessment/HealthAssessmentForm.tsx:131:26)
      at renderWithHooks (node_modules/react-dom/cjs/react-dom.development.js:15486:18)
      at mountIndeterminateComponent (node_modules/react-dom/cjs/react-dom.development.js:20103:13)
      at beginWork (node_modules/react-dom/cjs/react-dom.development.js:21626:16)
      at beginWork$1 (node_modules/react-dom/cjs/react-dom.development.js:27465:14)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26599:12)
      at workLoopSync (node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at recoverFromConcurrentError (node_modules/react-dom/cjs/react-dom.development.js:25889:20)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25789:22)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:135:5)

  ‚óè HealthAssessmentForm ‚Ä∫ handles checkbox interactions correctly

    TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')

    [0m [90m 129 |[39m   ]
     [90m 130 |[39m
    [31m[1m>[22m[39m[90m 131 |[39m   [36mconst[39m gaps [33m=[39m gapFields[33m.[39mfilter(field [33m=>[39m [33m![39mwatchedValues[field[33m.[39mkey [36mas[39m keyof [33mFormData[39m])
     [90m     |[39m                                                        [31m[1m^[22m[39m
     [90m 132 |[39m   [36mconst[39m gapCount [33m=[39m gaps[33m.[39mlength
     [90m 133 |[39m
     [90m 134 |[39m   [36mconst[39m handleSubmit [33m=[39m [36masync[39m (data[33m:[39m [33mFormData[39m) [33m=>[39m {[0m

      at src/components/forms/assessment/HealthAssessmentForm.tsx:131:56
          at Array.filter (<anonymous>)
      at filter (src/components/forms/assessment/HealthAssessmentForm.tsx:131:26)
      at renderWithHooks (node_modules/react-dom/cjs/react-dom.development.js:15486:18)
      at mountIndeterminateComponent (node_modules/react-dom/cjs/react-dom.development.js:20103:13)
      at beginWork (node_modules/react-dom/cjs/react-dom.development.js:21626:16)
      at beginWork$1 (node_modules/react-dom/cjs/react-dom.development.js:27465:14)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26599:12)
      at workLoopSync (node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at recoverFromConcurrentError (node_modules/react-dom/cjs/react-dom.development.js:25889:20)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25789:22)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:154:5)

  ‚óè HealthAssessmentForm ‚Ä∫ handles health issues selection correctly

    TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')

    [0m [90m 129 |[39m   ]
     [90m 130 |[39m
    [31m[1m>[22m[39m[90m 131 |[39m   [36mconst[39m gaps [33m=[39m gapFields[33m.[39mfilter(field [33m=>[39m [33m![39mwatchedValues[field[33m.[39mkey [36mas[39m keyof [33mFormData[39m])
     [90m     |[39m                                                        [31m[1m^[22m[39m
     [90m 132 |[39m   [36mconst[39m gapCount [33m=[39m gaps[33m.[39mlength
     [90m 133 |[39m
     [90m 134 |[39m   [36mconst[39m handleSubmit [33m=[39m [36masync[39m (data[33m:[39m [33mFormData[39m) [33m=>[39m {[0m

      at src/components/forms/assessment/HealthAssessmentForm.tsx:131:56
          at Array.filter (<anonymous>)
      at filter (src/components/forms/assessment/HealthAssessmentForm.tsx:131:26)
      at renderWithHooks (node_modules/react-dom/cjs/react-dom.development.js:15486:18)
      at mountIndeterminateComponent (node_modules/react-dom/cjs/react-dom.development.js:20103:13)
      at beginWork (node_modules/react-dom/cjs/react-dom.development.js:21626:16)
      at beginWork$1 (node_modules/react-dom/cjs/react-dom.development.js:27465:14)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26599:12)
      at workLoopSync (node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at recoverFromConcurrentError (node_modules/react-dom/cjs/react-dom.development.js:25889:20)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25789:22)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:172:5)

  ‚óè HealthAssessmentForm ‚Ä∫ handles GPS location capture

    TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')

    [0m [90m 129 |[39m   ]
     [90m 130 |[39m
    [31m[1m>[22m[39m[90m 131 |[39m   [36mconst[39m gaps [33m=[39m gapFields[33m.[39mfilter(field [33m=>[39m [33m![39mwatchedValues[field[33m.[39mkey [36mas[39m keyof [33mFormData[39m])
     [90m     |[39m                                                        [31m[1m^[22m[39m
     [90m 132 |[39m   [36mconst[39m gapCount [33m=[39m gaps[33m.[39mlength
     [90m 133 |[39m
     [90m 134 |[39m   [36mconst[39m handleSubmit [33m=[39m [36masync[39m (data[33m:[39m [33mFormData[39m) [33m=>[39m {[0m

      at src/components/forms/assessment/HealthAssessmentForm.tsx:131:56
          at Array.filter (<anonymous>)
      at filter (src/components/forms/assessment/HealthAssessmentForm.tsx:131:26)
      at renderWithHooks (node_modules/react-dom/cjs/react-dom.development.js:15486:18)
      at mountIndeterminateComponent (node_modules/react-dom/cjs/react-dom.development.js:20103:13)
      at beginWork (node_modules/react-dom/cjs/react-dom.development.js:21626:16)
      at beginWork$1 (node_modules/react-dom/cjs/react-dom.development.js:27465:14)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26599:12)
      at workLoopSync (node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at recoverFromConcurrentError (node_modules/react-dom/cjs/react-dom.development.js:25889:20)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25789:22)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:191:5)

  ‚óè HealthAssessmentForm ‚Ä∫ handles media attachment changes

    TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')

    [0m [90m 129 |[39m   ]
     [90m 130 |[39m
    [31m[1m>[22m[39m[90m 131 |[39m   [36mconst[39m gaps [33m=[39m gapFields[33m.[39mfilter(field [33m=>[39m [33m![39mwatchedValues[field[33m.[39mkey [36mas[39m keyof [33mFormData[39m])
     [90m     |[39m                                                        [31m[1m^[22m[39m
     [90m 132 |[39m   [36mconst[39m gapCount [33m=[39m gaps[33m.[39mlength
     [90m 133 |[39m
     [90m 134 |[39m   [36mconst[39m handleSubmit [33m=[39m [36masync[39m (data[33m:[39m [33mFormData[39m) [33m=>[39m {[0m

      at src/components/forms/assessment/HealthAssessmentForm.tsx:131:56
          at Array.filter (<anonymous>)
      at filter (src/components/forms/assessment/HealthAssessmentForm.tsx:131:26)
      at renderWithHooks (node_modules/react-dom/cjs/react-dom.development.js:15486:18)
      at mountIndeterminateComponent (node_modules/react-dom/cjs/react-dom.development.js:20103:13)
      at beginWork (node_modules/react-dom/cjs/react-dom.development.js:21626:16)
      at beginWork$1 (node_modules/react-dom/cjs/react-dom.development.js:27465:14)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26599:12)
      at workLoopSync (node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at recoverFromConcurrentError (node_modules/react-dom/cjs/react-dom.development.js:25889:20)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25789:22)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:203:5)

  ‚óè HealthAssessmentForm ‚Ä∫ submits form with valid data

    TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')

    [0m [90m 129 |[39m   ]
     [90m 130 |[39m
    [31m[1m>[22m[39m[90m 131 |[39m   [36mconst[39m gaps [33m=[39m gapFields[33m.[39mfilter(field [33m=>[39m [33m![39mwatchedValues[field[33m.[39mkey [36mas[39m keyof [33mFormData[39m])
     [90m     |[39m                                                        [31m[1m^[22m[39m
     [90m 132 |[39m   [36mconst[39m gapCount [33m=[39m gaps[33m.[39mlength
     [90m 133 |[39m
     [90m 134 |[39m   [36mconst[39m handleSubmit [33m=[39m [36masync[39m (data[33m:[39m [33mFormData[39m) [33m=>[39m {[0m

      at src/components/forms/assessment/HealthAssessmentForm.tsx:131:56
          at Array.filter (<anonymous>)
      at filter (src/components/forms/assessment/HealthAssessmentForm.tsx:131:26)
      at renderWithHooks (node_modules/react-dom/cjs/react-dom.development.js:15486:18)
      at mountIndeterminateComponent (node_modules/react-dom/cjs/react-dom.development.js:20103:13)
      at beginWork (node_modules/react-dom/cjs/react-dom.development.js:21626:16)
      at beginWork$1 (node_modules/react-dom/cjs/react-dom.development.js:27465:14)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26599:12)
      at workLoopSync (node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at recoverFromConcurrentError (node_modules/react-dom/cjs/react-dom.development.js:25889:20)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25789:22)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:214:5)

  ‚óè HealthAssessmentForm ‚Ä∫ calls onCancel when cancel button is clicked

    TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')

    [0m [90m 129 |[39m   ]
     [90m 130 |[39m
    [31m[1m>[22m[39m[90m 131 |[39m   [36mconst[39m gaps [33m=[39m gapFields[33m.[39mfilter(field [33m=>[39m [33m![39mwatchedValues[field[33m.[39mkey [36mas[39m keyof [33mFormData[39m])
     [90m     |[39m                                                        [31m[1m^[22m[39m
     [90m 132 |[39m   [36mconst[39m gapCount [33m=[39m gaps[33m.[39mlength
     [90m 133 |[39m
     [90m 134 |[39m   [36mconst[39m handleSubmit [33m=[39m [36masync[39m (data[33m:[39m [33mFormData[39m) [33m=>[39m {[0m

      at src/components/forms/assessment/HealthAssessmentForm.tsx:131:56
          at Array.filter (<anonymous>)
      at filter (src/components/forms/assessment/HealthAssessmentForm.tsx:131:26)
      at renderWithHooks (node_modules/react-dom/cjs/react-dom.development.js:15486:18)
      at mountIndeterminateComponent (node_modules/react-dom/cjs/react-dom.development.js:20103:13)
      at beginWork (node_modules/react-dom/cjs/react-dom.development.js:21626:16)
      at beginWork$1 (node_modules/react-dom/cjs/react-dom.development.js:27465:14)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26599:12)
      at workLoopSync (node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at recoverFromConcurrentError (node_modules/react-dom/cjs/react-dom.development.js:25889:20)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25789:22)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:259:5)

  ‚óè HealthAssessmentForm ‚Ä∫ disables form when isLoading is true

    TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')

    [0m [90m 129 |[39m   ]
     [90m 130 |[39m
    [31m[1m>[22m[39m[90m 131 |[39m   [36mconst[39m gaps [33m=[39m gapFields[33m.[39mfilter(field [33m=>[39m [33m![39mwatchedValues[field[33m.[39mkey [36mas[39m keyof [33mFormData[39m])
     [90m     |[39m                                                        [31m[1m^[22m[39m
     [90m 132 |[39m   [36mconst[39m gapCount [33m=[39m gaps[33m.[39mlength
     [90m 133 |[39m
     [90m 134 |[39m   [36mconst[39m handleSubmit [33m=[39m [36masync[39m (data[33m:[39m [33mFormData[39m) [33m=>[39m {[0m

      at src/components/forms/assessment/HealthAssessmentForm.tsx:131:56
          at Array.filter (<anonymous>)
      at filter (src/components/forms/assessment/HealthAssessmentForm.tsx:131:26)
      at renderWithHooks (node_modules/react-dom/cjs/react-dom.development.js:15486:18)
      at mountIndeterminateComponent (node_modules/react-dom/cjs/react-dom.development.js:20103:13)
      at beginWork (node_modules/react-dom/cjs/react-dom.development.js:21626:16)
      at beginWork$1 (node_modules/react-dom/cjs/react-dom.development.js:27465:14)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26599:12)
      at workLoopSync (node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at recoverFromConcurrentError (node_modules/react-dom/cjs/react-dom.development.js:25889:20)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25789:22)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:270:5)

  ‚óè HealthAssessmentForm ‚Ä∫ displays gap status badges correctly

    TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')

    [0m [90m 129 |[39m   ]
     [90m 130 |[39m
    [31m[1m>[22m[39m[90m 131 |[39m   [36mconst[39m gaps [33m=[39m gapFields[33m.[39mfilter(field [33m=>[39m [33m![39mwatchedValues[field[33m.[39mkey [36mas[39m keyof [33mFormData[39m])
     [90m     |[39m                                                        [31m[1m^[22m[39m
     [90m 132 |[39m   [36mconst[39m gapCount [33m=[39m gaps[33m.[39mlength
     [90m 133 |[39m
     [90m 134 |[39m   [36mconst[39m handleSubmit [33m=[39m [36masync[39m (data[33m:[39m [33mFormData[39m) [33m=>[39m {[0m

      at src/components/forms/assessment/HealthAssessmentForm.tsx:131:56
          at Array.filter (<anonymous>)
      at filter (src/components/forms/assessment/HealthAssessmentForm.tsx:131:26)
      at renderWithHooks (node_modules/react-dom/cjs/react-dom.development.js:15486:18)
      at mountIndeterminateComponent (node_modules/react-dom/cjs/react-dom.development.js:20103:13)
      at beginWork (node_modules/react-dom/cjs/react-dom.development.js:21626:16)
      at beginWork$1 (node_modules/react-dom/cjs/react-dom.development.js:27465:14)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26599:12)
      at workLoopSync (node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at recoverFromConcurrentError (node_modules/react-dom/cjs/react-dom.development.js:25889:20)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25789:22)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:289:5)

  ‚óè HealthAssessmentForm ‚Ä∫ shows gap analysis indicators for boolean fields

    TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')

    [0m [90m 129 |[39m   ]
     [90m 130 |[39m
    [31m[1m>[22m[39m[90m 131 |[39m   [36mconst[39m gaps [33m=[39m gapFields[33m.[39mfilter(field [33m=>[39m [33m![39mwatchedValues[field[33m.[39mkey [36mas[39m keyof [33mFormData[39m])
     [90m     |[39m                                                        [31m[1m^[22m[39m
     [90m 132 |[39m   [36mconst[39m gapCount [33m=[39m gaps[33m.[39mlength
     [90m 133 |[39m
     [90m 134 |[39m   [36mconst[39m handleSubmit [33m=[39m [36masync[39m (data[33m:[39m [33mFormData[39m) [33m=>[39m {[0m

      at src/components/forms/assessment/HealthAssessmentForm.tsx:131:56
          at Array.filter (<anonymous>)
      at filter (src/components/forms/assessment/HealthAssessmentForm.tsx:131:26)
      at renderWithHooks (node_modules/react-dom/cjs/react-dom.development.js:15486:18)
      at mountIndeterminateComponent (node_modules/react-dom/cjs/react-dom.development.js:20103:13)
      at beginWork (node_modules/react-dom/cjs/react-dom.development.js:21626:16)
      at beginWork$1 (node_modules/react-dom/cjs/react-dom.development.js:27465:14)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26599:12)
      at workLoopSync (node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at recoverFromConcurrentError (node_modules/react-dom/cjs/react-dom.development.js:25889:20)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25789:22)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:298:5)

FAIL tests/unit/components/crisis/ConflictLog.test.tsx
  ‚óè ConflictLog Component ‚Ä∫ should show loading state

    TestingLibraryElementError: Found multiple elements with the role "generic"

    Here are the matching elements:

    Ignored nodes: comments, script, style
    [36m<div>[39m
      [36m<div[39m
        [33mclass[39m=[32m"bg-white rounded-lg border border-gray-200 p-6 "[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"animate-pulse"[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"h-4 bg-gray-200 rounded w-1/4 mb-4"[39m
          [36m/>[39m
          [36m<div[39m
            [33mclass[39m=[32m"space-y-3"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"h-12 bg-gray-200 rounded"[39m
            [36m/>[39m
            [36m<div[39m
              [33mclass[39m=[32m"h-12 bg-gray-200 rounded"[39m
            [36m/>[39m
            [36m<div[39m
              [33mclass[39m=[32m"h-12 bg-gray-200 rounded"[39m
            [36m/>[39m
          [36m</div>[39m
        [36m</div>[39m
      [36m</div>[39m
    [36m</div>[39m

    Ignored nodes: comments, script, style
    [36m<div[39m
      [33mclass[39m=[32m"bg-white rounded-lg border border-gray-200 p-6 "[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"animate-pulse"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"h-4 bg-gray-200 rounded w-1/4 mb-4"[39m
        [36m/>[39m
        [36m<div[39m
          [33mclass[39m=[32m"space-y-3"[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"h-12 bg-gray-200 rounded"[39m
          [36m/>[39m
          [36m<div[39m
            [33mclass[39m=[32m"h-12 bg-gray-200 rounded"[39m
          [36m/>[39m
          [36m<div[39m
            [33mclass[39m=[32m"h-12 bg-gray-200 rounded"[39m
          [36m/>[39m
        [36m</div>[39m
      [36m</div>[39m
    [36m</div>[39m

    Ignored nodes: comments, script, style
    [36m<div[39m
      [33mclass[39m=[32m"animate-pulse"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"h-4 bg-gray-200 rounded w-1/4 mb-4"[39m
      [36m/>[39m
      [36m<div[39m
        [33mclass[39m=[32m"space-y-3"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"h-12 bg-gray-200 rounded"[39m
        [36m/>[39m
        [36m<div[39m
          [33mclass[39m=[32m"h-12 bg-gray-200 rounded"[39m
        [36m/>[39m
        [36m<div[39m
          [33mclass[39m=[32m"h-12 bg-gray-200 rounded"[39m
        [36m/>[39m
      [36m</div>[39m
    [36m</div>[39m

    Ignored nodes: comments, script, style
    [36m<div[39m
      [33mclass[39m=[32m"h-4 bg-gray-200 rounded w-1/4 mb-4"[39m
    [36m/>[39m

    Ignored nodes: comments, script, style
    [36m<div[39m
      [33mclass[39m=[32m"space-y-3"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"h-12 bg-gray-200 rounded"[39m
      [36m/>[39m
      [36m<div[39m
        [33mclass[39m=[32m"h-12 bg-gray-200 rounded"[39m
      [36m/>[39m
      [36m<div[39m
        [33mclass[39m=[32m"h-12 bg-gray-200 rounded"[39m
      [36m/>[39m
    [36m</div>[39m

    Ignored nodes: comments, script, style
    [36m<div[39m
      [33mclass[39m=[32m"h-12 bg-gray-200 rounded"[39m
    [36m/>[39m

    Ignored nodes: comments, script, style
    [36m<div[39m
      [33mclass[39m=[32m"h-12 bg-gray-200 rounded"[39m
    [36m/>[39m

    Ignored nodes: comments, script, style
    [36m<div[39m
      [33mclass[39m=[32m"h-12 bg-gray-200 rounded"[39m
    [36m/>[39m

    (If this is intentional, then use the `*AllBy*` variant of the query (like `queryAllByText`, `getAllByText`, or `findAllByText`)).

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<div[39m
          [33mclass[39m=[32m"bg-white rounded-lg border border-gray-200 p-6 "[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"animate-pulse"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"h-4 bg-gray-200 rounded w-1/4 mb-4"[39m
            [36m/>[39m
            [36m<div[39m
              [33mclass[39m=[32m"space-y-3"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"h-12 bg-gray-200 rounded"[39m
              [36m/>[39m
              [36m<div[39m
                [33mclass[39m=[32m"h-12 bg-gray-200 rounded"[39m
              [36m/>[39m
              [36m<div[39m
                [33mclass[39m=[32m"h-12 bg-gray-200 rounded"[39m
              [36m/>[39m
            [36m</div>[39m
          [36m</div>[39m
        [36m</div>[39m
      [36m</div>[39m
    [36m</body>[39m

    [0m [90m 117 |[39m     render([33m<[39m[33mConflictLog[39m [33m/[39m[33m>[39m)[33m;[39m
     [90m 118 |[39m
    [31m[1m>[22m[39m[90m 119 |[39m     expect(screen[33m.[39mgetByRole([32m'generic'[39m))[33m.[39mtoHaveClass([32m'animate-pulse'[39m)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 120 |[39m   })[33m;[39m
     [90m 121 |[39m
     [90m 122 |[39m   it([32m'should show error state'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.getElementError (node_modules/@testing-library/dom/dist/config.js:37:19)
      at getElementError (node_modules/@testing-library/dom/dist/query-helpers.js:20:35)
      at getMultipleElementsFoundError (node_modules/@testing-library/dom/dist/query-helpers.js:23:10)
      at node_modules/@testing-library/dom/dist/query-helpers.js:55:13
      at node_modules/@testing-library/dom/dist/query-helpers.js:95:19
      at Object.getByRole (tests/unit/components/crisis/ConflictLog.test.tsx:119:19)

  ‚óè ConflictLog Component ‚Ä∫ should expand and collapse conflict groups

    Found multiple elements with the text: Resolved

    Here are the matching elements:

    Ignored nodes: comments, script, style
    [36m<option[39m
      [33mvalue[39m=[32m"true"[39m
    [36m>[39m
      [0mResolved[0m
    [36m</option>[39m

    Ignored nodes: comments, script, style
    [36m<span[39m
      [33mclass[39m=[32m"text-xs text-green-700 font-medium"[39m
    [36m>[39m
      [0mResolved[0m
    [36m</span>[39m

    (If this is intentional, then use the `*AllBy*` variant of the query (like `queryAllByText`, `getAllByText`, or `findAllByText`)).

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<div[39m
          [33mclass[39m=[32m"bg-white rounded-lg border border-gray-200 "[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"px-6 py-4 border-b border-gray-200"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"flex items-center justify-between"[39m
            [36m>[39m
              [36m<div>[39m
                [36m<h3[39m
                  [33mclass[39m=[32m"text-lg font-semibold text-gray-900"[39m
                [36m>[39m
                  [0mSync Conflicts[0m
                [36m</h3>[39m
                [36m<p[39m
                  [33mclass[39m=[32m"text-sm text-gray-600"[39m
                [36m>[39m
                  [0m2[0m
                  [0m total ‚Ä¢ [0m
                  [0m1[0m
                  [0m unresolved[0m
                [36m</p>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mclass[39m=[32m"flex items-center gap-2"[39m
              [36m>[39m
                [36m<button[39m
                  [33mclass[39m=[32m"p-2 text-gray-500 hover:text-gray-700 disabled:opacity-50"[39m
                  [33mtitle[39m=[32m"Refresh"[39m
                [36m>[39m
                  [36m<svg[39m
                    [33mclass[39m=[32m"w-4 h-4 "[39m
                    [33mfill[39m=[32m"currentColor"[39m
                    [33mviewBox[39m=[32m"0 0 24 24"[39m
                  [36m>[39m
                    [36m<path[39m
                      [33md[39m=[32m"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"[39m
                    [36m/>[39m
                  [36m</svg>[39m
                [36m</button>[39m
                [36m<button[39m
                  [33mclass[39m=[32m"px-3 py-2 text-sm bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors"[39m
                [36m>[39m
                  [0mExport CSV[0m
                [36m</button>[39m
              [36m</div>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mclass[39m=[32m"flex gap-3 mt-4"[39m
            [36m>[39m
              [36m<select[39m
                [33mclass[39m=[32m"px-3 py-2 border border-gray-300 rounded-md text-sm"[39m
              [36m>[39m
                [36m<option[39m
                  [33mvalue[39m=[32m""[39m
                [36m>[39m
                  [0mAll Types[0m
                [36m</option>[39m
                [36m<option[39m
                  [33mvalue[39m=[32m"assessment"[39m
                [36m>[39m
                  [0mAssessment[0m
                [36m</option>[39m
                [36m<option[39m
                  [33mvalue[39m=[32m"response"[39m
                [36m>[39m
                  [0mResponse[0m
                [36m</option>[39m
                [36m<option[39m
                  [33mvalue[39m=[32m"entity"[39m
                [36m>[39m
                  [0mEntity[0m
                [36m</option>[39m
              [36m</select>[39m
              [36m<select[39m
                [33mclass[39m=[32m"px-3 py-2 border border-gray-300 rounded-md text-sm"[39m
              [36m>[39m
                [36m<option[39m
                  [33mvalue[39m=[32m""[39m
                [36m>[39m
                  [0mAll Status[0m
                [36m</option>[39m
                [36m<option[39m
                  [33mvalue[39m=[32m"true"[39m
                [36m>[39m
                  [0mResolved[0m
                [36m</option>[39m
                [36m<option[39m
                  [33mvalue[39m=[32m"false"[39m
                [36m>[39m
                  [0mUnresolved[0m
                [36m</option>[39m
              [36m</select>[39m
            [36m</div>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"p-6"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"space-y-4"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"border border-gray-200 rounded-lg"[39m
              [36m>[39m
                [36m<button[39m
                  [33mclass[39m=[32m"w-full px-4 py-3 flex items-center justify-between bg-gray-50 hover:bg-gray-100 transition-colors rounded-t-lg"[39m
                [36m>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"flex items-center gap-3"[39m
                  [36m>[39m
                    [36m<div[39m
                      [33mclass[39m=[32m"flex items-center gap-2"[39m
                    [36m>[39m
                      [36m<span[39m
                        [33mclass[39m=[32m"font-medium text-gray-900"[39m
                      [36m>[39m
                        [0mRESPONSE entity-2[0m
                      [36m</span>[39m
                      [36m<span[39m
                        [33mclass[39m=[32m"text-sm text-gray-500"[39m
                      [36m>[39m
                        [0m([0m
                        [0mRESPONSE[0m
                        [0m)[0m
                      [36m</span>[39m
                    [36m</div>[39m
                    [36m<div[39m
                      [33mclass[39m=[32m"flex items-center gap-2"[39m
                    [36m>[39m
                      [36m<span[39m
                        [33mclass[39m=[32m"px-2 py-1 bg-blue-100 text-blue-800 text-xs font-medium rounded-full"[39m
                      [36m>[39m
                        [0m1[0m
                        [0m conflicts[0m
                      [36m</span>[39m
                      [36m<span[39m
                        [33mclass[39m=[32m"px-2 py-1 bg-red-100 text-red-800 text-xs font-medium rounded-full"[39m
                      [36m>[39m
                        [0m1[0m
                        [0m unresolved[0m
                      [36m</span>[39m
                    [36m</div>[39m
                  [36m</div>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"flex items-center gap-2"[39m
                  [36m>[39m
                    [36m<span[39m
                      [33mclass[39m=[32m"text-sm text-gray-500"[39m
                    [36m>[39m
                      [0m308d ago[0m
                    [36m</span>[39m
                    [36m<svg[39m
                      [33mclass[39m=[32m"w-4 h-4 text-gray-400 transition-transform "[39m
                      [33mfill[39m=[32m"currentColor"[39m
                      [33mviewBox[39m=[32m"0 0 24 24"[39m
                    [36m>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M7.41 8.84L12 13.42l4.59-4.58L18 10.25l-6 6-6-6z"[39m
                      [36m/>[39m
                    [36m</svg>[39m
                  [36m</div>[39m
                [36m</button>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mclass[39m=[32m"border border-gray-200 rounded-lg"[39m
              [36m>[39m
                [36m<button[39m
                  [33mclass[39m=[32m"w-full px-4 py-3 flex items-center justify-between bg-gray-50 hover:bg-gray-100 transition-colors rounded-t-lg"[39m
                [36m>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"flex items-center gap-3"[39m
                  [36m>[39m
                    [36m<div[39m
                      [33mclass[39m=[32m"flex items-center gap-2"[39m
                    [36m>[39m
                      [36m<span[39m
                        [33mclass[39m=[32m"font-medium text-gray-900"[39m
                      [36m>[39m
                        [0mASSESSMENT entity-1[0m
                      [36m</span>[39m
                      [36m<span[39m
                        [33mclass[39m=[32m"text-sm text-gray-500"[39m
                      [36m>[39m
                        [0m([0m
                        [0mASSESSMENT[0m
                        [0m)[0m
                      [36m</span>[39m
                    [36m</div>[39m
                    [36m<div[39m
                      [33mclass[39m=[32m"flex items-center gap-2"[39m
                    [36m>[39m
                      [36m<span[39m
                        [33mclass[39m=[32m"px-2 py-1 bg-blue-100 text-blue-800 text-xs font-medium rounded-full"[39m
                      [36m>[39m
                        [0m1[0m
                        [0m conflicts[0m
                      [36m</span>[39m
                    [36m</div>[39m
                  [36m</div>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"flex items-center gap-2"[39m
                  [36m>[39m
                    [36m<span[39m
                      [33mclass[39m=[32m"text-sm text-gray-500"[39m
                    [36m>[39m
                      [0m308d ago[0m
                    [36m</span>[39m
                    [36m<svg[39m
                      [33mclass[39m=[32m"w-4 h-4 text-gray-400 transition-transform rotate-180"[39m
                      [33mfill[39m=[32m"currentColor"[39m
                      [33mviewBox[39m=[32m"0 0 24 24"[39m
                    [36m>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M7.41 8.84L12 13.42l4.59-4.58L18 10.25l-6 6-6-6z"[39m
                      [36m/>[39m
                    [36m</svg>[39m
                  [36m</div>[39m
                [36m</button>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"divide-y divide-gray-200"[39m
                [36m>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"px-4 py-3"[39m
                  [36m>[39m
                    [36m<div[39m
                      [33mclass[39m=[32m"flex items-start justify-between"[39m
                    [36m>[39m
                      [36m<div[39m
                        [33mclass[39m=[32m"flex-1"[39m
                      [36m>[39m
                        [36m<div[39m
                          [33mclass[39m=[32m"flex items-center gap-3 mb-2"[39m
                        [36m>[39m
                          [36m<div[39m
                            [33mclass[39m=[32m"flex items-center gap-1"[39m
                          [36m>[39m
                            [36m<div[39m
                              [33mclass[39m=[32m"w-3 h-3 bg-green-500 rounded-full"[39m
                            [36m/>[39m
                            [36m<span[39m
                              [33mclass[39m=[32m"text-xs text-green-700 font-medium"[39m
                            [36m>[39m
                              [0mResolved[0m
                            [36m</span>[39m
                          [36m</div>[39m
                          [36m<span[39m
                            [33mclass[39m=[32m"px-2 py-1 text-xs font-medium rounded-full bg-blue-100 text-blue-800"[39m
                          [36m>[39m
                            [0mLAST-WRITE_WINS[0m
                          [36m</span>[39m
                          [36m<span[39m
                            [33mclass[39m=[32m"text-sm text-gray-500"[39m
                          [36m>[39m
                            [0mv[0m
                            [0m1[0m
                            [0m ‚Üî v[0m
                            [0m2[0m
                          [36m</span>[39m
                        [36m</div>[39m
                        [36m<div[39m
                          [33mclass[39m=[32m"text-sm text-gray-600"[39m
                        [36m>[39m
                          [36m<p>[39m
                            [0mConflict ID: [0m
                            [36m<span[39m
                              [33mclass[39m=[32m"font-mono"[39m
                            [36m>[39m
                              [0mconflict[0m
                            [36m</span>[39m
                          [36m</p>[39m
                          [36m<p>[39m
                            [0mDetected: [0m
                            [0m308d ago[0m
                          [36m</p>[39m
                          [36m<p>[39m
                            [0mResolved: [0m
                            [0m308d ago[0m
                          [36m</p>[39m
                        [36m</div>[39m
                      [36m</div>[39m
                      [36m<div[39m
                        [33mclass[39m=[32m"text-right"[39m
                      [36m>[39m
                        [36m<div[39m
                          [33mclass[39m=[32m"text-sm text-gray-900 font-medium mb-1"[39m
                        [36m>[39m
                          [0m01/01/2025[0m
                        [36m</div>[39m
                        [36m<div[39m
                          [33mclass[39m=[32m"text-xs text-gray-500"[39m
                        [36m>[39m
                          [0m11:00:00[0m
                        [36m</div>[39m
                      [36m</div>[39m
                    [36m</div>[39m
                  [36m</div>[39m
                [36m</div>[39m
              [36m</div>[39m
            [36m</div>[39m
          [36m</div>[39m
        [36m</div>[39m
      [36m</div>[39m
    [36m</body>[39m

    [0m [90m 158 |[39m
     [90m 159 |[39m     [90m// Check if conflict details are shown[39m
    [31m[1m>[22m[39m[90m 160 |[39m     [36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                  [31m[1m^[22m[39m
     [90m 161 |[39m       expect(screen[33m.[39mgetByText([32m'Resolved'[39m))[33m.[39mtoBeInTheDocument()[33m;[39m
     [90m 162 |[39m       expect(screen[33m.[39mgetByText([32m'LAST-WRITE-WINS'[39m))[33m.[39mtoBeInTheDocument()[33m;[39m
     [90m 163 |[39m     })[33m;[39m[0m

      at waitForWrapper (node_modules/@testing-library/dom/dist/wait-for.js:163:27)
      at Object.<anonymous> (tests/unit/components/crisis/ConflictLog.test.tsx:160:18)

  ‚óè ConflictLog Component ‚Ä∫ should display conflict status indicators correctly

    Found multiple elements with the text: Resolved

    Here are the matching elements:

    Ignored nodes: comments, script, style
    [36m<option[39m
      [33mvalue[39m=[32m"true"[39m
    [36m>[39m
      [0mResolved[0m
    [36m</option>[39m

    Ignored nodes: comments, script, style
    [36m<span[39m
      [33mclass[39m=[32m"text-xs text-green-700 font-medium"[39m
    [36m>[39m
      [0mResolved[0m
    [36m</span>[39m

    (If this is intentional, then use the `*AllBy*` variant of the query (like `queryAllByText`, `getAllByText`, or `findAllByText`)).

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<div[39m
          [33mclass[39m=[32m"bg-white rounded-lg border border-gray-200 "[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"px-6 py-4 border-b border-gray-200"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"flex items-center justify-between"[39m
            [36m>[39m
              [36m<div>[39m
                [36m<h3[39m
                  [33mclass[39m=[32m"text-lg font-semibold text-gray-900"[39m
                [36m>[39m
                  [0mSync Conflicts[0m
                [36m</h3>[39m
                [36m<p[39m
                  [33mclass[39m=[32m"text-sm text-gray-600"[39m
                [36m>[39m
                  [0m2[0m
                  [0m total ‚Ä¢ [0m
                  [0m1[0m
                  [0m unresolved[0m
                [36m</p>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mclass[39m=[32m"flex items-center gap-2"[39m
              [36m>[39m
                [36m<button[39m
                  [33mclass[39m=[32m"p-2 text-gray-500 hover:text-gray-700 disabled:opacity-50"[39m
                  [33mtitle[39m=[32m"Refresh"[39m
                [36m>[39m
                  [36m<svg[39m
                    [33mclass[39m=[32m"w-4 h-4 "[39m
                    [33mfill[39m=[32m"currentColor"[39m
                    [33mviewBox[39m=[32m"0 0 24 24"[39m
                  [36m>[39m
                    [36m<path[39m
                      [33md[39m=[32m"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"[39m
                    [36m/>[39m
                  [36m</svg>[39m
                [36m</button>[39m
                [36m<button[39m
                  [33mclass[39m=[32m"px-3 py-2 text-sm bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors"[39m
                [36m>[39m
                  [0mExport CSV[0m
                [36m</button>[39m
              [36m</div>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mclass[39m=[32m"flex gap-3 mt-4"[39m
            [36m>[39m
              [36m<select[39m
                [33mclass[39m=[32m"px-3 py-2 border border-gray-300 rounded-md text-sm"[39m
              [36m>[39m
                [36m<option[39m
                  [33mvalue[39m=[32m""[39m
                [36m>[39m
                  [0mAll Types[0m
                [36m</option>[39m
                [36m<option[39m
                  [33mvalue[39m=[32m"assessment"[39m
                [36m>[39m
                  [0mAssessment[0m
                [36m</option>[39m
                [36m<option[39m
                  [33mvalue[39m=[32m"response"[39m
                [36m>[39m
                  [0mResponse[0m
                [36m</option>[39m
                [36m<option[39m
                  [33mvalue[39m=[32m"entity"[39m
                [36m>[39m
                  [0mEntity[0m
                [36m</option>[39m
              [36m</select>[39m
              [36m<select[39m
                [33mclass[39m=[32m"px-3 py-2 border border-gray-300 rounded-md text-sm"[39m
              [36m>[39m
                [36m<option[39m
                  [33mvalue[39m=[32m""[39m
                [36m>[39m
                  [0mAll Status[0m
                [36m</option>[39m
                [36m<option[39m
                  [33mvalue[39m=[32m"true"[39m
                [36m>[39m
                  [0mResolved[0m
                [36m</option>[39m
                [36m<option[39m
                  [33mvalue[39m=[32m"false"[39m
                [36m>[39m
                  [0mUnresolved[0m
                [36m</option>[39m
              [36m</select>[39m
            [36m</div>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"p-6"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"space-y-4"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"border border-gray-200 rounded-lg"[39m
              [36m>[39m
                [36m<button[39m
                  [33mclass[39m=[32m"w-full px-4 py-3 flex items-center justify-between bg-gray-50 hover:bg-gray-100 transition-colors rounded-t-lg"[39m
                [36m>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"flex items-center gap-3"[39m
                  [36m>[39m
                    [36m<div[39m
                      [33mclass[39m=[32m"flex items-center gap-2"[39m
                    [36m>[39m
                      [36m<span[39m
                        [33mclass[39m=[32m"font-medium text-gray-900"[39m
                      [36m>[39m
                        [0mRESPONSE entity-2[0m
                      [36m</span>[39m
                      [36m<span[39m
                        [33mclass[39m=[32m"text-sm text-gray-500"[39m
                      [36m>[39m
                        [0m([0m
                        [0mRESPONSE[0m
                        [0m)[0m
                      [36m</span>[39m
                    [36m</div>[39m
                    [36m<div[39m
                      [33mclass[39m=[32m"flex items-center gap-2"[39m
                    [36m>[39m
                      [36m<span[39m
                        [33mclass[39m=[32m"px-2 py-1 bg-blue-100 text-blue-800 text-xs font-medium rounded-full"[39m
                      [36m>[39m
                        [0m1[0m
                        [0m conflicts[0m
                      [36m</span>[39m
                      [36m<span[39m
                        [33mclass[39m=[32m"px-2 py-1 bg-red-100 text-red-800 text-xs font-medium rounded-full"[39m
                      [36m>[39m
                        [0m1[0m
                        [0m unresolved[0m
                      [36m</span>[39m
                    [36m</div>[39m
                  [36m</div>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"flex items-center gap-2"[39m
                  [36m>[39m
                    [36m<span[39m
                      [33mclass[39m=[32m"text-sm text-gray-500"[39m
                    [36m>[39m
                      [0m308d ago[0m
                    [36m</span>[39m
                    [36m<svg[39m
                      [33mclass[39m=[32m"w-4 h-4 text-gray-400 transition-transform "[39m
                      [33mfill[39m=[32m"currentColor"[39m
                      [33mviewBox[39m=[32m"0 0 24 24"[39m
                    [36m>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M7.41 8.84L12 13.42l4.59-4.58L18 10.25l-6 6-6-6z"[39m
                      [36m/>[39m
                    [36m</svg>[39m
                  [36m</div>[39m
                [36m</button>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mclass[39m=[32m"border border-gray-200 rounded-lg"[39m
              [36m>[39m
                [36m<button[39m
                  [33mclass[39m=[32m"w-full px-4 py-3 flex items-center justify-between bg-gray-50 hover:bg-gray-100 transition-colors rounded-t-lg"[39m
                [36m>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"flex items-center gap-3"[39m
                  [36m>[39m
                    [36m<div[39m
                      [33mclass[39m=[32m"flex items-center gap-2"[39m
                    [36m>[39m
                      [36m<span[39m
                        [33mclass[39m=[32m"font-medium text-gray-900"[39m
                      [36m>[39m
                        [0mASSESSMENT entity-1[0m
                      [36m</span>[39m
                      [36m<span[39m
                        [33mclass[39m=[32m"text-sm text-gray-500"[39m
                      [36m>[39m
                        [0m([0m
                        [0mASSESSMENT[0m
                        [0m)[0m
                      [36m</span>[39m
                    [36m</div>[39m
                    [36m<div[39m
                      [33mclass[39m=[32m"flex items-center gap-2"[39m
                    [36m>[39m
                      [36m<span[39m
                        [33mclass[39m=[32m"px-2 py-1 bg-blue-100 text-blue-800 text-xs font-medium rounded-full"[39m
                      [36m>[39m
                        [0m1[0m
                        [0m conflicts[0m
                      [36m</span>[39m
                    [36m</div>[39m
                  [36m</div>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"flex items-center gap-2"[39m
                  [36m>[39m
                    [36m<span[39m
                      [33mclass[39m=[32m"text-sm text-gray-500"[39m
                    [36m>[39m
                      [0m308d ago[0m
                    [36m</span>[39m
                    [36m<svg[39m
                      [33mclass[39m=[32m"w-4 h-4 text-gray-400 transition-transform rotate-180"[39m
                      [33mfill[39m=[32m"currentColor"[39m
                      [33mviewBox[39m=[32m"0 0 24 24"[39m
                    [36m>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M7.41 8.84L12 13.42l4.59-4.58L18 10.25l-6 6-6-6z"[39m
                      [36m/>[39m
                    [36m</svg>[39m
                  [36m</div>[39m
                [36m</button>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"divide-y divide-gray-200"[39m
                [36m>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"px-4 py-3"[39m
                  [36m>[39m
                    [36m<div[39m
                      [33mclass[39m=[32m"flex items-start justify-between"[39m
                    [36m>[39m
                      [36m<div[39m
                        [33mclass[39m=[32m"flex-1"[39m
                      [36m>[39m
                        [36m<div[39m
                          [33mclass[39m=[32m"flex items-center gap-3 mb-2"[39m
                        [36m>[39m
                          [36m<div[39m
                            [33mclass[39m=[32m"flex items-center gap-1"[39m
                          [36m>[39m
                            [36m<div[39m
                              [33mclass[39m=[32m"w-3 h-3 bg-green-500 rounded-full"[39m
                            [36m/>[39m
                            [36m<span[39m
                              [33mclass[39m=[32m"text-xs text-green-700 font-medium"[39m
                            [36m>[39m
                              [0mResolved[0m
                            [36m</span>[39m
                          [36m</div>[39m
                          [36m<span[39m
                            [33mclass[39m=[32m"px-2 py-1 text-xs font-medium rounded-full bg-blue-100 text-blue-800"[39m
                          [36m>[39m
                            [0mLAST-WRITE_WINS[0m
                          [36m</span>[39m
                          [36m<span[39m
                            [33mclass[39m=[32m"text-sm text-gray-500"[39m
                          [36m>[39m
                            [0mv[0m
                            [0m1[0m
                            [0m ‚Üî v[0m
                            [0m2[0m
                          [36m</span>[39m
                        [36m</div>[39m
                        [36m<div[39m
                          [33mclass[39m=[32m"text-sm text-gray-600"[39m
                        [36m>[39m
                          [36m<p>[39m
                            [0mConflict ID: [0m
                            [36m<span[39m
                              [33mclass[39m=[32m"font-mono"[39m
                            [36m>[39m
                              [0mconflict[0m
                            [36m</span>[39m
                          [36m</p>[39m
                          [36m<p>[39m
                            [0mDetected: [0m
                            [0m308d ago[0m
                          [36m</p>[39m
                          [36m<p>[39m
                            [0mResolved: [0m
                            [0m308d ago[0m
                          [36m</p>[39m
                        [36m</div>[39m
                      [36m</div>[39m
                      [36m<div[39m
                        [33mclass[39m=[32m"text-right"[39m
                      [36m>[39m
                        [36m<div[39m
                          [33mclass[39m=[32m"text-sm text-gray-900 font-medium mb-1"[39m
                        [36m>[39m
                          [0m01/01/2025[0m
                        [36m</div>[39m
                        [36m<div[39m
                          [33mclass[39m=[32m"text-xs text-gray-500"[39m
                        [36m>[39m
                          [0m11:00:00[0m
                        [36m</div>[39m
                      [36m</div>[39m
                    [36m</div>[39m
                  [36m</div>[39m
                [36m</div>[39m
              [36m</div>[39m
            [36m</div>[39m
          [36m</div>[39m
        [36m</div>[39m
      [36m</div>[39m
    [36m</body>[39m

    [0m [90m 274 |[39m     fireEvent[33m.[39mclick(groupHeader)[33m;[39m
     [90m 275 |[39m
    [31m[1m>[22m[39m[90m 276 |[39m     [36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                  [31m[1m^[22m[39m
     [90m 277 |[39m       [90m// Check for resolved status[39m
     [90m 278 |[39m       expect(screen[33m.[39mgetByText([32m'Resolved'[39m))[33m.[39mtoBeInTheDocument()[33m;[39m
     [90m 279 |[39m       [0m

      at waitForWrapper (node_modules/@testing-library/dom/dist/wait-for.js:163:27)
      at Object.<anonymous> (tests/unit/components/crisis/ConflictLog.test.tsx:276:18)

FAIL tests/unit/components/GPSCapture.test.tsx (5.04 s)
  ‚óè GPSCapture ‚Ä∫ should capture GPS coordinates successfully

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: 9.072264, 7.491302
    Received: 11.506, 13.098

    Number of calls: 1

    Ignored nodes: comments, script, style
    [36m<html>[39m
      [36m<head />[39m
      [36m<body>[39m
        [36m<div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"rounded-lg border bg-card text-card-foreground shadow-sm w-full"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"flex flex-col space-y-1.5 p-6"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"text-2xl font-semibold leading-none tracking-tight flex items-center gap-2"[39m
              [36m>[39m
                [36m<svg[39m
                  [33maria-hidden[39m=[32m"true"[39m
                  [33mclass[39m=[32m"lucide lucide-map-pin h-5 w-5"[39m
                  [33mfill[39m=[32m"none"[39m
                  [33mheight[39m=[32m"24"[39m
                  [33mstroke[39m=[32m"currentColor"[39m
                  [33mstroke-linecap[39m=[32m"round"[39m
                  [33mstroke-linejoin[39m=[32m"round"[39m
                  [33mstroke-width[39m=[32m"2"[39m
                  [33mviewBox[39m=[32m"0 0 24 24"[39m
                  [33mwidth[39m=[32m"24"[39m
                  [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
                [36m>[39m
                  [36m<path[39m
                    [33md[39m=[32m"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0"[39m
                  [36m/>[39m
                  [36m<circle[39m
                    [33mcx[39m=[32m"12"[39m
                    [33mcy[39m=[32m"10"[39m
                    [33mr[39m=[32m"3"[39m
                  [36m/>[39m
                [36m</svg>[39m
                [0mGPS Location Capture[0m
              [36m</div>[39m
              [36m<div[39m
                [33mclass[39m=[32m"text-sm text-muted-foreground"[39m
              [36m>[39m
                [0mCapture GPS coordinates automatically or enter them manually[0m
              [36m</div>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mclass[39m=[32m"p-6 pt-0 space-y-4"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground bg-background text-foreground"[39m
                [33mrole[39m=[32m"alert"[39m
              [36m>[39m
                [36m<svg[39m
                  [33maria-hidden[39m=[32m"true"[39m
                  [33mclass[39m=[32m"lucide lucide-map-pin h-4 w-4"[39m
                  [33mfill[39m=[32m"none"[39m
                  [33mheight[39m=[32m"24"[39m
                  [33mstroke[39m=[32m"currentColor"[39m
                  [33mstroke-linecap[39m=[32m"round"[39m
                  [33mstroke-linejoin[39m=[32m"round"[39m
                  [33mstroke-width[39m=[32m"2"[39m
                  [33mviewBox[39m=[32m"0 0 24 24"[39m
                  [33mwidth[39m=[32m"24"[39m
                  [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
                [36m>[39m
                  [36m<path[39m
                    [33md[39m=[32m"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0"[39m
                  [36m/>[39m
                  [36m<circle[39m
                    [33mcx[39m=[32m"12"[39m
                    [33mcy[39m=[32m"10"[39m
                    [33mr[39m=[32m"3"[39m
                  [36m/>[39m
                [36m</svg>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"text-sm [&_p]:leading-relaxed"[39m
                [36m>[39m
                  [36m<strong>[39m
                    [0mCurrent Location:[0m
                  [36m</strong>[39m
                  [36m<br />[39m
                  [0mLatitude: [0m
                  [0m11.506000[0m
                  [36m<br />[39m
                  [0mLongitude: [0m
                  [0m13.098000[0m
                [36m</div>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mclass[39m=[32m"flex gap-2"[39m
              [36m>[39m
                [36m<button[39m
                  [33mclass[39m=[32m"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 py-2 flex-1"[39m
                [36m>[39m
                  [36m<svg[39m
                    [33maria-hidden[39m=[32m"true"[39m
                    [33mclass[39m=[32m"lucide lucide-navigation h-4 w-4 mr-2"[39m
                    [33mfill[39m=[32m"none"[39m
                    [33mheight[39m=[32m"24"[39m
                    [33mstroke[39m=[32m"currentColor"[39m
                    [33mstroke-linecap[39m=[32m"round"[39m
                    [33mstroke-linejoin[39m=[32m"round"[39m
                    [33mstroke-width[39m=[32m"2"[39m
                    [33mviewBox[39m=[32m"0 0 24 24"[39m
                    [33mwidth[39m=[32m"24"[39m
                    [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
                  [36m>[39m
                    [36m<polygon[39m
                      [33mpoints[39m=[32m"3 11 22 2 13 21 11 13 3 11"[39m
                    [36m/>[39m
                  [36m</svg>[39m
                  [0mCapture GPS[0m
                [36m</button>[39m
                [36m<button[39m
                  [33mclass[39m=[32m"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2"[39m
                [36m>[39m
                  [0mManual Entry[0m
                [36m</button>[39m
              [36m</div>[39m
            [36m</div>[39m
          [36m</div>[39m
        [36m</div>[39m
      [36m</body>[39m
    [36m</html>[39m

    [0m [90m 81 |[39m
     [90m 82 |[39m     [36mawait[39m waitFor(() [33m=>[39m {
    [31m[1m>[22m[39m[90m 83 |[39m       expect(mockOnLocationCapture)[33m.[39mtoHaveBeenCalledWith([35m9.072264[39m[33m,[39m [35m7.491302[39m)
     [90m    |[39m                                     [31m[1m^[22m[39m
     [90m 84 |[39m     })
     [90m 85 |[39m
     [90m 86 |[39m     expect(screen[33m.[39mgetByText([35m/current location/i[39m))[33m.[39mtoBeInTheDocument()[0m

      at toHaveBeenCalledWith (tests/unit/components/GPSCapture.test.tsx:83:37)
      at runWithExpensiveErrorDiagnosticsDisabled (node_modules/@testing-library/dom/dist/config.js:47:12)
      at checkCallback (node_modules/@testing-library/dom/dist/wait-for.js:124:77)
      at checkRealTimersCallback (node_modules/@testing-library/dom/dist/wait-for.js:118:16)
      at Timeout.task [as _onTimeout] (node_modules/jsdom/lib/jsdom/browser/Window.js:520:19)

  ‚óè GPSCapture ‚Ä∫ should handle GPS capture errors

    Unable to find an element with the text: /location access denied by user/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<div[39m
          [33mclass[39m=[32m"rounded-lg border bg-card text-card-foreground shadow-sm w-full"[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"flex flex-col space-y-1.5 p-6"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"text-2xl font-semibold leading-none tracking-tight flex items-center gap-2"[39m
            [36m>[39m
              [36m<svg[39m
                [33maria-hidden[39m=[32m"true"[39m
                [33mclass[39m=[32m"lucide lucide-map-pin h-5 w-5"[39m
                [33mfill[39m=[32m"none"[39m
                [33mheight[39m=[32m"24"[39m
                [33mstroke[39m=[32m"currentColor"[39m
                [33mstroke-linecap[39m=[32m"round"[39m
                [33mstroke-linejoin[39m=[32m"round"[39m
                [33mstroke-width[39m=[32m"2"[39m
                [33mviewBox[39m=[32m"0 0 24 24"[39m
                [33mwidth[39m=[32m"24"[39m
                [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
              [36m>[39m
                [36m<path[39m
                  [33md[39m=[32m"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0"[39m
                [36m/>[39m
                [36m<circle[39m
                  [33mcx[39m=[32m"12"[39m
                  [33mcy[39m=[32m"10"[39m
                  [33mr[39m=[32m"3"[39m
                [36m/>[39m
              [36m</svg>[39m
              [0mGPS Location Capture[0m
            [36m</div>[39m
            [36m<div[39m
              [33mclass[39m=[32m"text-sm text-muted-foreground"[39m
            [36m>[39m
              [0mCapture GPS coordinates automatically or enter them manually[0m
            [36m</div>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"p-6 pt-0 space-y-4"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground bg-background text-foreground"[39m
              [33mrole[39m=[32m"alert"[39m
            [36m>[39m
              [36m<svg[39m
                [33maria-hidden[39m=[32m"true"[39m
                [33mclass[39m=[32m"lucide lucide-map-pin h-4 w-4"[39m
                [33mfill[39m=[32m"none"[39m
                [33mheight[39m=[32m"24"[39m
                [33mstroke[39m=[32m"currentColor"[39m
                [33mstroke-linecap[39m=[32m"round"[39m
                [33mstroke-linejoin[39m=[32m"round"[39m
                [33mstroke-width[39m=[32m"2"[39m
                [33mviewBox[39m=[32m"0 0 24 24"[39m
                [33mwidth[39m=[32m"24"[39m
                [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
              [36m>[39m
                [36m<path[39m
                  [33md[39m=[32m"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0"[39m
                [36m/>[39m
                [36m<circle[39m
                  [33mcx[39m=[32m"12"[39m
                  [33mcy[39m=[32m"10"[39m
                  [33mr[39m=[32m"3"[39m
                [36m/>[39m
              [36m</svg>[39m
              [36m<div[39m
                [33mclass[39m=[32m"text-sm [&_p]:leading-relaxed"[39m
              [36m>[39m
                [36m<strong>[39m
                  [0mCurrent Location:[0m
                [36m</strong>[39m
                [36m<br />[39m
                [0mLatitude: [0m
                [0m11.506000[0m
                [36m<br />[39m
                [0mLongitude: [0m
                [0m13.098000[0m
              [36m</div>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mclass[39m=[32m"flex gap-2"[39m
            [36m>[39m
              [36m<button[39m
                [33mclass[39m=[32m"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 py-2 flex-1"[39m
              [36m>[39m
                [36m<svg[39m
                  [33maria-hidden[39m=[32m"true"[39m
                  [33mclass[39m=[32m"lucide lucide-navigation h-4 w-4 mr-2"[39m
                  [33mfill[39m=[32m"none"[39m
                  [33mheight[39m=[32m"24"[39m
                  [33mstroke[39m=[32m"currentColor"[39m
                  [33mstroke-linecap[39m=[32m"round"[39m
                  [33mstroke-linejoin[39m=[32m"round"[39m
                  [33mstroke-width[39m=[32m"2"[39m
                  [33mviewBox[39m=[32m"0 0 24 24"[39m
                  [33mwidth[39m=[32m"24"[39m
                  [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
                [36m>[39m
                  [36m<polygon[39m
                    [33mpoints[39m=[32m"3 11 22 2 13 21 11 13 3 11"[39m
                  [36m/>[39m
                [36m</svg>[39m
                [0mCapture GPS[0m
              [36m</button>[39m
              [36m<button[39m
                [33mclass[39m=[32m"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2"[39m
              [36m>[39m
                [0mManual Entry[0m
              [36m</button>[39m
            [36m</div>[39m
          [36m</div>[39m
        [36m</div>[39m
      [36m</div>[39m
    [36m</body>[39m

    [0m [90m 104 |[39m     fireEvent[33m.[39mclick(captureButton)
     [90m 105 |[39m
    [31m[1m>[22m[39m[90m 106 |[39m     [36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                  [31m[1m^[22m[39m
     [90m 107 |[39m       expect(screen[33m.[39mgetByText([35m/location access denied by user/i[39m))[33m.[39mtoBeInTheDocument()
     [90m 108 |[39m     })
     [90m 109 |[39m[0m

      at waitForWrapper (node_modules/@testing-library/dom/dist/wait-for.js:163:27)
      at Object.<anonymous> (tests/unit/components/GPSCapture.test.tsx:106:18)

  ‚óè GPSCapture ‚Ä∫ should validate manual coordinate input

    TestingLibraryElementError: Unable to find an element with the text: /please enter valid latitude and longitude values/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<div[39m
          [33mclass[39m=[32m"rounded-lg border bg-card text-card-foreground shadow-sm w-full"[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"flex flex-col space-y-1.5 p-6"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"text-2xl font-semibold leading-none tracking-tight flex items-center gap-2"[39m
            [36m>[39m
              [36m<svg[39m
                [33maria-hidden[39m=[32m"true"[39m
                [33mclass[39m=[32m"lucide lucide-map-pin h-5 w-5"[39m
                [33mfill[39m=[32m"none"[39m
                [33mheight[39m=[32m"24"[39m
                [33mstroke[39m=[32m"currentColor"[39m
                [33mstroke-linecap[39m=[32m"round"[39m
                [33mstroke-linejoin[39m=[32m"round"[39m
                [33mstroke-width[39m=[32m"2"[39m
                [33mviewBox[39m=[32m"0 0 24 24"[39m
                [33mwidth[39m=[32m"24"[39m
                [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
              [36m>[39m
                [36m<path[39m
                  [33md[39m=[32m"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0"[39m
                [36m/>[39m
                [36m<circle[39m
                  [33mcx[39m=[32m"12"[39m
                  [33mcy[39m=[32m"10"[39m
                  [33mr[39m=[32m"3"[39m
                [36m/>[39m
              [36m</svg>[39m
              [0mGPS Location Capture[0m
            [36m</div>[39m
            [36m<div[39m
              [33mclass[39m=[32m"text-sm text-muted-foreground"[39m
            [36m>[39m
              [0mCapture GPS coordinates automatically or enter them manually[0m
            [36m</div>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"p-6 pt-0 space-y-4"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"flex gap-2"[39m
            [36m>[39m
              [36m<button[39m
                [33mclass[39m=[32m"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 py-2 flex-1"[39m
              [36m>[39m
                [36m<svg[39m
                  [33maria-hidden[39m=[32m"true"[39m
                  [33mclass[39m=[32m"lucide lucide-navigation h-4 w-4 mr-2"[39m
                  [33mfill[39m=[32m"none"[39m
                  [33mheight[39m=[32m"24"[39m
                  [33mstroke[39m=[32m"currentColor"[39m
                  [33mstroke-linecap[39m=[32m"round"[39m
                  [33mstroke-linejoin[39m=[32m"round"[39m
                  [33mstroke-width[39m=[32m"2"[39m
                  [33mviewBox[39m=[32m"0 0 24 24"[39m
                  [33mwidth[39m=[32m"24"[39m
                  [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
                [36m>[39m
                  [36m<polygon[39m
                    [33mpoints[39m=[32m"3 11 22 2 13 21 11 13 3 11"[39m
                  [36m/>[39m
                [36m</svg>[39m
                [0mCapture GPS[0m
              [36m</button>[39m
              [36m<button[39m
                [33mclass[39m=[32m"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2"[39m
              [36m>[39m
                [0mManual Entry[0m
              [36m</button>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mclass[39m=[32m"space-y-4 border-t pt-4"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"grid grid-cols-2 gap-4"[39m
              [36m>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"space-y-2"[39m
                [36m>[39m
                  [36m<label[39m
                    [33mclass[39m=[32m"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"[39m
                    [33mfor[39m=[32m"manual-lat"[39m
                  [36m>[39m
                    [0mLatitude[0m
                  [36m</label>[39m
                  [36m<input[39m
                    [33mclass[39m=[32m"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm"[39m
                    [33mid[39m=[32m"manual-lat"[39m
                    [33mplaceholder[39m=[32m"e.g., 9.072264"[39m
                    [33mstep[39m=[32m"any"[39m
                    [33mtype[39m=[32m"number"[39m
                    [33mvalue[39m=[32m""[39m
                  [36m/>[39m
                [36m</div>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"space-y-2"[39m
                [36m>[39m
                  [36m<label[39m
                    [33mclass[39m=[32m"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"[39m
                    [33mfor[39m=[32m"manual-lng"[39m
                  [36m>[39m
                    [0mLongitude[0m
                  [36m</label>[39m
                  [36m<input[39m
                    [33mclass[39m=[32m"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm"[39m
                    [33mid[39m=[32m"manual-lng"[39m
                    [33mplaceholder[39m=[32m"e.g., 7.491302"[39m
                    [33mstep[39m=[32m"any"[39m
                    [33mtype[39m=[32m"number"[39m
                    [33mvalue[39m=[32m"7.491302"[39m
                  [36m/>[39m
                [36m</div>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mclass[39m=[32m"flex gap-2"[39m
              [36m>[39m
                [36m<button[39m
                  [33mclass[39m=[32m"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 py-2 flex-1"[39m
                  [33mdisabled[39m=[32m""[39m
                [36m>[39m
                  [0mSet Location[0m
                [36m</button>[39m
              [36m</div>[39m
            [36m</div>[39m
          [36m</div>[39m
        [36m</div>[39m
      [36m</div>[39m
    [36m</body>[39m

    [0m [90m 161 |[39m     fireEvent[33m.[39mclick(setLocationButton)
     [90m 162 |[39m
    [31m[1m>[22m[39m[90m 163 |[39m     expect(screen[33m.[39mgetByText([35m/please enter valid latitude and longitude values/i[39m))[33m.[39mtoBeInTheDocument()
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 164 |[39m     expect(mockOnLocationCapture)[33m.[39mnot[33m.[39mtoHaveBeenCalled()
     [90m 165 |[39m   })
     [90m 166 |[39m[0m

      at Object.getElementError (node_modules/@testing-library/dom/dist/config.js:37:19)
      at node_modules/@testing-library/dom/dist/query-helpers.js:76:38
      at node_modules/@testing-library/dom/dist/query-helpers.js:52:17
      at node_modules/@testing-library/dom/dist/query-helpers.js:95:19
      at Object.getByText (tests/unit/components/GPSCapture.test.tsx:163:19)

  ‚óè GPSCapture ‚Ä∫ should show error when geolocation is not supported

    Unable to find an element with the text: /geolocation is not supported by this browser/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<div[39m
          [33mclass[39m=[32m"rounded-lg border bg-card text-card-foreground shadow-sm w-full"[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"flex flex-col space-y-1.5 p-6"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"text-2xl font-semibold leading-none tracking-tight flex items-center gap-2"[39m
            [36m>[39m
              [36m<svg[39m
                [33maria-hidden[39m=[32m"true"[39m
                [33mclass[39m=[32m"lucide lucide-map-pin h-5 w-5"[39m
                [33mfill[39m=[32m"none"[39m
                [33mheight[39m=[32m"24"[39m
                [33mstroke[39m=[32m"currentColor"[39m
                [33mstroke-linecap[39m=[32m"round"[39m
                [33mstroke-linejoin[39m=[32m"round"[39m
                [33mstroke-width[39m=[32m"2"[39m
                [33mviewBox[39m=[32m"0 0 24 24"[39m
                [33mwidth[39m=[32m"24"[39m
                [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
              [36m>[39m
                [36m<path[39m
                  [33md[39m=[32m"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0"[39m
                [36m/>[39m
                [36m<circle[39m
                  [33mcx[39m=[32m"12"[39m
                  [33mcy[39m=[32m"10"[39m
                  [33mr[39m=[32m"3"[39m
                [36m/>[39m
              [36m</svg>[39m
              [0mGPS Location Capture[0m
            [36m</div>[39m
            [36m<div[39m
              [33mclass[39m=[32m"text-sm text-muted-foreground"[39m
            [36m>[39m
              [0mCapture GPS coordinates automatically or enter them manually[0m
            [36m</div>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"p-6 pt-0 space-y-4"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground bg-background text-foreground"[39m
              [33mrole[39m=[32m"alert"[39m
            [36m>[39m
              [36m<svg[39m
                [33maria-hidden[39m=[32m"true"[39m
                [33mclass[39m=[32m"lucide lucide-map-pin h-4 w-4"[39m
                [33mfill[39m=[32m"none"[39m
                [33mheight[39m=[32m"24"[39m
                [33mstroke[39m=[32m"currentColor"[39m
                [33mstroke-linecap[39m=[32m"round"[39m
                [33mstroke-linejoin[39m=[32m"round"[39m
                [33mstroke-width[39m=[32m"2"[39m
                [33mviewBox[39m=[32m"0 0 24 24"[39m
                [33mwidth[39m=[32m"24"[39m
                [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
              [36m>[39m
                [36m<path[39m
                  [33md[39m=[32m"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0"[39m
                [36m/>[39m
                [36m<circle[39m
                  [33mcx[39m=[32m"12"[39m
                  [33mcy[39m=[32m"10"[39m
                  [33mr[39m=[32m"3"[39m
                [36m/>[39m
              [36m</svg>[39m
              [36m<div[39m
                [33mclass[39m=[32m"text-sm [&_p]:leading-relaxed"[39m
              [36m>[39m
                [36m<strong>[39m
                  [0mCurrent Location:[0m
                [36m</strong>[39m
                [36m<br />[39m
                [0mLatitude: [0m
                [0m11.506000[0m
                [36m<br />[39m
                [0mLongitude: [0m
                [0m13.098000[0m
              [36m</div>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mclass[39m=[32m"flex gap-2"[39m
            [36m>[39m
              [36m<button[39m
                [33mclass[39m=[32m"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 py-2 flex-1"[39m
              [36m>[39m
                [36m<svg[39m
                  [33maria-hidden[39m=[32m"true"[39m
                  [33mclass[39m=[32m"lucide lucide-navigation h-4 w-4 mr-2"[39m
                  [33mfill[39m=[32m"none"[39m
                  [33mheight[39m=[32m"24"[39m
                  [33mstroke[39m=[32m"currentColor"[39m
                  [33mstroke-linecap[39m=[32m"round"[39m
                  [33mstroke-linejoin[39m=[32m"round"[39m
                  [33mstroke-width[39m=[32m"2"[39m
                  [33mviewBox[39m=[32m"0 0 24 24"[39m
                  [33mwidth[39m=[32m"24"[39m
                  [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
                [36m>[39m
                  [36m<polygon[39m
                    [33mpoints[39m=[32m"3 11 22 2 13 21 11 13 3 11"[39m
                  [36m/>[39m
                [36m</svg>[39m
                [0mCapture GPS[0m
              [36m</button>[39m
              [36m<button[39m
                [33mclass[39m=[32m"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2"[39m
              [36m>[39m
                [0mManual Entry[0m
              [36m</button>[39m
            [36m</div>[39m
          [36m</div>[39m
        [36m</div>[39m
      [36m</div>[39m
    [36m</body>[39m

    [0m [90m 221 |[39m     fireEvent[33m.[39mclick(captureButton)
     [90m 222 |[39m
    [31m[1m>[22m[39m[90m 223 |[39m     [36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                  [31m[1m^[22m[39m
     [90m 224 |[39m       expect(screen[33m.[39mgetByText([35m/geolocation is not supported by this browser/i[39m))[33m.[39mtoBeInTheDocument()
     [90m 225 |[39m     })
     [90m 226 |[39m   })[0m

      at waitForWrapper (node_modules/@testing-library/dom/dist/wait-for.js:163:27)
      at Object.<anonymous> (tests/unit/components/GPSCapture.test.tsx:223:18)

FAIL tests/unit/components/RoleSwitcher.test.tsx (10 s)
  ‚óè RoleSwitcher Component ‚Ä∫ Component Rendering ‚Ä∫ should render when user is authenticated with multiple roles

    TestingLibraryElementError: Found multiple elements with the text: Assessor

    Here are the matching elements:

    Ignored nodes: comments, script, style
    [36m<span[39m
      [33mclass[39m=[32m"hidden sm:inline"[39m
    [36m>[39m
      [0mAssessor[0m
    [36m</span>[39m

    Ignored nodes: comments, script, style
    [36m<div[39m
      [33mclass[39m=[32m"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-blue-100 text-blue-800 hover:bg-blue-200"[39m
    [36m>[39m
      [0mAssessor[0m
    [36m</div>[39m

    (If this is intentional, then use the `*AllBy*` variant of the query (like `queryAllByText`, `getAllByText`, or `findAllByText`)).

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<button[39m
          [33maria-expanded[39m=[32m"false"[39m
          [33maria-haspopup[39m=[32m"menu"[39m
          [33mclass[39m=[32m"inline-flex items-center justify-center whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9 rounded-md px-3 gap-2 undefined"[39m
          [33mdata-state[39m=[32m"closed"[39m
          [33mid[39m=[32m"radix-:r0:"[39m
          [33mtype[39m=[32m"button"[39m
        [36m>[39m
          [36m<div[39m
            [33mdata-testid[39m=[32m"user-icon"[39m
          [36m/>[39m
          [36m<span[39m
            [33mclass[39m=[32m"hidden sm:inline"[39m
          [36m>[39m
            [0mAssessor[0m
          [36m</span>[39m
          [36m<div[39m
            [33mclass[39m=[32m"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-blue-100 text-blue-800 hover:bg-blue-200"[39m
          [36m>[39m
            [0mAssessor[0m
          [36m</div>[39m
          [36m<div[39m
            [33mdata-testid[39m=[32m"arrow-left-right-icon"[39m
          [36m/>[39m
        [36m</button>[39m
      [36m</div>[39m
    [36m</body>[39m

    [0m [90m 83 |[39m       
     [90m 84 |[39m       expect(screen[33m.[39mgetByTestId([32m'user-icon'[39m))[33m.[39mtoBeInTheDocument()[33m;[39m
    [31m[1m>[22m[39m[90m 85 |[39m       expect(screen[33m.[39mgetByText([32m'Assessor'[39m))[33m.[39mtoBeInTheDocument()[33m;[39m
     [90m    |[39m                     [31m[1m^[22m[39m
     [90m 86 |[39m       expect(screen[33m.[39mgetByTestId([32m'arrow-left-right-icon'[39m))[33m.[39mtoBeInTheDocument()[33m;[39m
     [90m 87 |[39m     })[33m;[39m
     [90m 88 |[39m[0m

      at Object.getElementError (node_modules/@testing-library/dom/dist/config.js:37:19)
      at getElementError (node_modules/@testing-library/dom/dist/query-helpers.js:20:35)
      at getMultipleElementsFoundError (node_modules/@testing-library/dom/dist/query-helpers.js:23:10)
      at node_modules/@testing-library/dom/dist/query-helpers.js:55:13
      at node_modules/@testing-library/dom/dist/query-helpers.js:95:19
      at Object.getByText (tests/unit/components/RoleSwitcher.test.tsx:85:21)

  ‚óè RoleSwitcher Component ‚Ä∫ Component Rendering ‚Ä∫ should display current role correctly

    TestingLibraryElementError: Found multiple elements with the text: Coordinator

    Here are the matching elements:

    Ignored nodes: comments, script, style
    [36m<span[39m
      [33mclass[39m=[32m"hidden sm:inline"[39m
    [36m>[39m
      [0mCoordinator[0m
    [36m</span>[39m

    Ignored nodes: comments, script, style
    [36m<div[39m
      [33mclass[39m=[32m"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-green-100 text-green-800 hover:bg-green-200"[39m
    [36m>[39m
      [0mCoordinator[0m
    [36m</div>[39m

    (If this is intentional, then use the `*AllBy*` variant of the query (like `queryAllByText`, `getAllByText`, or `findAllByText`)).

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<button[39m
          [33maria-expanded[39m=[32m"false"[39m
          [33maria-haspopup[39m=[32m"menu"[39m
          [33mclass[39m=[32m"inline-flex items-center justify-center whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9 rounded-md px-3 gap-2 undefined"[39m
          [33mdata-state[39m=[32m"closed"[39m
          [33mid[39m=[32m"radix-:r2:"[39m
          [33mtype[39m=[32m"button"[39m
        [36m>[39m
          [36m<div[39m
            [33mdata-testid[39m=[32m"user-icon"[39m
          [36m/>[39m
          [36m<span[39m
            [33mclass[39m=[32m"hidden sm:inline"[39m
          [36m>[39m
            [0mCoordinator[0m
          [36m</span>[39m
          [36m<div[39m
            [33mclass[39m=[32m"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-green-100 text-green-800 hover:bg-green-200"[39m
          [36m>[39m
            [0mCoordinator[0m
          [36m</div>[39m
          [36m<div[39m
            [33mdata-testid[39m=[32m"arrow-left-right-icon"[39m
          [36m/>[39m
        [36m</button>[39m
      [36m</div>[39m
    [36m</body>[39m

    [0m [90m  95 |[39m       render([33m<[39m[33mRoleSwitcher[39m [33m/[39m[33m>[39m)[33m;[39m
     [90m  96 |[39m       
    [31m[1m>[22m[39m[90m  97 |[39m       expect(screen[33m.[39mgetByText([32m'Coordinator'[39m))[33m.[39mtoBeInTheDocument()[33m;[39m
     [90m     |[39m                     [31m[1m^[22m[39m
     [90m  98 |[39m     })[33m;[39m
     [90m  99 |[39m   })[33m;[39m
     [90m 100 |[39m[0m

      at Object.getElementError (node_modules/@testing-library/dom/dist/config.js:37:19)
      at getElementError (node_modules/@testing-library/dom/dist/query-helpers.js:20:35)
      at getMultipleElementsFoundError (node_modules/@testing-library/dom/dist/query-helpers.js:23:10)
      at node_modules/@testing-library/dom/dist/query-helpers.js:55:13
      at node_modules/@testing-library/dom/dist/query-helpers.js:95:19
      at Object.getByText (tests/unit/components/RoleSwitcher.test.tsx:97:21)

  ‚óè RoleSwitcher Component ‚Ä∫ Dropdown Menu ‚Ä∫ should show dropdown when clicked

    Unable to find an element with the text: Switch Role. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<button[39m
          [33maria-expanded[39m=[32m"false"[39m
          [33maria-haspopup[39m=[32m"menu"[39m
          [33mclass[39m=[32m"inline-flex items-center justify-center whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9 rounded-md px-3 gap-2 undefined"[39m
          [33mdata-state[39m=[32m"closed"[39m
          [33mid[39m=[32m"radix-:r4:"[39m
          [33mtype[39m=[32m"button"[39m
        [36m>[39m
          [36m<div[39m
            [33mdata-testid[39m=[32m"user-icon"[39m
          [36m/>[39m
          [36m<span[39m
            [33mclass[39m=[32m"hidden sm:inline"[39m
          [36m>[39m
            [0mAssessor[0m
          [36m</span>[39m
          [36m<div[39m
            [33mclass[39m=[32m"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-blue-100 text-blue-800 hover:bg-blue-200"[39m
          [36m>[39m
            [0mAssessor[0m
          [36m</div>[39m
          [36m<div[39m
            [33mdata-testid[39m=[32m"arrow-left-right-icon"[39m
          [36m/>[39m
        [36m</button>[39m
      [36m</div>[39m
    [36m</body>[39m

    [0m [90m 108 |[39m
     [90m 109 |[39m       [90m// Wait for dropdown to appear[39m
    [31m[1m>[22m[39m[90m 110 |[39m       [36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                    [31m[1m^[22m[39m
     [90m 111 |[39m         expect(screen[33m.[39mgetByText([32m'Switch Role'[39m))[33m.[39mtoBeInTheDocument()[33m;[39m
     [90m 112 |[39m       })[33m;[39m
     [90m 113 |[39m[0m

      at waitForWrapper (node_modules/@testing-library/dom/dist/wait-for.js:163:27)
      at Object.<anonymous> (tests/unit/components/RoleSwitcher.test.tsx:110:20)

  ‚óè RoleSwitcher Component ‚Ä∫ Dropdown Menu ‚Ä∫ should show current role as selected

    Unable to find an element by: [data-testid="check-icon"]

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<button[39m
          [33maria-expanded[39m=[32m"false"[39m
          [33maria-haspopup[39m=[32m"menu"[39m
          [33mclass[39m=[32m"inline-flex items-center justify-center whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9 rounded-md px-3 gap-2 undefined"[39m
          [33mdata-state[39m=[32m"closed"[39m
          [33mid[39m=[32m"radix-:r6:"[39m
          [33mtype[39m=[32m"button"[39m
        [36m>[39m
          [36m<div[39m
            [33mdata-testid[39m=[32m"user-icon"[39m
          [36m/>[39m
          [36m<span[39m
            [33mclass[39m=[32m"hidden sm:inline"[39m
          [36m>[39m
            [0mAssessor[0m
          [36m</span>[39m
          [36m<div[39m
            [33mclass[39m=[32m"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-blue-100 text-blue-800 hover:bg-blue-200"[39m
          [36m>[39m
            [0mAssessor[0m
          [36m</div>[39m
          [36m<div[39m
            [33mdata-testid[39m=[32m"arrow-left-right-icon"[39m
          [36m/>[39m
        [36m</button>[39m
      [36m</div>[39m
    [36m</body>[39m

    [0m [90m 123 |[39m       fireEvent[33m.[39mclick(button)[33m;[39m
     [90m 124 |[39m
    [31m[1m>[22m[39m[90m 125 |[39m       [36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                    [31m[1m^[22m[39m
     [90m 126 |[39m         [90m// Current role should have check icon[39m
     [90m 127 |[39m         [36mconst[39m checkIcons [33m=[39m screen[33m.[39mgetAllByTestId([32m'check-icon'[39m)[33m;[39m
     [90m 128 |[39m         expect(checkIcons)[33m.[39mtoHaveLength([35m1[39m)[33m;[39m[0m

      at waitForWrapper (node_modules/@testing-library/dom/dist/wait-for.js:163:27)
      at Object.<anonymous> (tests/unit/components/RoleSwitcher.test.tsx:125:20)

  ‚óè RoleSwitcher Component ‚Ä∫ Role Switching ‚Ä∫ should call switchRole when clicking different role

    Unable to find an element with the text: Coordinator. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<button[39m
          [33maria-expanded[39m=[32m"false"[39m
          [33maria-haspopup[39m=[32m"menu"[39m
          [33mclass[39m=[32m"inline-flex items-center justify-center whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9 rounded-md px-3 gap-2 undefined"[39m
          [33mdata-state[39m=[32m"closed"[39m
          [33mid[39m=[32m"radix-:r8:"[39m
          [33mtype[39m=[32m"button"[39m
        [36m>[39m
          [36m<div[39m
            [33mdata-testid[39m=[32m"user-icon"[39m
          [36m/>[39m
          [36m<span[39m
            [33mclass[39m=[32m"hidden sm:inline"[39m
          [36m>[39m
            [0mAssessor[0m
          [36m</span>[39m
          [36m<div[39m
            [33mclass[39m=[32m"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-blue-100 text-blue-800 hover:bg-blue-200"[39m
          [36m>[39m
            [0mAssessor[0m
          [36m</div>[39m
          [36m<div[39m
            [33mdata-testid[39m=[32m"arrow-left-right-icon"[39m
          [36m/>[39m
        [36m</button>[39m
      [36m</div>[39m
    [36m</body>[39m

    [0m [90m 144 |[39m       fireEvent[33m.[39mclick(button)[33m;[39m
     [90m 145 |[39m
    [31m[1m>[22m[39m[90m 146 |[39m       [36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                    [31m[1m^[22m[39m
     [90m 147 |[39m         [90m// Click on a different role[39m
     [90m 148 |[39m         [36mconst[39m coordinatorOption [33m=[39m screen[33m.[39mgetByText([32m'Coordinator'[39m)[33m;[39m
     [90m 149 |[39m         fireEvent[33m.[39mclick(coordinatorOption)[33m;[39m[0m

      at waitForWrapper (node_modules/@testing-library/dom/dist/wait-for.js:163:27)
      at Object.<anonymous> (tests/unit/components/RoleSwitcher.test.tsx:146:20)

  ‚óè RoleSwitcher Component ‚Ä∫ Role Switching ‚Ä∫ should show unsaved changes warning when applicable

    Unable to find an element with the text: Coordinator. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [0m
            [0m
      [36m<form[39m
        [33mdata-dirty[39m=[32m"true"[39m
      [36m>[39m
        [0m
              [0m
        [36m<input[39m
          [33mdata-initial-value[39m=[32m""[39m
          [33mvalue[39m=[32m"test"[39m
        [36m/>[39m
        [0m
            [0m
      [36m</form>[39m
      [0m
          [0m
      [36m<div>[39m
        [36m<button[39m
          [33maria-expanded[39m=[32m"false"[39m
          [33maria-haspopup[39m=[32m"menu"[39m
          [33mclass[39m=[32m"inline-flex items-center justify-center whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9 rounded-md px-3 gap-2 undefined"[39m
          [33mdata-state[39m=[32m"closed"[39m
          [33mid[39m=[32m"radix-:ra:"[39m
          [33mtype[39m=[32m"button"[39m
        [36m>[39m
          [36m<div[39m
            [33mdata-testid[39m=[32m"user-icon"[39m
          [36m/>[39m
          [36m<span[39m
            [33mclass[39m=[32m"hidden sm:inline"[39m
          [36m>[39m
            [0mAssessor[0m
          [36m</span>[39m
          [36m<div[39m
            [33mclass[39m=[32m"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-blue-100 text-blue-800 hover:bg-blue-200"[39m
          [36m>[39m
            [0mAssessor[0m
          [36m</div>[39m
          [36m<div[39m
            [33mdata-testid[39m=[32m"arrow-left-right-icon"[39m
          [36m/>[39m
        [36m</button>[39m
      [36m</div>[39m
    [36m</body>[39m

    [0m [90m 170 |[39m       fireEvent[33m.[39mclick(button)[33m;[39m
     [90m 171 |[39m
    [31m[1m>[22m[39m[90m 172 |[39m       [36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                    [31m[1m^[22m[39m
     [90m 173 |[39m         [36mconst[39m coordinatorOption [33m=[39m screen[33m.[39mgetByText([32m'Coordinator'[39m)[33m;[39m
     [90m 174 |[39m         fireEvent[33m.[39mclick(coordinatorOption)[33m;[39m
     [90m 175 |[39m       })[33m;[39m[0m

      at waitForWrapper (node_modules/@testing-library/dom/dist/wait-for.js:163:27)
      at Object.<anonymous> (tests/unit/components/RoleSwitcher.test.tsx:172:20)

  ‚óè RoleSwitcher Component ‚Ä∫ Role Switching ‚Ä∫ should redirect to correct dashboard after role switch

    Unable to find an element with the text: Coordinator. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [0m
            [0m
      [36m<form[39m
        [33mdata-dirty[39m=[32m"true"[39m
      [36m>[39m
        [0m
              [0m
        [36m<input[39m
          [33mdata-initial-value[39m=[32m""[39m
          [33mvalue[39m=[32m"test"[39m
        [36m/>[39m
        [0m
            [0m
      [36m</form>[39m
      [0m
          [0m
      [36m<div>[39m
        [36m<button[39m
          [33maria-expanded[39m=[32m"false"[39m
          [33maria-haspopup[39m=[32m"menu"[39m
          [33mclass[39m=[32m"inline-flex items-center justify-center whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9 rounded-md px-3 gap-2 undefined"[39m
          [33mdata-state[39m=[32m"closed"[39m
          [33mid[39m=[32m"radix-:rc:"[39m
          [33mtype[39m=[32m"button"[39m
        [36m>[39m
          [36m<div[39m
            [33mdata-testid[39m=[32m"user-icon"[39m
          [36m/>[39m
          [36m<span[39m
            [33mclass[39m=[32m"hidden sm:inline"[39m
          [36m>[39m
            [0mAssessor[0m
          [36m</span>[39m
          [36m<div[39m
            [33mclass[39m=[32m"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-blue-100 text-blue-800 hover:bg-blue-200"[39m
          [36m>[39m
            [0mAssessor[0m
          [36m</div>[39m
          [36m<div[39m
            [33mdata-testid[39m=[32m"arrow-left-right-icon"[39m
          [36m/>[39m
        [36m</button>[39m
      [36m</div>[39m
    [36m</body>[39m

    [0m [90m 196 |[39m       fireEvent[33m.[39mclick(button)[33m;[39m
     [90m 197 |[39m
    [31m[1m>[22m[39m[90m 198 |[39m       [36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                    [31m[1m^[22m[39m
     [90m 199 |[39m         [36mconst[39m coordinatorOption [33m=[39m screen[33m.[39mgetByText([32m'Coordinator'[39m)[33m;[39m
     [90m 200 |[39m         fireEvent[33m.[39mclick(coordinatorOption)[33m;[39m
     [90m 201 |[39m       })[33m;[39m[0m

      at waitForWrapper (node_modules/@testing-library/dom/dist/wait-for.js:163:27)
      at Object.<anonymous> (tests/unit/components/RoleSwitcher.test.tsx:198:20)

  ‚óè RoleSwitcher Component ‚Ä∫ Unsaved Changes Warning ‚Ä∫ should show warning dialog when there are unsaved forms

    Unable to find an element with the text: Coordinator. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [0m
            [0m
      [36m<form[39m
        [33mdata-dirty[39m=[32m"true"[39m
      [36m>[39m
        [0m
              [0m
        [36m<input[39m
          [33mtype[39m=[32m"text"[39m
          [33mvalue[39m=[32m"test"[39m
        [36m/>[39m
        [0m
            [0m
      [36m</form>[39m
      [0m
          [0m
      [36m<div>[39m
        [36m<button[39m
          [33maria-expanded[39m=[32m"false"[39m
          [33maria-haspopup[39m=[32m"menu"[39m
          [33mclass[39m=[32m"inline-flex items-center justify-center whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9 rounded-md px-3 gap-2 undefined"[39m
          [33mdata-state[39m=[32m"closed"[39m
          [33mid[39m=[32m"radix-:re:"[39m
          [33mtype[39m=[32m"button"[39m
        [36m>[39m
          [36m<div[39m
            [33mdata-testid[39m=[32m"user-icon"[39m
          [36m/>[39m
          [36m<span[39m
            [33mclass[39m=[32m"hidden sm:inline"[39m
          [36m>[39m
            [0mAssessor[0m
          [36m</span>[39m
          [36m<div[39m
            [33mclass[39m=[32m"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-blue-100 text-blue-800 hover:bg-blue-200"[39m
          [36m>[39m
            [0mAssessor[0m
          [36m</div>[39m
          [36m<div[39m
            [33mdata-testid[39m=[32m"arrow-left-right-icon"[39m
          [36m/>[39m
        [36m</button>[39m
      [36m</div>[39m
    [36m</body>[39m

    [0m [90m 220 |[39m       fireEvent[33m.[39mclick(button)[33m;[39m
     [90m 221 |[39m
    [31m[1m>[22m[39m[90m 222 |[39m       [36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                    [31m[1m^[22m[39m
     [90m 223 |[39m         [36mconst[39m coordinatorOption [33m=[39m screen[33m.[39mgetByText([32m'Coordinator'[39m)[33m;[39m
     [90m 224 |[39m         fireEvent[33m.[39mclick(coordinatorOption)[33m;[39m
     [90m 225 |[39m       })[33m;[39m[0m

      at waitForWrapper (node_modules/@testing-library/dom/dist/wait-for.js:163:27)
      at Object.<anonymous> (tests/unit/components/RoleSwitcher.test.tsx:222:20)

  ‚óè RoleSwitcher Component ‚Ä∫ Unsaved Changes Warning ‚Ä∫ should close warning when cancel is clicked

    Unable to find an element with the text: Coordinator. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [0m
            [0m
      [36m<form[39m
        [33mdata-dirty[39m=[32m"true"[39m
      [36m>[39m
        [0m
              [0m
        [36m<input[39m
          [33mtype[39m=[32m"text"[39m
          [33mvalue[39m=[32m"test"[39m
        [36m/>[39m
        [0m
            [0m
      [36m</form>[39m
      [0m
          [0m
      [36m<div>[39m
        [36m<button[39m
          [33maria-expanded[39m=[32m"false"[39m
          [33maria-haspopup[39m=[32m"menu"[39m
          [33mclass[39m=[32m"inline-flex items-center justify-center whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9 rounded-md px-3 gap-2 undefined"[39m
          [33mdata-state[39m=[32m"closed"[39m
          [33mid[39m=[32m"radix-:rg:"[39m
          [33mtype[39m=[32m"button"[39m
        [36m>[39m
          [36m<div[39m
            [33mdata-testid[39m=[32m"user-icon"[39m
          [36m/>[39m
          [36m<span[39m
            [33mclass[39m=[32m"hidden sm:inline"[39m
          [36m>[39m
            [0mAssessor[0m
          [36m</span>[39m
          [36m<div[39m
            [33mclass[39m=[32m"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-blue-100 text-blue-800 hover:bg-blue-200"[39m
          [36m>[39m
            [0mAssessor[0m
          [36m</div>[39m
          [36m<div[39m
            [33mdata-testid[39m=[32m"arrow-left-right-icon"[39m
          [36m/>[39m
        [36m</button>[39m
      [36m</div>[39m
    [36m</body>[39m

    [0m [90m 244 |[39m       fireEvent[33m.[39mclick(button)[33m;[39m
     [90m 245 |[39m
    [31m[1m>[22m[39m[90m 246 |[39m       [36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                    [31m[1m^[22m[39m
     [90m 247 |[39m         [36mconst[39m coordinatorOption [33m=[39m screen[33m.[39mgetByText([32m'Coordinator'[39m)[33m;[39m
     [90m 248 |[39m         fireEvent[33m.[39mclick(coordinatorOption)[33m;[39m
     [90m 249 |[39m       })[33m;[39m[0m

      at waitForWrapper (node_modules/@testing-library/dom/dist/wait-for.js:163:27)
      at Object.<anonymous> (tests/unit/components/RoleSwitcher.test.tsx:246:20)

  ‚óè RoleSwitcher Component ‚Ä∫ Unsaved Changes Warning ‚Ä∫ should proceed with role switch when Save & Switch is clicked

    Unable to find an element with the text: Coordinator. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [0m
            [0m
      [36m<form[39m
        [33mdata-dirty[39m=[32m"true"[39m
      [36m>[39m
        [0m
              [0m
        [36m<input[39m
          [33mtype[39m=[32m"text"[39m
          [33mvalue[39m=[32m"test"[39m
        [36m/>[39m
        [0m
            [0m
      [36m</form>[39m
      [0m
          [0m
      [36m<div>[39m
        [36m<button[39m
          [33maria-expanded[39m=[32m"false"[39m
          [33maria-haspopup[39m=[32m"menu"[39m
          [33mclass[39m=[32m"inline-flex items-center justify-center whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9 rounded-md px-3 gap-2 undefined"[39m
          [33mdata-state[39m=[32m"closed"[39m
          [33mid[39m=[32m"radix-:ri:"[39m
          [33mtype[39m=[32m"button"[39m
        [36m>[39m
          [36m<div[39m
            [33mdata-testid[39m=[32m"user-icon"[39m
          [36m/>[39m
          [36m<span[39m
            [33mclass[39m=[32m"hidden sm:inline"[39m
          [36m>[39m
            [0mAssessor[0m
          [36m</span>[39m
          [36m<div[39m
            [33mclass[39m=[32m"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-blue-100 text-blue-800 hover:bg-blue-200"[39m
          [36m>[39m
            [0mAssessor[0m
          [36m</div>[39m
          [36m<div[39m
            [33mdata-testid[39m=[32m"arrow-left-right-icon"[39m
          [36m/>[39m
        [36m</button>[39m
      [36m</div>[39m
    [36m</body>[39m

    [0m [90m 276 |[39m       fireEvent[33m.[39mclick(button)[33m;[39m
     [90m 277 |[39m
    [31m[1m>[22m[39m[90m 278 |[39m       [36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                    [31m[1m^[22m[39m
     [90m 279 |[39m         [36mconst[39m coordinatorOption [33m=[39m screen[33m.[39mgetByText([32m'Coordinator'[39m)[33m;[39m
     [90m 280 |[39m         fireEvent[33m.[39mclick(coordinatorOption)[33m;[39m
     [90m 281 |[39m       })[33m;[39m[0m

      at waitForWrapper (node_modules/@testing-library/dom/dist/wait-for.js:163:27)
      at Object.<anonymous> (tests/unit/components/RoleSwitcher.test.tsx:278:20)

----------------------------------------------------------|---------|----------|---------|---------|-----------------------------------------------------------------------
File                                                      | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s                                                     
----------------------------------------------------------|---------|----------|---------|---------|-----------------------------------------------------------------------
All files                                                 |       9 |     5.02 |    7.63 |    9.27 |                                                                       
 src                                                      |       0 |        0 |       0 |       0 |                                                                       
  middleware.ts                                           |       0 |        0 |       0 |       0 | 1-56                                                                  
 src/app/(auth)/assessor/dashboard                        |       0 |      100 |       0 |       0 |                                                                       
  page.tsx                                                |       0 |      100 |       0 |       0 | 3-12                                                                  
 src/app/(auth)/assessor/preliminary-assessment           |       0 |        0 |       0 |       0 |                                                                       
  page.tsx                                                |       0 |        0 |       0 |       0 | 3-220                                                                 
 src/app/(auth)/assessor/rapid-assessments                |       0 |        0 |       0 |       0 |                                                                       
  page.tsx                                                |       0 |        0 |       0 |       0 | 3-254                                                                 
 src/app/(auth)/assessor/rapid-assessments/new            |       0 |        0 |       0 |       0 |                                                                       
  page.tsx                                                |       0 |        0 |       0 |       0 | 3-296                                                                 
 src/app/(auth)/coordinator/dashboard                     |       0 |      100 |       0 |       0 |                                                                       
  page.tsx                                                |       0 |      100 |       0 |       0 | 3-12                                                                  
 src/app/(auth)/coordinator/entities                      |       0 |        0 |       0 |       0 |                                                                       
  page.tsx                                                |       0 |        0 |       0 |       0 | 3-571                                                                 
 src/app/(auth)/coordinator/verification                  |       0 |        0 |       0 |       0 |                                                                       
  page.tsx                                                |       0 |        0 |       0 |       0 | 3-43                                                                  
 src/app/(auth)/coordinator/verification/auto-approval    |       0 |      100 |       0 |       0 |                                                                       
  page.tsx                                                |       0 |      100 |       0 |       0 | 2-9                                                                   
 src/app/(auth)/coordinator/verification/deliveries       |       0 |        0 |       0 |       0 |                                                                       
  page.tsx                                                |       0 |        0 |       0 |       0 | 3-631                                                                 
 src/app/(auth)/responder/dashboard                       |       0 |        0 |       0 |       0 |                                                                       
  page.tsx                                                |       0 |        0 |       0 |       0 | 3-214                                                                 
 src/app/(auth)/responder/planning                        |       0 |        0 |       0 |       0 |                                                                       
  page.tsx                                                |       0 |        0 |       0 |       0 | 3-195                                                                 
 src/app/(auth)/responder/planning/new                    |       0 |      100 |       0 |       0 |                                                                       
  page.tsx                                                |       0 |      100 |       0 |       0 | 4-25                                                                  
 src/app/(auth)/responder/responses/[id]/deliver          |       0 |        0 |       0 |       0 |                                                                       
  page.tsx                                                |       0 |        0 |       0 |       0 | 3-96                                                                  
 src/app/admin/users                                      |       0 |        0 |       0 |       0 |                                                                       
  page.tsx                                                |       0 |        0 |       0 |       0 | 3-269                                                                 
 src/app/api/entities/available-for-assessment            |       0 |        0 |       0 |       0 |                                                                       
  route.ts                                                |       0 |        0 |       0 |       0 | 1-84                                                                  
 src/app/api/living-tests                                 |       0 |        0 |       0 |       0 |                                                                       
  route.ts                                                |       0 |        0 |       0 |       0 | 8-340                                                                 
 src/app/api/v1/assessments/[id]/reject                   |       0 |        0 |       0 |       0 |                                                                       
  route.ts                                                |       0 |        0 |       0 |       0 | 1-151                                                                 
 src/app/api/v1/assessments/[id]/verify                   |       0 |        0 |       0 |       0 |                                                                       
  route.ts                                                |       0 |        0 |       0 |       0 | 1-140                                                                 
 src/app/api/v1/assessments/verified                      |       0 |        0 |       0 |       0 |                                                                       
  route.ts                                                |       0 |        0 |       0 |       0 | 1-54                                                                  
 src/app/api/v1/auth/login                                |   21.73 |        0 |       0 |   22.72 |                                                                       
  route.ts                                                |   21.73 |        0 |       0 |   22.72 | 12-77                                                                 
 src/app/api/v1/auth/logout                               |       0 |      100 |       0 |       0 |                                                                       
  route.ts                                                |       0 |      100 |       0 |       0 | 1-26                                                                  
 src/app/api/v1/auth/me                                   |   27.77 |        0 |       0 |   31.25 |                                                                       
  route.ts                                                |   27.77 |        0 |       0 |   31.25 | 8-53                                                                  
 src/app/api/v1/auth/profile                              |       0 |        0 |       0 |       0 |                                                                       
  route.ts                                                |       0 |        0 |       0 |       0 | 1-228                                                                 
 src/app/api/v1/auth/refresh                              |   41.66 |        0 |       0 |   45.45 |                                                                       
  route.ts                                                |   41.66 |        0 |       0 |   45.45 | 8-27                                                                  
 src/app/api/v1/auto-assignment/config                    |       0 |        0 |       0 |       0 |                                                                       
  route.ts                                                |       0 |        0 |       0 |       0 | 1-154                                                                 
 src/app/api/v1/auto-assignment/trigger                   |   27.27 |        0 |       0 |   28.57 |                                                                       
  route.ts                                                |   27.27 |        0 |       0 |   28.57 | 15-66                                                                 
 src/app/api/v1/delivery-media                            |       0 |        0 |       0 |       0 |                                                                       
  route.ts                                                |       0 |        0 |       0 |       0 | 1-243                                                                 
 src/app/api/v1/delivery-media/[id]                       |       0 |        0 |       0 |       0 |                                                                       
  route.ts                                                |       0 |        0 |       0 |       0 | 1-194                                                                 
 src/app/api/v1/delivery-media/sync                       |       0 |        0 |       0 |       0 |                                                                       
  route.ts                                                |       0 |        0 |       0 |       0 | 1-88                                                                  
 src/app/api/v1/entities                                  |       0 |        0 |       0 |       0 |                                                                       
  route.ts                                                |       0 |        0 |       0 |       0 | 1-53                                                                  
 src/app/api/v1/entities/[id]/auto-approval               |       0 |        0 |       0 |       0 |                                                                       
  route.ts                                                |       0 |        0 |       0 |       0 | 1-203                                                                 
 src/app/api/v1/entities/assigned                         |       0 |        0 |       0 |       0 |                                                                       
  route.ts                                                |       0 |        0 |       0 |       0 | 1-54                                                                  
 src/app/api/v1/entities/public                           |       0 |        0 |       0 |       0 |                                                                       
  route.ts                                                |       0 |        0 |       0 |       0 | 1-22                                                                  
 src/app/api/v1/entity-assignments                        |   16.27 |        0 |       0 |   17.07 |                                                                       
  route.ts                                                |   16.27 |        0 |       0 |   17.07 | 13-129,138-191                                                        
 src/app/api/v1/entity-assignments/[id]                   |   19.35 |        0 |       0 |   17.24 |                                                                       
  route.ts                                                |   19.35 |        0 |       0 |   17.24 | 11-66,75-124                                                          
 src/app/api/v1/entity-assignments/bulk                   |   11.76 |        0 |       0 |   13.33 |                                                                       
  route.ts                                                |   11.76 |        0 |       0 |   13.33 | 13-171                                                                
 src/app/api/v1/entity-assignments/collaboration          |   13.33 |        0 |       0 |   13.79 |                                                                       
  route.ts                                                |   13.33 |        0 |       0 |   13.79 | 6-75                                                                  
 src/app/api/v1/entity-assignments/entity/[entityId]      |       0 |        0 |       0 |       0 |                                                                       
  route.ts                                                |       0 |        0 |       0 |       0 | 1-103                                                                 
 src/app/api/v1/entity-assignments/suggestions            |       0 |        0 |       0 |       0 |                                                                       
  route.ts                                                |       0 |        0 |       0 |       0 | 1-126                                                                 
 src/app/api/v1/entity-assignments/user/[userId]          |       0 |        0 |       0 |       0 |                                                                       
  route.ts                                                |       0 |        0 |       0 |       0 | 1-83                                                                  
 src/app/api/v1/incidents                                 |       0 |        0 |       0 |       0 |                                                                       
  route.ts                                                |       0 |        0 |       0 |       0 | 1-96                                                                  
 src/app/api/v1/incidents/from-assessment                 |       0 |        0 |       0 |       0 |                                                                       
  route.ts                                                |       0 |        0 |       0 |       0 | 1-79                                                                  
 src/app/api/v1/preliminary-assessments                   |       0 |        0 |       0 |       0 |                                                                       
  route.ts                                                |       0 |        0 |       0 |       0 | 1-39                                                                  
 src/app/api/v1/preliminary-assessments/[id]              |       0 |        0 |       0 |       0 |                                                                       
  route.ts                                                |       0 |        0 |       0 |       0 | 1-233                                                                 
 src/app/api/v1/preliminary-assessments/user/[userId]     |       0 |        0 |       0 |       0 |                                                                       
  route.ts                                                |       0 |        0 |       0 |       0 | 1-83                                                                  
 src/app/api/v1/rapid-assessments                         |       0 |        0 |       0 |       0 |                                                                       
  route.ts                                                |       0 |        0 |       0 |       0 | 1-145                                                                 
 src/app/api/v1/rapid-assessments/[id]                    |       0 |        0 |       0 |       0 |                                                                       
  route.ts                                                |       0 |        0 |       0 |       0 | 1-195                                                                 
 src/app/api/v1/rapid-assessments/[id]/submit             |       0 |        0 |       0 |       0 |                                                                       
  route.ts                                                |       0 |        0 |       0 |       0 | 1-62                                                                  
 src/app/api/v1/rapid-assessments/user/[userId]           |       0 |        0 |       0 |       0 |                                                                       
  route.ts                                                |       0 |        0 |       0 |       0 | 1-61                                                                  
 src/app/api/v1/responses/[id]                            |       0 |        0 |       0 |       0 |                                                                       
  route.ts                                                |       0 |        0 |       0 |       0 | 1-183                                                                 
 src/app/api/v1/responses/[id]/collaboration              |       0 |        0 |       0 |       0 |                                                                       
  route.ts                                                |       0 |        0 |       0 |       0 | 1-226                                                                 
 src/app/api/v1/responses/[id]/deliver                    |       0 |        0 |       0 |       0 |                                                                       
  route.ts                                                |       0 |        0 |       0 |       0 | 1-175                                                                 
 src/app/api/v1/responses/conflicts/[assessmentId]        |       0 |        0 |       0 |       0 |                                                                       
  route.ts                                                |       0 |        0 |       0 |       0 | 1-55                                                                  
 src/app/api/v1/responses/planned                         |       0 |        0 |       0 |       0 |                                                                       
  route.ts                                                |       0 |        0 |       0 |       0 | 1-101                                                                 
 src/app/api/v1/responses/planned/assigned                |       0 |        0 |       0 |       0 |                                                                       
  route.ts                                                |       0 |        0 |       0 |       0 | 1-70                                                                  
 src/app/api/v1/roles                                     |       0 |        0 |       0 |       0 |                                                                       
  route.ts                                                |       0 |        0 |       0 |       0 | 1-44                                                                  
 src/app/api/v1/sync/batch                                |       5 |        0 |       0 |    5.26 |                                                                       
  route.ts                                                |       5 |        0 |       0 |    5.26 | 27-344,355-368                                                        
 src/app/api/v1/sync/conflicts                            |    8.33 |        0 |       0 |    9.09 |                                                                       
  route.ts                                                |    8.33 |        0 |       0 |    9.09 | 5-89                                                                  
 src/app/api/v1/sync/conflicts/export                     |    5.55 |        0 |       0 |    6.06 |                                                                       
  route.ts                                                |    5.55 |        0 |       0 |    6.06 | 4-103                                                                 
 src/app/api/v1/sync/conflicts/summary                    |      20 |        0 |       0 |      20 |                                                                       
  route.ts                                                |      20 |        0 |       0 |      20 | 4-44                                                                  
 src/app/api/v1/sync/pull                                 |       0 |        0 |       0 |       0 |                                                                       
  route.ts                                                |       0 |        0 |       0 |       0 | 1-296                                                                 
 src/app/api/v1/sync/resolve                              |       0 |        0 |       0 |       0 |                                                                       
  route.ts                                                |       0 |        0 |       0 |       0 | 1-419                                                                 
 src/app/api/v1/sync/status                               |       0 |        0 |       0 |       0 |                                                                       
  route.ts                                                |       0 |        0 |       0 |       0 | 1-113                                                                 
 src/app/api/v1/users                                     |       0 |        0 |       0 |       0 |                                                                       
  route.ts                                                |       0 |        0 |       0 |       0 | 1-224                                                                 
 src/app/api/v1/users/[userId]                            |       0 |        0 |       0 |       0 |                                                                       
  route.ts                                                |       0 |        0 |       0 |       0 | 1-319                                                                 
 src/app/api/v1/users/[userId]/roles                      |       0 |        0 |       0 |       0 |                                                                       
  route.ts                                                |       0 |        0 |       0 |       0 | 1-174                                                                 
 src/app/api/v1/users/assignable                          |       0 |        0 |       0 |       0 |                                                                       
  route.ts                                                |       0 |        0 |       0 |       0 | 1-85                                                                  
 src/app/api/v1/verification/auto-approval                |       0 |        0 |       0 |       0 |                                                                       
  route.ts                                                |       0 |        0 |       0 |       0 | 1-267                                                                 
 src/app/api/v1/verification/metrics                      |       0 |        0 |       0 |       0 |                                                                       
  route.ts                                                |       0 |        0 |       0 |       0 | 1-145                                                                 
 src/app/api/v1/verification/queue/assessments            |       0 |        0 |       0 |       0 |                                                                       
  route.ts                                                |       0 |        0 |       0 |       0 | 1-91                                                                  
 src/app/api/v1/verification/queue/deliveries             |       0 |        0 |       0 |       0 |                                                                       
  route.ts                                                |       0 |        0 |       0 |       0 | 1-192                                                                 
 src/app/api/v1/verification/queue/deliveries/[id]/verify |       0 |        0 |       0 |       0 |                                                                       
  route.ts                                                |       0 |        0 |       0 |       0 | 1-277                                                                 
 src/app/dashboard                                        |       0 |        0 |       0 |       0 |                                                                       
  page.tsx                                                |       0 |        0 |       0 |       0 | 3-307                                                                 
 src/app/dashboard/crisis                                 |       0 |        0 |       0 |       0 |                                                                       
  page.tsx                                                |       0 |        0 |       0 |       0 | 3-238                                                                 
 src/app/login                                            |       0 |      100 |       0 |       0 |                                                                       
  page.tsx                                                |       0 |      100 |       0 |       0 | 1-3                                                                   
 src/app/profile                                          |       0 |        0 |       0 |       0 |                                                                       
  page.tsx                                                |       0 |        0 |       0 |       0 | 3-84                                                                  
 src/app/rapid-assessments                                |       0 |        0 |       0 |       0 |                                                                       
  page.tsx                                                |       0 |        0 |       0 |       0 | 3-31                                                                  
 src/app/rapid-assessments/new                            |       0 |        0 |       0 |       0 |                                                                       
  page.tsx                                                |       0 |        0 |       0 |       0 | 3-245                                                                 
 src/app/verification/metrics                             |       0 |        0 |       0 |       0 |                                                                       
  page.tsx                                                |       0 |        0 |       0 |       0 | 3-249                                                                 
 src/components/auth                                      |       0 |        0 |       0 |       0 |                                                                       
  EditUserForm.tsx                                        |       0 |        0 |       0 |       0 | 3-410                                                                 
  LoginForm.tsx                                           |       0 |        0 |       0 |       0 | 3-142                                                                 
  RegisterForm.tsx                                        |       0 |        0 |       0 |       0 | 3-255                                                                 
 src/components/dashboards/crisis                         |   47.05 |    31.31 |   46.15 |    49.2 |                                                                       
  ConflictExportDialog.tsx                                |       0 |        0 |       0 |       0 | 3-166                                                                 
  ConflictLog.tsx                                         |   91.42 |     75.6 |      90 |   93.93 | 51,85,232,354                                                         
  ConflictSummary.tsx                                     |       0 |        0 |       0 |       0 | 3-124                                                                 
 src/components/delivery                                  |       0 |        0 |       0 |       0 |                                                                       
  OfflineSyncDashboard.tsx                                |       0 |        0 |       0 |       0 | 3-261                                                                 
  OfflineSyncStatus.tsx                                   |       0 |        0 |       0 |       0 | 3-236                                                                 
 src/components/forms/assessment                          |    7.26 |     6.08 |    1.96 |    7.32 |                                                                       
  FoodAssessmentForm.tsx                                  |       0 |        0 |       0 |       0 | 3-471                                                                 
  HealthAssessmentForm.tsx                                |   53.57 |    50.98 |   14.28 |    53.7 | 132-595                                                               
  PopulationAssessmentForm.tsx                            |       0 |        0 |       0 |       0 | 3-538                                                                 
  PreliminaryAssessmentForm.tsx                           |       0 |        0 |       0 |       0 | 3-551                                                                 
  SecurityAssessmentForm.tsx                              |       0 |        0 |       0 |       0 | 3-424                                                                 
  ShelterAssessmentForm.tsx                               |       0 |        0 |       0 |       0 | 3-478                                                                 
  WASHAssessmentForm.tsx                                  |       0 |        0 |       0 |       0 | 3-513                                                                 
 src/components/forms/delivery                            |       0 |        0 |       0 |       0 |                                                                       
  DeliveryConfirmationForm.tsx                            |       0 |        0 |       0 |       0 | 3-771                                                                 
  DeliveryMediaField.tsx                                  |       0 |        0 |       0 |       0 | 3-471                                                                 
  EnhancedDeliveryMediaCapture.tsx                        |       0 |        0 |       0 |       0 | 3-601                                                                 
 src/components/forms/incident                            |       0 |        0 |       0 |       0 |                                                                       
  IncidentCreationForm.tsx                                |       0 |        0 |       0 |       0 | 3-238                                                                 
 src/components/forms/response                            |   15.72 |        0 |       0 |   16.23 |                                                                       
  ResponsePlanningForm.tsx                                |   15.72 |        0 |       0 |   16.23 | 65-694                                                                
 src/components/layouts                                   |   22.83 |    22.91 |    8.33 |   23.14 |                                                                       
  AppShell.tsx                                            |       0 |        0 |       0 |       0 | 3-92                                                                  
  Navigation.tsx                                          |       0 |        0 |       0 |       0 | 3-280                                                                 
  RoleSwitcher.tsx                                        |   42.64 |    57.89 |   18.18 |   43.75 | 73-83,87-134,140-152,156-157,210-268                                  
 src/components/providers                                 |       0 |      100 |       0 |       0 |                                                                       
  QueryProvider.tsx                                       |       0 |      100 |       0 |       0 | 3-14                                                                  
 src/components/response                                  |   12.96 |        0 |       0 |   13.72 |                                                                       
  AssessmentSelector.tsx                                  |   21.42 |        0 |       0 |   21.95 | 49-184                                                                
  CollaborationStatus.tsx                                 |      25 |        0 |       0 |   27.77 | 33-186                                                                
  ResponsePlanningDashboard.tsx                           |       0 |        0 |       0 |       0 | 3-333                                                                 
 src/components/shared                                    |   15.48 |    11.37 |    8.33 |   16.74 |                                                                       
  EntitySelector.tsx                                      |   16.36 |        0 |       0 |   16.98 | 34-192                                                                
  EntitySelectorSkeleton.tsx                              |      50 |      100 |       0 |      50 | 7                                                                     
  FormStateManager.tsx                                    |       0 |        0 |       0 |       0 | 3-104                                                                 
  GPSCapture.tsx                                          |   81.15 |    85.29 |     100 |   81.15 | 44-45,75-89,100-101                                                   
  Header.tsx                                              |       0 |        0 |       0 |       0 | 3-13                                                                  
  LocationSelector.tsx                                    |       0 |        0 |       0 |       0 | 3-141                                                                 
  MediaField.tsx                                          |   10.81 |        0 |       0 |   12.12 | 29-252                                                                
  OfflineIndicator.tsx                                    |       0 |        0 |       0 |       0 | 3-106                                                                 
  RoleBasedRoute.tsx                                      |       0 |        0 |       0 |       0 | 3-174                                                                 
  SyncIndicator.tsx                                       |       0 |        0 |       0 |       0 | 3-68                                                                  
  SyncQueue.tsx                                           |       0 |        0 |       0 |       0 | 3-332                                                                 
 src/components/testing                                   |       0 |        0 |       0 |       0 |                                                                       
  living-documentation-dashboard.tsx                      |       0 |        0 |       0 |       0 | 14-605                                                                
 src/components/ui                                        |   36.31 |     6.66 |   15.78 |   37.17 |                                                                       
  alert-dialog.tsx                                        |       0 |      100 |     100 |       0 | 1-138                                                                 
  alert.tsx                                               |      90 |      100 |     100 |     100 |                                                                       
  avatar.tsx                                              |   47.05 |        0 |       0 |   61.53 | 53-57,78                                                              
  badge.tsx                                               |   83.33 |      100 |     100 |     100 |                                                                       
  button.tsx                                              |      90 |    66.66 |     100 |     100 | 44                                                                    
  card.tsx                                                |   92.85 |      100 |     100 |     100 |                                                                       
  checkbox.tsx                                            |   83.33 |      100 |     100 |   83.33 | 30                                                                    
  command.tsx                                             |       0 |      100 |       0 |       0 | 1-152                                                                 
  dialog.tsx                                              |       0 |      100 |     100 |       0 | 3-121                                                                 
  dropdown-menu.tsx                                       |   74.28 |    14.28 |       0 |   74.28 | 189-190,193-199                                                       
  form.tsx                                                |   45.45 |        0 |       0 |   45.45 | 45-57,79,93,110,132,149-153,170-177                                   
  input.tsx                                               |     100 |      100 |     100 |     100 |                                                                       
  label.tsx                                               |     100 |      100 |     100 |     100 |                                                                       
  pagination.tsx                                          |       0 |        0 |     100 |       0 | 1-116                                                                 
  popover.tsx                                             |       0 |        0 |     100 |       0 | 1-29                                                                  
  progress.tsx                                            |      80 |        0 |     100 |      80 | 28                                                                    
  scroll-area.tsx                                         |       0 |        0 |     100 |       0 | 1-46                                                                  
  select.tsx                                              |   58.33 |        0 |     100 |   58.33 | 150-159                                                               
  separator.tsx                                           |      80 |        0 |     100 |      80 | 29                                                                    
  skeleton.tsx                                            |      50 |      100 |       0 |      50 | 15                                                                    
  switch.tsx                                              |       0 |      100 |     100 |       0 | 3-29                                                                  
  table.tsx                                               |       0 |      100 |     100 |       0 | 1-116                                                                 
  tabs.tsx                                                |       0 |      100 |     100 |       0 | 1-53                                                                  
  textarea.tsx                                            |      80 |      100 |       0 |      80 | 24                                                                    
  toast.tsx                                               |       0 |      100 |       0 |       0 | 1-126                                                                 
  tooltip.tsx                                             |       0 |        0 |     100 |       0 | 1-28                                                                  
 src/components/verification                              |       0 |        0 |       0 |       0 |                                                                       
  AutoApprovalConfig.tsx                                  |       0 |        0 |       0 |       0 | 3-662                                                                 
  StatusIndicator.tsx                                     |       0 |        0 |       0 |       0 | 1-212                                                                 
  VerificationActions.tsx                                 |       0 |        0 |       0 |       0 | 3-416                                                                 
  VerificationDashboard.tsx                               |       0 |        0 |       0 |       0 | 3-227                                                                 
  VerificationQueue.tsx                                   |       0 |        0 |       0 |       0 | 3-325                                                                 
 src/hooks                                                |    3.12 |        0 |       0 |    3.04 |                                                                       
  useAuth.ts                                              |      60 |      100 |       0 |      50 | 5-7                                                                   
  useBackgroundSync.ts                                    |       0 |        0 |       0 |       0 | 3-140                                                                 
  useCollaboration.ts                                     |   16.12 |        0 |       0 |   17.24 | 22-84                                                                 
  useConflicts.ts                                         |       0 |        0 |       0 |       0 | 1-142                                                                 
  useEntities.ts                                          |       0 |        0 |       0 |       0 | 1-69                                                                  
  useGPS.ts                                               |       0 |        0 |       0 |       0 | 3-120                                                                 
  useIncident.ts                                          |       0 |        0 |       0 |       0 | 1-13                                                                  
  useOffline.ts                                           |    5.61 |        0 |       0 |    4.65 | 32-223                                                                
  usePreliminaryAssessment.ts                             |       0 |        0 |       0 |       0 | 1-13                                                                  
  useRoleSession.ts                                       |       0 |        0 |       0 |       0 | 3-183                                                                 
  useSync.ts                                              |    6.66 |        0 |       0 |    7.21 | 43-148,170-204,209-255,260-278                                        
  useVerification.ts                                      |       0 |        0 |       0 |       0 | 1-257                                                                 
 src/lib                                                  |     100 |      100 |     100 |     100 |                                                                       
  utils.ts                                                |     100 |      100 |     100 |     100 |                                                                       
 src/lib/assignment                                       |   64.83 |    52.45 |   78.68 |   64.36 |                                                                       
  auto-assignment.ts                                      |   85.88 |    69.64 |     100 |   85.71 | 171,180,208,224-225,278,293,326-334,364,393-397                       
  middleware.ts                                           |    1.51 |        0 |       0 |    1.58 | 7-221                                                                 
  multi-user-service.ts                                   |   84.42 |    78.12 |     100 |   83.33 | 95-96,133-134,204-205,305,313,324-325,384-385,487-489,496-497,516-517 
 src/lib/auth                                             |   28.14 |     9.43 |      34 |   28.34 |                                                                       
  auth-options.ts                                         |       0 |        0 |       0 |       0 | 4-62                                                                  
  config.ts                                               |       0 |      100 |     100 |       0 | 1-4                                                                   
  get-current-user.ts                                     |       0 |        0 |       0 |       0 | 10-53                                                                 
  middleware.ts                                           |    12.5 |        0 |   14.28 |   13.33 | 23-102                                                                
  role-check.ts                                           |       0 |        0 |       0 |       0 | 1-51                                                                  
  service.ts                                              |   67.64 |    35.71 |      64 |   69.35 | 136,173,187-194,262-309                                               
  verify.ts                                               |   13.33 |        0 |       0 |   13.63 | 16-60,71-88,95-112,119-136                                            
 src/lib/data                                             |       0 |        0 |       0 |       0 |                                                                       
  nigeria-locations.ts                                    |       0 |        0 |       0 |       0 | 18-243                                                                
 src/lib/db                                               |      10 |    13.04 |    2.38 |    8.82 |                                                                       
  client.ts                                               |     100 |      100 |     100 |     100 |                                                                       
  offline.ts                                              |    6.89 |        0 |    2.38 |    6.62 | 69,77-154,178-548,560-563                                             
 src/lib/services                                         |    3.34 |     1.92 |    3.06 |    3.59 |                                                                       
  conflict-export.service.ts                              |       0 |        0 |       0 |       0 | 10-330                                                                
  delivery-media.service.ts                               |       0 |        0 |       0 |       0 | 2-348                                                                 
  delivery-offline.service.ts                             |       0 |        0 |       0 |       0 | 1-694                                                                 
  entity-assignment.service.ts                            |       0 |        0 |       0 |       0 | 1-485                                                                 
  entity.service.ts                                       |       0 |        0 |       0 |       0 | 1-159                                                                 
  incident.service.ts                                     |       0 |        0 |       0 |       0 | 1-175                                                                 
  preliminary-assessment.service.ts                       |   59.45 |       50 |   71.42 |   59.45 | 68-102,127,135,184                                                    
  rapid-assessment.service.ts                             |       0 |        0 |       0 |       0 | 1-421                                                                 
  response-client.service.ts                              |    4.61 |        0 |       0 |    5.08 | 4,8-163                                                               
  response-offline.service.ts                             |    4.49 |        0 |       0 |    4.76 | 5,10-281                                                              
  response.service.ts                                     |    1.56 |        0 |       0 |    1.66 | 23-460                                                                
 src/lib/sync                                             |    37.1 |     30.9 |   51.72 |   36.49 |                                                                       
  conflict.ts                                             |    8.33 |     3.77 |   21.05 |    7.03 | 46,68-453                                                             
  engine.ts                                               |   30.52 |    21.66 |      50 |   31.18 | 66-68,78-80,96,103,110,134-148,158-487,511-514,581                    
  queue.ts                                                |   64.83 |    69.23 |   76.92 |   64.32 | 207-208,256-268,286-301,324-399,423-424,436                           
 src/lib/testing                                          |       0 |        0 |       0 |       0 |                                                                       
  fix-validator.ts                                        |       0 |        0 |       0 |       0 | 69-966                                                                
  living-documentation-dashboard.tsx                      |       0 |        0 |       0 |       0 | 14-605                                                                
  living-test-system.ts                                   |       0 |        0 |       0 |       0 | 9-890                                                                 
 src/lib/utils                                            |       0 |        0 |       0 |       0 |                                                                       
  audit-logger.ts                                         |       0 |        0 |       0 |       0 | 1-96                                                                  
  delivery-media-manager.ts                               |       0 |        0 |       0 |       0 | 2-396                                                                 
  delivery-media-validator.ts                             |       0 |        0 |       0 |       0 | 26-530                                                                
 src/lib/validation                                       |       0 |      100 |     100 |       0 |                                                                       
  incidents.ts                                            |       0 |      100 |     100 |       0 | 1-21                                                                  
  preliminary-assessment.ts                               |       0 |      100 |     100 |       0 | 1-39                                                                  
  rapid-assessment.ts                                     |       0 |      100 |     100 |       0 | 1-152                                                                 
  response.ts                                             |       0 |      100 |     100 |       0 | 1-38                                                                  
 src/providers                                            |       0 |        0 |       0 |       0 |                                                                       
  BackgroundSyncProvider.tsx                              |       0 |        0 |       0 |       0 | 3-140                                                                 
 src/stores                                               |    2.09 |        0 |       0 |    2.26 |                                                                       
  auth.store.ts                                           |       0 |        0 |       0 |       0 | 1-236                                                                 
  entity.store.ts                                         |       0 |        0 |       0 |       0 | 1-450                                                                 
  incident.store.ts                                       |       0 |        0 |       0 |       0 | 1-238                                                                 
  offline.store.ts                                        |    7.69 |        0 |       0 |    9.09 | 58-217                                                                
  preliminary-assessment.store.ts                         |       0 |        0 |       0 |       0 | 1-494                                                                 
  sync.store.ts                                           |    7.08 |        0 |       0 |    8.03 | 77-395,411,415,425-426,435                                            
 src/types                                                |    6.66 |      100 |     100 |    12.5 |                                                                       
  media.ts                                                |       0 |      100 |     100 |       0 | 1-118                                                                 
  rapid-assessment.ts                                     |   16.66 |      100 |     100 |      50 | 4                                                                     
  response.ts                                             |       0 |      100 |     100 |       0 | 1-69                                                                  
 src/utils                                                |   12.76 |        0 |       0 |      15 |                                                                       
  assessment-utils.ts                                     |   12.76 |        0 |       0 |      15 | 9-33,45-55,66-77,91-99,109-113,127-137                                
----------------------------------------------------------|---------|----------|---------|---------|-----------------------------------------------------------------------
Jest: "global" coverage threshold for statements (70%) not met: 9%
Jest: "global" coverage threshold for branches (70%) not met: 5.02%
Jest: "global" coverage threshold for lines (70%) not met: 9.27%
Jest: "global" coverage threshold for functions (70%) not met: 7.63%
Summary of all failing tests
FAIL tests/unit/sync/queue.test.ts
  ‚óè SyncQueueManager ‚Ä∫ addItem ‚Ä∫ should add item to sync queue

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    - Expected
    + Received

      Object {
        "action": "create",
    +   "attempts": 0,
        "data": Object {
          "test": "data",
        },
        "entityUuid": "entity1",
        "priority": 8,
    +   "timestamp": 2025-11-05T13:14:29.898Z,
        "type": "assessment",
        "uuid": "mock-uuid-1234",
      },

    Number of calls: 1

    [0m [90m 46 |[39m
     [90m 47 |[39m       expect(uuid)[33m.[39mtoBe([32m'mock-uuid-1234'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 48 |[39m       expect(offlineDB[33m.[39maddToSyncQueue)[33m.[39mtoHaveBeenCalledWith({
     [90m    |[39m                                        [31m[1m^[22m[39m
     [90m 49 |[39m         uuid[33m:[39m [32m'mock-uuid-1234'[39m[33m,[39m
     [90m 50 |[39m         type[33m:[39m [32m'assessment'[39m[33m,[39m
     [90m 51 |[39m         action[33m:[39m [32m'create'[39m[33m,[39m[0m

      at Object.toHaveBeenCalledWith (tests/unit/sync/queue.test.ts:48:40)

  ‚óè SyncQueueManager ‚Ä∫ getItem ‚Ä∫ should return queue item when found

    expect(received).toEqual(expected) // deep equality

    - Expected  - 1
    + Received  + 1

    @@ -4,10 +4,10 @@
        "entityUuid": "entity1",
        "error": "Network error",
        "lastAttempt": 2024-01-01T01:00:00.000Z,
        "nextRetry": 2024-01-01T01:05:00.000Z,
        "priority": 5,
    -   "status": "retrying",
    +   "status": "failed",
        "timestamp": 2024-01-01T00:00:00.000Z,
        "type": "assessment",
        "uuid": "uuid1",
      }

    [0m [90m 137 |[39m       [36mconst[39m result [33m=[39m [36mawait[39m queueManager[33m.[39mgetItem([32m'uuid1'[39m)[33m;[39m
     [90m 138 |[39m
    [31m[1m>[22m[39m[90m 139 |[39m       expect(result)[33m.[39mtoEqual({
     [90m     |[39m                      [31m[1m^[22m[39m
     [90m 140 |[39m         uuid[33m:[39m [32m'uuid1'[39m[33m,[39m
     [90m 141 |[39m         type[33m:[39m [32m'assessment'[39m[33m,[39m
     [90m 142 |[39m         action[33m:[39m [32m'create'[39m[33m,[39m[0m

      at Object.toEqual (tests/unit/sync/queue.test.ts:139:22)

  ‚óè SyncQueueManager ‚Ä∫ getMetrics ‚Ä∫ should calculate queue metrics correctly

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 2

    @@ -8,12 +8,12 @@
        "byType": Object {
          "assessment": 2,
          "entity": 0,
          "response": 1,
        },
    -   "failed": 0,
    +   "failed": 1,
        "maxRetries": 1,
        "oldestPending": 2024-01-01T00:00:00.000Z,
        "pending": 1,
    -   "retrying": 1,
    +   "retrying": 0,
        "total": 3,
      }

    [0m [90m 303 |[39m       [36mconst[39m metrics [33m=[39m [36mawait[39m queueManager[33m.[39mgetMetrics()[33m;[39m
     [90m 304 |[39m
    [31m[1m>[22m[39m[90m 305 |[39m       expect(metrics)[33m.[39mtoEqual({
     [90m     |[39m                       [31m[1m^[22m[39m
     [90m 306 |[39m         total[33m:[39m [35m3[39m[33m,[39m
     [90m 307 |[39m         pending[33m:[39m [35m1[39m[33m,[39m  [90m// uuid1[39m
     [90m 308 |[39m         retrying[33m:[39m [35m1[39m[33m,[39m [90m// uuid2[39m[0m

      at Object.toEqual (tests/unit/sync/queue.test.ts:305:23)

FAIL tests/unit/services/multi-user-assignment.test.ts
  ‚óè MultiUserAssignmentService ‚Ä∫ getEntityCollaboration ‚Ä∫ should return collaboration details for entity with multiple users

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 2

    @@ -3,21 +3,21 @@
        "assignedUsers": Array [
          Object {
            "assignedAt": 2024-01-01T00:00:00.000Z,
            "assignedBy": "coordinator1",
            "email": "assessor1@test.com",
    -       "name": "John Doe",
    +       "name": "assessor1@test.com",
            "roles": Array [
              "ASSESSOR",
            ],
            "userId": "user1",
          },
          Object {
            "assignedAt": 2024-01-02T00:00:00.000Z,
            "assignedBy": "coordinator1",
            "email": "responder1@test.com",
    -       "name": "Jane Smith",
    +       "name": "responder1@test.com",
            "roles": Array [
              "RESPONDER",
            ],
            "userId": "user2",
          },

    [0m [90m 90 |[39m       [36mconst[39m result [33m=[39m [36mawait[39m [33mMultiUserAssignmentService[39m[33m.[39mgetEntityCollaboration([32m'entity123'[39m)[33m;[39m
     [90m 91 |[39m
    [31m[1m>[22m[39m[90m 92 |[39m       expect(result)[33m.[39mtoEqual({
     [90m    |[39m                      [31m[1m^[22m[39m
     [90m 93 |[39m         entityId[33m:[39m [32m'entity123'[39m[33m,[39m
     [90m 94 |[39m         entityName[33m:[39m [32m'Test Community'[39m[33m,[39m
     [90m 95 |[39m         entityType[33m:[39m [32m'COMMUNITY'[39m[33m,[39m[0m

      at Object.toEqual (tests/unit/services/multi-user-assignment.test.ts:92:22)

  ‚óè MultiUserAssignmentService ‚Ä∫ getUserAssignmentOverview ‚Ä∫ should return user assignment overview with collaboration details

    expect(received).toEqual(expected) // deep equality

    - Expected  - 13
    + Received  +  3

      Object {
    -   "assignedEntities": Array [
    -     Object {
    -       "assignedAt": 2024-01-01T00:00:00.000Z,
    -       "entityId": "entity123",
    -       "entityName": "Test Community",
    -       "entityType": "COMMUNITY",
    -       "sharedWith": Array [
    -         "Jane Smith",
    -       ],
    -     },
    -   ],
    -   "collaborations": 1,
    +   "assignedEntities": Array [],
    +   "collaborations": 0,
        "email": "assessor1@test.com",
    -   "name": "John Doe",
    +   "name": "assessor1@test.com",
        "roles": Array [
          "ASSESSOR",
        ],
        "userId": "user1",
      }

    [0m [90m 154 |[39m       [36mconst[39m result [33m=[39m [36mawait[39m [33mMultiUserAssignmentService[39m[33m.[39mgetUserAssignmentOverview([32m'user1'[39m)[33m;[39m
     [90m 155 |[39m
    [31m[1m>[22m[39m[90m 156 |[39m       expect(result)[33m.[39mtoEqual({
     [90m     |[39m                      [31m[1m^[22m[39m
     [90m 157 |[39m         userId[33m:[39m [32m'user1'[39m[33m,[39m
     [90m 158 |[39m         email[33m:[39m [32m'assessor1@test.com'[39m[33m,[39m
     [90m 159 |[39m         name[33m:[39m [32m'John Doe'[39m[33m,[39m[0m

      at Object.toEqual (tests/unit/services/multi-user-assignment.test.ts:156:22)

  ‚óè MultiUserAssignmentService ‚Ä∫ getUserAssignmentOverview ‚Ä∫ should handle users with no assignments

    expect(received).toEqual(expected) // deep equality

    - Expected  - 1
    + Received  + 1

      Object {
        "assignedEntities": Array [],
        "collaborations": 0,
        "email": "assessor1@test.com",
    -   "name": "John Doe",
    +   "name": "assessor1@test.com",
        "roles": Array [
          "ASSESSOR",
        ],
        "userId": "user1",
      }

    [0m [90m 190 |[39m       [36mconst[39m result [33m=[39m [36mawait[39m [33mMultiUserAssignmentService[39m[33m.[39mgetUserAssignmentOverview([32m'user1'[39m)[33m;[39m
     [90m 191 |[39m
    [31m[1m>[22m[39m[90m 192 |[39m       expect(result)[33m.[39mtoEqual({
     [90m     |[39m                      [31m[1m^[22m[39m
     [90m 193 |[39m         userId[33m:[39m [32m'user1'[39m[33m,[39m
     [90m 194 |[39m         email[33m:[39m [32m'assessor1@test.com'[39m[33m,[39m
     [90m 195 |[39m         name[33m:[39m [32m'John Doe'[39m[33m,[39m[0m

      at Object.toEqual (tests/unit/services/multi-user-assignment.test.ts:192:22)

FAIL tests/unit/services/response-planning.test.ts
  ‚óè Response Planning Service ‚Ä∫ ResponseService (Backend) ‚Ä∫ should create a planned response successfully

    ReferenceError: responseService is not defined

    [0m [90m 82 |[39m       }
     [90m 83 |[39m
    [31m[1m>[22m[39m[90m 84 |[39m       [33m;[39m(responseService[33m.[39mcreatePlannedResponse [36mas[39m jest[33m.[39m[33mMock[39m)[33m.[39mmockResolvedValue(mockResponse)
     [90m    |[39m         [31m[1m^[22m[39m
     [90m 85 |[39m
     [90m 86 |[39m       [36mconst[39m result [33m=[39m [36mawait[39m [33mResponseService[39m[33m.[39mcreatePlannedResponse(
     [90m 87 |[39m         validResponseData[33m,[39m[0m

      at Object.responseService (tests/unit/services/response-planning.test.ts:84:9)

  ‚óè Response Planning Service ‚Ä∫ ResponseService (Backend) ‚Ä∫ should throw error for invalid assessment

    ReferenceError: responseService is not defined

    [0m [90m 102 |[39m       }
     [90m 103 |[39m
    [31m[1m>[22m[39m[90m 104 |[39m       [33m;[39m(responseService[33m.[39mcreatePlannedResponse [36mas[39m jest[33m.[39m[33mMock[39m)[33m.[39mmockRejectedValue(
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 105 |[39m         [36mnew[39m [33mError[39m([32m'Assessment not found'[39m)
     [90m 106 |[39m       )
     [90m 107 |[39m[0m

      at Object.responseService (tests/unit/services/response-planning.test.ts:104:9)

  ‚óè Response Planning Service ‚Ä∫ ResponseService (Backend) ‚Ä∫ should validate response items

    ReferenceError: responseService is not defined

    [0m [90m 117 |[39m       }
     [90m 118 |[39m
    [31m[1m>[22m[39m[90m 119 |[39m       [33m;[39m(responseService[33m.[39mcreatePlannedResponse [36mas[39m jest[33m.[39m[33mMock[39m)[33m.[39mmockRejectedValue(
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 120 |[39m         [36mnew[39m [33mError[39m([32m'At least one item is required'[39m)
     [90m 121 |[39m       )
     [90m 122 |[39m[0m

      at Object.responseService (tests/unit/services/response-planning.test.ts:119:9)

  ‚óè Response Planning Service ‚Ä∫ ResponseOfflineService ‚Ä∫ Online Operations ‚Ä∫ should create response online and cache it

    ReferenceError: responseService is not defined

    [0m [90m 136 |[39m         }
     [90m 137 |[39m
    [31m[1m>[22m[39m[90m 138 |[39m         [33m;[39m(responseService[33m.[39mcreatePlannedResponse [36mas[39m jest[33m.[39m[33mMock[39m)[33m.[39mmockResolvedValue(mockResponse)
     [90m     |[39m           [31m[1m^[22m[39m
     [90m 139 |[39m         [33m;[39m(offlineDB[33m.[39maddResponse [36mas[39m jest[33m.[39m[33mMock[39m)[33m.[39mmockResolvedValue([35m1[39m)
     [90m 140 |[39m
     [90m 141 |[39m         [36mconst[39m result [33m=[39m [36mawait[39m responseOfflineService[33m.[39mcreatePlannedResponse(validResponseData)[0m

      at Object.responseService (tests/unit/services/response-planning.test.ts:138:11)

  ‚óè Response Planning Service ‚Ä∫ ResponseOfflineService ‚Ä∫ Online Operations ‚Ä∫ should update response online and cache it

    ReferenceError: responseService is not defined

    [0m [90m 162 |[39m         }
     [90m 163 |[39m
    [31m[1m>[22m[39m[90m 164 |[39m         [33m;[39m(responseService[33m.[39mupdatePlannedResponse [36mas[39m jest[33m.[39m[33mMock[39m)[33m.[39mmockResolvedValue(mockResponse)
     [90m     |[39m           [31m[1m^[22m[39m
     [90m 165 |[39m         [33m;[39m(offlineDB[33m.[39mupdateResponse [36mas[39m jest[33m.[39m[33mMock[39m)[33m.[39mmockResolvedValue([35m1[39m)
     [90m 166 |[39m
     [90m 167 |[39m         [36mconst[39m result [33m=[39m [36mawait[39m responseOfflineService[33m.[39mupdatePlannedResponse([0m

      at Object.responseService (tests/unit/services/response-planning.test.ts:164:11)

  ‚óè Response Planning Service ‚Ä∫ ResponseOfflineService ‚Ä∫ Online Operations ‚Ä∫ should get response online and cache it

    ReferenceError: responseService is not defined

    [0m [90m 191 |[39m         }
     [90m 192 |[39m
    [31m[1m>[22m[39m[90m 193 |[39m         [33m;[39m(responseService[33m.[39mgetResponseById [36mas[39m jest[33m.[39m[33mMock[39m)[33m.[39mmockResolvedValue(mockResponse)
     [90m     |[39m           [31m[1m^[22m[39m
     [90m 194 |[39m         [33m;[39m(offlineDB[33m.[39mupdateResponse [36mas[39m jest[33m.[39m[33mMock[39m)[33m.[39mmockResolvedValue([35m1[39m)
     [90m 195 |[39m
     [90m 196 |[39m         [36mconst[39m result [33m=[39m [36mawait[39m responseOfflineService[33m.[39mgetResponseById([32m'response-123'[39m)[0m

      at Object.responseService (tests/unit/services/response-planning.test.ts:193:11)

  ‚óè Response Planning Service ‚Ä∫ ResponseOfflineService ‚Ä∫ Offline Fallback ‚Ä∫ should create response offline when online fails

    ReferenceError: responseService is not defined

    [0m [90m 208 |[39m       it([32m'should create response offline when online fails'[39m[33m,[39m [36masync[39m () [33m=>[39m {
     [90m 209 |[39m         [36mconst[39m onlineError [33m=[39m [36mnew[39m [33mError[39m([32m'Network error'[39m)
    [31m[1m>[22m[39m[90m 210 |[39m         [33m;[39m(responseService[33m.[39mcreatePlannedResponse [36mas[39m jest[33m.[39m[33mMock[39m)[33m.[39mmockRejectedValue(onlineError)
     [90m     |[39m           [31m[1m^[22m[39m
     [90m 211 |[39m         [33m;[39m(offlineDB[33m.[39maddResponse [36mas[39m jest[33m.[39m[33mMock[39m)[33m.[39mmockResolvedValue([35m1[39m)
     [90m 212 |[39m         [33m;[39m(offlineDB[33m.[39maddToSyncQueue [36mas[39m jest[33m.[39m[33mMock[39m)[33m.[39mmockResolvedValue([35m1[39m)
     [90m 213 |[39m[0m

      at Object.responseService (tests/unit/services/response-planning.test.ts:210:11)

  ‚óè Response Planning Service ‚Ä∫ ResponseOfflineService ‚Ä∫ Offline Fallback ‚Ä∫ should update response offline when online fails

    ReferenceError: responseService is not defined

    [0m [90m 248 |[39m       it([32m'should update response offline when online fails'[39m[33m,[39m [36masync[39m () [33m=>[39m {
     [90m 249 |[39m         [36mconst[39m onlineError [33m=[39m [36mnew[39m [33mError[39m([32m'Network error'[39m)
    [31m[1m>[22m[39m[90m 250 |[39m         [33m;[39m(responseService[33m.[39mupdatePlannedResponse [36mas[39m jest[33m.[39m[33mMock[39m)[33m.[39mmockRejectedValue(onlineError)
     [90m     |[39m           [31m[1m^[22m[39m
     [90m 251 |[39m         [33m;[39m(offlineDB[33m.[39mupdateResponse [36mas[39m jest[33m.[39m[33mMock[39m)[33m.[39mmockResolvedValue([35m1[39m)
     [90m 252 |[39m         [33m;[39m(offlineDB[33m.[39maddToSyncQueue [36mas[39m jest[33m.[39m[33mMock[39m)[33m.[39mmockResolvedValue([35m1[39m)
     [90m 253 |[39m[0m

      at Object.responseService (tests/unit/services/response-planning.test.ts:250:11)

  ‚óè Response Planning Service ‚Ä∫ ResponseOfflineService ‚Ä∫ Offline Fallback ‚Ä∫ should get response from offline cache when online fails

    ReferenceError: responseService is not defined

    [0m [90m 297 |[39m         }
     [90m 298 |[39m
    [31m[1m>[22m[39m[90m 299 |[39m         [33m;[39m(responseService[33m.[39mgetResponseById [36mas[39m jest[33m.[39m[33mMock[39m)[33m.[39mmockRejectedValue(onlineError)
     [90m     |[39m           [31m[1m^[22m[39m
     [90m 300 |[39m         [33m;[39m(offlineDB[33m.[39mgetResponse [36mas[39m jest[33m.[39m[33mMock[39m)[33m.[39mmockResolvedValue(mockOfflineResponse)
     [90m 301 |[39m
     [90m 302 |[39m         [36mconst[39m result [33m=[39m [36mawait[39m responseOfflineService[33m.[39mgetResponseById([32m'response-123'[39m)[0m

      at Object.responseService (tests/unit/services/response-planning.test.ts:299:11)

  ‚óè Response Planning Service ‚Ä∫ ResponseOfflineService ‚Ä∫ Sync Operations ‚Ä∫ should sync pending responses successfully

    TypeError: _offline.offlineDB.getSyncQueue.mockResolvedValue is not a function

    [0m [90m 328 |[39m         ]
     [90m 329 |[39m
    [31m[1m>[22m[39m[90m 330 |[39m         [33m;[39m(offlineDB[33m.[39mgetSyncQueue [36mas[39m jest[33m.[39m[33mMock[39m)[33m.[39mmockResolvedValue(mockPendingResponses)
     [90m     |[39m                                                [31m[1m^[22m[39m
     [90m 331 |[39m         [33m;[39m(responseService[33m.[39mcreatePlannedResponse [36mas[39m jest[33m.[39m[33mMock[39m)[33m.[39mmockResolvedValue({ id[33m:[39m [32m'response-123'[39m })
     [90m 332 |[39m         [33m;[39m(responseService[33m.[39mupdatePlannedResponse [36mas[39m jest[33m.[39m[33mMock[39m)[33m.[39mmockResolvedValue({ id[33m:[39m [32m'response-456'[39m })
     [90m 333 |[39m         [33m;[39m(offlineDB[33m.[39mupdateResponse [36mas[39m jest[33m.[39m[33mMock[39m)[33m.[39mmockResolvedValue([35m1[39m)[0m

      at Object.mockResolvedValue (tests/unit/services/response-planning.test.ts:330:48)

  ‚óè Response Planning Service ‚Ä∫ ResponseOfflineService ‚Ä∫ Sync Operations ‚Ä∫ should handle sync failures with retry logic

    TypeError: _offline.offlineDB.getSyncQueue.mockResolvedValue is not a function

    [0m [90m 357 |[39m         }
     [90m 358 |[39m
    [31m[1m>[22m[39m[90m 359 |[39m         [33m;[39m(offlineDB[33m.[39mgetSyncQueue [36mas[39m jest[33m.[39m[33mMock[39m)[33m.[39mmockResolvedValue([mockPendingResponse])
     [90m     |[39m                                                [31m[1m^[22m[39m
     [90m 360 |[39m         [33m;[39m(responseService[33m.[39mcreatePlannedResponse [36mas[39m jest[33m.[39m[33mMock[39m)[33m.[39mmockRejectedValue([36mnew[39m [33mError[39m([32m'Server error'[39m))
     [90m 361 |[39m         [33m;[39m(offlineDB[33m.[39mupdateSyncQueueItem [36mas[39m jest[33m.[39m[33mMock[39m)[33m.[39mmockResolvedValue([35m1[39m)
     [90m 362 |[39m[0m

      at Object.mockResolvedValue (tests/unit/services/response-planning.test.ts:359:48)

  ‚óè Response Planning Service ‚Ä∫ ResponseOfflineService ‚Ä∫ Conflict Checking ‚Ä∫ should check conflicts online and fallback to offline

    ReferenceError: responseService is not defined

    [0m [90m 385 |[39m           conflictingResponses[33m:[39m []
     [90m 386 |[39m         }
    [31m[1m>[22m[39m[90m 387 |[39m         [33m;[39m(responseService[33m.[39mcheckAssessmentConflicts [36mas[39m jest[33m.[39m[33mMock[39m)[33m.[39mmockResolvedValue(mockOnlineResult)
     [90m     |[39m           [31m[1m^[22m[39m
     [90m 388 |[39m
     [90m 389 |[39m         [36mconst[39m result [33m=[39m [36mawait[39m responseOfflineService[33m.[39mcheckAssessmentConflicts(mockAssessmentId)
     [90m 390 |[39m         expect(result)[33m.[39mtoEqual(mockOnlineResult)[0m

      at Object.responseService (tests/unit/services/response-planning.test.ts:387:11)

FAIL tests/integration/dashboard/crisis-conflicts.test.ts
  ‚óè Crisis Dashboard Conflict Integration ‚Ä∫ should handle full conflict lifecycle

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/integration/dashboard/crisis-conflicts.test.ts:80:21)

  ‚óè Crisis Dashboard Conflict Integration ‚Ä∫ should handle empty conflict state

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/integration/dashboard/crisis-conflicts.test.ts:174:21)

  ‚óè Crisis Dashboard Conflict Integration ‚Ä∫ should handle date range filtering

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/integration/dashboard/crisis-conflicts.test.ts:229:31)

  ‚óè Crisis Dashboard Conflict Integration ‚Ä∫ should handle concurrent API requests

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at tests/integration/dashboard/crisis-conflicts.test.ts:265:11
          at Function.from (<anonymous>)
      at Object.from (tests/integration/dashboard/crisis-conflicts.test.ts:264:28)

  ‚óè Crisis Dashboard Conflict Integration ‚Ä∫ should handle malformed query parameters gracefully

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/integration/dashboard/crisis-conflicts.test.ts:288:30)

FAIL tests/integration/api/sync/batch.test.ts
  ‚óè /api/v1/sync/batch ‚Ä∫ POST ‚Ä∫ should process empty batch successfully

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/integration/api/sync/batch.test.ts:14:23)

  ‚óè /api/v1/sync/batch ‚Ä∫ POST ‚Ä∫ should validate request schema

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/integration/api/sync/batch.test.ts:30:23)

  ‚óè /api/v1/sync/batch ‚Ä∫ POST ‚Ä∫ should reject batch size over limit

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/integration/api/sync/batch.test.ts:55:23)

  ‚óè /api/v1/sync/batch ‚Ä∫ POST ‚Ä∫ should process valid sync changes

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/integration/api/sync/batch.test.ts:98:23)

  ‚óè /api/v1/sync/batch ‚Ä∫ POST ‚Ä∫ should handle different change types

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/integration/api/sync/batch.test.ts:146:23)

  ‚óè /api/v1/sync/batch ‚Ä∫ POST ‚Ä∫ should validate individual change objects

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/integration/api/sync/batch.test.ts:172:23)

  ‚óè /api/v1/sync/batch ‚Ä∫ POST ‚Ä∫ should handle missing required fields

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/integration/api/sync/batch.test.ts:197:23)

  ‚óè /api/v1/sync/batch ‚Ä∫ POST ‚Ä∫ should handle malformed JSON

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/integration/api/sync/batch.test.ts:218:23)

  ‚óè /api/v1/sync/batch ‚Ä∫ POST ‚Ä∫ should include conflict data in conflict responses

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/integration/api/sync/batch.test.ts:248:25)

  ‚óè /api/v1/sync/batch ‚Ä∫ POST ‚Ä∫ should generate unique server IDs for successful syncs

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/integration/api/sync/batch.test.ts:289:23)

  ‚óè /api/v1/sync/batch ‚Ä∫ POST ‚Ä∫ should preserve offlineId in responses

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/integration/api/sync/batch.test.ts:327:23)

  ‚óè /api/v1/sync/batch ‚Ä∫ POST ‚Ä∫ should handle changes without offlineId

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/integration/api/sync/batch.test.ts:354:23)

FAIL tests/unit/api/sync/conflicts.test.ts
  ‚óè /api/v1/sync/conflicts ‚Ä∫ GET /api/v1/sync/conflicts ‚Ä∫ should return paginated conflicts with default parameters

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at createMockRequest (tests/unit/api/sync/conflicts.test.ts:19:10)
      at Object.createMockRequest (tests/unit/api/sync/conflicts.test.ts:54:23)

  ‚óè /api/v1/sync/conflicts ‚Ä∫ GET /api/v1/sync/conflicts ‚Ä∫ should filter conflicts by entity type

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at createMockRequest (tests/unit/api/sync/conflicts.test.ts:19:10)
      at Object.createMockRequest (tests/unit/api/sync/conflicts.test.ts:95:23)

  ‚óè /api/v1/sync/conflicts ‚Ä∫ GET /api/v1/sync/conflicts ‚Ä∫ should filter conflicts by resolution status

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at createMockRequest (tests/unit/api/sync/conflicts.test.ts:19:10)
      at Object.createMockRequest (tests/unit/api/sync/conflicts.test.ts:130:23)

  ‚óè /api/v1/sync/conflicts ‚Ä∫ GET /api/v1/sync/conflicts ‚Ä∫ should handle pagination correctly

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at createMockRequest (tests/unit/api/sync/conflicts.test.ts:19:10)
      at Object.createMockRequest (tests/unit/api/sync/conflicts.test.ts:162:23)

  ‚óè /api/v1/sync/conflicts ‚Ä∫ GET /api/v1/sync/conflicts ‚Ä∫ should handle errors gracefully

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at createMockRequest (tests/unit/api/sync/conflicts.test.ts:19:10)
      at Object.createMockRequest (tests/unit/api/sync/conflicts.test.ts:182:23)

  ‚óè /api/v1/sync/conflicts ‚Ä∫ GET /api/v1/sync/conflicts/export ‚Ä∫ should export conflicts as CSV

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at createMockRequest (tests/unit/api/sync/conflicts.test.ts:19:10)
      at Object.createMockRequest (tests/unit/api/sync/conflicts.test.ts:220:23)

  ‚óè /api/v1/sync/conflicts ‚Ä∫ GET /api/v1/sync/conflicts/export ‚Ä∫ should apply filters to export

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at createMockRequest (tests/unit/api/sync/conflicts.test.ts:19:10)
      at Object.createMockRequest (tests/unit/api/sync/conflicts.test.ts:258:23)

  ‚óè /api/v1/sync/conflicts ‚Ä∫ GET /api/v1/sync/conflicts/export ‚Ä∫ should handle export errors

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at createMockRequest (tests/unit/api/sync/conflicts.test.ts:19:10)
      at Object.createMockRequest (tests/unit/api/sync/conflicts.test.ts:270:23)

  ‚óè /api/v1/sync/conflicts ‚Ä∫ GET /api/v1/sync/conflicts/summary ‚Ä∫ should return conflict summary statistics

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at createMockRequest (tests/unit/api/sync/conflicts.test.ts:19:10)
      at Object.createMockRequest (tests/unit/api/sync/conflicts.test.ts:316:23)

  ‚óè /api/v1/sync/conflicts ‚Ä∫ GET /api/v1/sync/conflicts/summary ‚Ä∫ should handle zero conflicts

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at createMockRequest (tests/unit/api/sync/conflicts.test.ts:19:10)
      at Object.createMockRequest (tests/unit/api/sync/conflicts.test.ts:364:23)

  ‚óè /api/v1/sync/conflicts ‚Ä∫ GET /api/v1/sync/conflicts/summary ‚Ä∫ should handle summary errors

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at createMockRequest (tests/unit/api/sync/conflicts.test.ts:19:10)
      at Object.createMockRequest (tests/unit/api/sync/conflicts.test.ts:377:23)

FAIL tests/unit/sync/engine.test.ts
  ‚óè SyncEngine ‚Ä∫ connectivity detection ‚Ä∫ should detect offline status

    expect(received).toBe(expected) // Object.is equality

    Expected: false
    Received: true

    [0m [90m 66 |[39m       [36mconst[39m offlineEngine [33m=[39m [33mSyncEngine[39m[33m.[39mgetInstance()[33m;[39m
     [90m 67 |[39m       [36mconst[39m status [33m=[39m offlineEngine[33m.[39mgetConnectivityStatus()[33m;[39m
    [31m[1m>[22m[39m[90m 68 |[39m       expect(status[33m.[39misOnline)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
     [90m    |[39m                               [31m[1m^[22m[39m
     [90m 69 |[39m     })[33m;[39m
     [90m 70 |[39m
     [90m 71 |[39m     it([32m'should notify connectivity changes'[39m[33m,[39m (done) [33m=>[39m {[0m

      at Object.toBe (tests/unit/sync/engine.test.ts:68:31)

  ‚óè SyncEngine ‚Ä∫ sync operations ‚Ä∫ should return empty result when no items to sync

    expect(received).toEqual(expected) // deep equality

    Expected: {"conflicts": [], "failed": [], "successful": [], "totalProcessed": 0}
    Received: null

    [0m [90m 131 |[39m       [36mconst[39m result [33m=[39m [36mawait[39m syncEngine[33m.[39mtriggerSync()[33m;[39m
     [90m 132 |[39m       
    [31m[1m>[22m[39m[90m 133 |[39m       expect(result)[33m.[39mtoEqual({
     [90m     |[39m                      [31m[1m^[22m[39m
     [90m 134 |[39m         successful[33m:[39m [][33m,[39m
     [90m 135 |[39m         conflicts[33m:[39m [][33m,[39m
     [90m 136 |[39m         failed[33m:[39m [][33m,[39m[0m

      at Object.toEqual (tests/unit/sync/engine.test.ts:133:22)

  ‚óè SyncEngine ‚Ä∫ sync operations ‚Ä∫ should process successful sync

    expect(received).toEqual(expected) // deep equality

    Expected: {"conflicts": [], "failed": [], "successful": [{"message": "Synced successfully", "offlineId": "item1", "serverId": "server1", "status": "success"}], "totalProcessed": 1}
    Received: null

    [0m [90m 156 |[39m       [36mconst[39m result [33m=[39m [36mawait[39m syncEngine[33m.[39mtriggerSync()[33m;[39m
     [90m 157 |[39m
    [31m[1m>[22m[39m[90m 158 |[39m       expect(result)[33m.[39mtoEqual({
     [90m     |[39m                      [31m[1m^[22m[39m
     [90m 159 |[39m         successful[33m:[39m mockResponse[33m,[39m
     [90m 160 |[39m         conflicts[33m:[39m [][33m,[39m
     [90m 161 |[39m         failed[33m:[39m [][33m,[39m[0m

      at Object.toEqual (tests/unit/sync/engine.test.ts:158:22)

  ‚óè SyncEngine ‚Ä∫ sync operations ‚Ä∫ should handle sync conflicts

    expect(received).toEqual(expected) // deep equality

    Expected: {"conflicts": [{"conflictData": {"id": "1", "value": "server_value", "version": 2}, "message": "Conflict detected", "offlineId": "item1", "serverId": "server1", "status": "conflict"}], "failed": [], "successful": [], "totalProcessed": 1}
    Received: null

    [0m [90m 184 |[39m       [36mconst[39m result [33m=[39m [36mawait[39m syncEngine[33m.[39mtriggerSync()[33m;[39m
     [90m 185 |[39m
    [31m[1m>[22m[39m[90m 186 |[39m       expect(result)[33m.[39mtoEqual({
     [90m     |[39m                      [31m[1m^[22m[39m
     [90m 187 |[39m         successful[33m:[39m [][33m,[39m
     [90m 188 |[39m         conflicts[33m:[39m mockResponse[33m,[39m
     [90m 189 |[39m         failed[33m:[39m [][33m,[39m[0m

      at Object.toEqual (tests/unit/sync/engine.test.ts:186:22)

  ‚óè SyncEngine ‚Ä∫ sync operations ‚Ä∫ should handle sync failures with retry

    expect(received).toEqual(expected) // deep equality

    Expected: {"conflicts": [], "failed": [{"message": "Server error", "offlineId": "item1", "serverId": "", "status": "failed"}], "successful": [], "totalProcessed": 1}
    Received: null

    [0m [90m 212 |[39m       [36mconst[39m result [33m=[39m [36mawait[39m syncEngine[33m.[39mtriggerSync()[33m;[39m
     [90m 213 |[39m
    [31m[1m>[22m[39m[90m 214 |[39m       expect(result)[33m.[39mtoEqual({
     [90m     |[39m                      [31m[1m^[22m[39m
     [90m 215 |[39m         successful[33m:[39m [][33m,[39m
     [90m 216 |[39m         conflicts[33m:[39m [][33m,[39m
     [90m 217 |[39m         failed[33m:[39m mockResponse[33m,[39m[0m

      at Object.toEqual (tests/unit/sync/engine.test.ts:214:22)

  ‚óè SyncEngine ‚Ä∫ sync operations ‚Ä∫ should handle network errors

    expect(received).toEqual(expected) // deep equality

    Expected: {"conflicts": [], "failed": [{"message": "Network error", "offlineId": "item1", "serverId": "", "status": "failed"}], "successful": [], "totalProcessed": 1}
    Received: null

    [0m [90m 235 |[39m       [36mconst[39m result [33m=[39m [36mawait[39m syncEngine[33m.[39mtriggerSync()[33m;[39m
     [90m 236 |[39m
    [31m[1m>[22m[39m[90m 237 |[39m       expect(result)[33m.[39mtoEqual({
     [90m     |[39m                      [31m[1m^[22m[39m
     [90m 238 |[39m         successful[33m:[39m [][33m,[39m
     [90m 239 |[39m         conflicts[33m:[39m [][33m,[39m
     [90m 240 |[39m         failed[33m:[39m [[0m

      at Object.toEqual (tests/unit/sync/engine.test.ts:237:22)

  ‚óè SyncEngine ‚Ä∫ sync operations ‚Ä∫ should respect max batch size

    expect(received).toBe(expected) // Object.is equality

    Expected: 100
    Received: undefined

    [0m [90m 275 |[39m       [36mconst[39m result [33m=[39m [36mawait[39m syncEngine[33m.[39mtriggerSync()[33m;[39m
     [90m 276 |[39m
    [31m[1m>[22m[39m[90m 277 |[39m       expect(result[33m?[39m[33m.[39mtotalProcessed)[33m.[39mtoBe([35m100[39m)[33m;[39m
     [90m     |[39m                                      [31m[1m^[22m[39m
     [90m 278 |[39m       expect(mockFetch)[33m.[39mtoHaveBeenCalledWith(
     [90m 279 |[39m         [32m'/api/v1/sync/batch'[39m[33m,[39m
     [90m 280 |[39m         expect[33m.[39mobjectContaining({[0m

      at Object.toBe (tests/unit/sync/engine.test.ts:277:38)

  ‚óè SyncEngine ‚Ä∫ queue management ‚Ä∫ should add items to sync queue

    TypeError: crypto.randomUUID is not a function

    [0m [90m 498 |[39m   )[33m:[39m [33mPromise[39m[33m<[39m[36mvoid[39m[33m>[39m {
     [90m 499 |[39m     [36mawait[39m offlineDB[33m.[39maddToSyncQueue({
    [31m[1m>[22m[39m[90m 500 |[39m       uuid[33m:[39m crypto[33m.[39mrandomUUID()[33m,[39m
     [90m     |[39m                    [31m[1m^[22m[39m
     [90m 501 |[39m       type[33m,[39m
     [90m 502 |[39m       action[33m,[39m
     [90m 503 |[39m       entityUuid[33m,[39m[0m

      at SyncEngine.randomUUID (src/lib/sync/engine.ts:500:20)
      at Object.addToQueue (tests/unit/sync/engine.test.ts:292:24)

  ‚óè SyncEngine ‚Ä∫ queue management ‚Ä∫ should trigger background sync when adding to queue

    TypeError: crypto.randomUUID is not a function

    [0m [90m 498 |[39m   )[33m:[39m [33mPromise[39m[33m<[39m[36mvoid[39m[33m>[39m {
     [90m 499 |[39m     [36mawait[39m offlineDB[33m.[39maddToSyncQueue({
    [31m[1m>[22m[39m[90m 500 |[39m       uuid[33m:[39m crypto[33m.[39mrandomUUID()[33m,[39m
     [90m     |[39m                    [31m[1m^[22m[39m
     [90m 501 |[39m       type[33m,[39m
     [90m 502 |[39m       action[33m,[39m
     [90m 503 |[39m       entityUuid[33m,[39m[0m

      at SyncEngine.randomUUID (src/lib/sync/engine.ts:500:20)
      at Object.addToQueue (tests/unit/sync/engine.test.ts:308:24)

  ‚óè SyncEngine ‚Ä∫ queue management ‚Ä∫ should get queue status

    expect(received).toEqual(expected) // deep equality

    - Expected  - 1
    + Received  + 1

      Object {
        "failedItems": 1,
    -   "isOnline": true,
    +   "isOnline": false,
        "oldestItem": 2024-01-01T00:00:00.000Z,
        "pendingItems": 1,
        "syncInProgress": false,
        "totalItems": 2,
      }

    [0m [90m 335 |[39m       [36mconst[39m status [33m=[39m [36mawait[39m syncEngine[33m.[39mgetQueueStatus()[33m;[39m
     [90m 336 |[39m
    [31m[1m>[22m[39m[90m 337 |[39m       expect(status)[33m.[39mtoEqual({
     [90m     |[39m                      [31m[1m^[22m[39m
     [90m 338 |[39m         totalItems[33m:[39m [35m2[39m[33m,[39m
     [90m 339 |[39m         pendingItems[33m:[39m [35m1[39m[33m,[39m [90m// Only item1 (attempts < 3)[39m
     [90m 340 |[39m         failedItems[33m:[39m [35m1[39m[33m,[39m  [90m// Only item2 (attempts >= 3)[39m[0m

      at Object.toEqual (tests/unit/sync/engine.test.ts:337:22)

  ‚óè SyncEngine ‚Ä∫ queue management ‚Ä∫ should retry failed items

    expect(jest.fn()).toHaveBeenCalled()

    Expected number of calls: >= 1
    Received number of calls:    0

    [0m [90m 375 |[39m       [36mawait[39m syncEngine[33m.[39mretryFailedItems()[33m;[39m
     [90m 376 |[39m
    [31m[1m>[22m[39m[90m 377 |[39m       expect(triggerSyncSpy)[33m.[39mtoHaveBeenCalled()[33m;[39m
     [90m     |[39m                              [31m[1m^[22m[39m
     [90m 378 |[39m     })[33m;[39m
     [90m 379 |[39m   })[33m;[39m
     [90m 380 |[39m[0m

      at Object.toHaveBeenCalled (tests/unit/sync/engine.test.ts:377:30)

  ‚óè SyncEngine ‚Ä∫ retry logic ‚Ä∫ should implement exponential backoff

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "item1", ObjectContaining {"attempts": 2, "nextRetry": Any<Date>}

    Number of calls: 0

    [0m [90m 410 |[39m       [36mawait[39m syncEngine[33m.[39mtriggerSync()[33m;[39m
     [90m 411 |[39m
    [31m[1m>[22m[39m[90m 412 |[39m       expect(offlineDB[33m.[39mupdateSyncQueueItem)[33m.[39mtoHaveBeenCalledWith(
     [90m     |[39m                                             [31m[1m^[22m[39m
     [90m 413 |[39m         [32m'item1'[39m[33m,[39m
     [90m 414 |[39m         expect[33m.[39mobjectContaining({
     [90m 415 |[39m           attempts[33m:[39m [35m2[39m[33m,[39m[0m

      at Object.toHaveBeenCalledWith (tests/unit/sync/engine.test.ts:412:45)

  ‚óè SyncEngine ‚Ä∫ retry logic ‚Ä∫ should give up after max retries

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "item1"

    Number of calls: 0

    [0m [90m 449 |[39m       [36mawait[39m syncEngine[33m.[39mtriggerSync()[33m;[39m
     [90m 450 |[39m
    [31m[1m>[22m[39m[90m 451 |[39m       expect(offlineDB[33m.[39mremoveSyncQueueItem)[33m.[39mtoHaveBeenCalledWith([32m'item1'[39m)[33m;[39m
     [90m     |[39m                                             [31m[1m^[22m[39m
     [90m 452 |[39m     })[33m;[39m
     [90m 453 |[39m   })[33m;[39m
     [90m 454 |[39m[0m

      at Object.toHaveBeenCalledWith (tests/unit/sync/engine.test.ts:451:45)

  ‚óè SyncEngine ‚Ä∫ error handling ‚Ä∫ should handle malformed server responses

    expect(received).toHaveLength(expected)

    Matcher error: received value must have a length property whose value must be a number

    Received has value: undefined

    [0m [90m 475 |[39m       [36mconst[39m result [33m=[39m [36mawait[39m syncEngine[33m.[39mtriggerSync()[33m;[39m
     [90m 476 |[39m
    [31m[1m>[22m[39m[90m 477 |[39m       expect(result[33m?[39m[33m.[39mfailed)[33m.[39mtoHaveLength([35m1[39m)[33m;[39m
     [90m     |[39m                              [31m[1m^[22m[39m
     [90m 478 |[39m       expect(result[33m?[39m[33m.[39mfailed[[35m0[39m][33m.[39mmessage)[33m.[39mtoContain([32m'Invalid JSON'[39m)[33m;[39m
     [90m 479 |[39m     })[33m;[39m
     [90m 480 |[39m[0m

      at Object.toHaveLength (tests/unit/sync/engine.test.ts:477:30)

  ‚óè SyncEngine ‚Ä∫ error handling ‚Ä∫ should handle HTTP error responses

    expect(received).toHaveLength(expected)

    Matcher error: received value must have a length property whose value must be a number

    Received has value: undefined

    [0m [90m 488 |[39m       [36mconst[39m result [33m=[39m [36mawait[39m syncEngine[33m.[39mtriggerSync()[33m;[39m
     [90m 489 |[39m
    [31m[1m>[22m[39m[90m 490 |[39m       expect(result[33m?[39m[33m.[39mfailed)[33m.[39mtoHaveLength([35m1[39m)[33m;[39m
     [90m     |[39m                              [31m[1m^[22m[39m
     [90m 491 |[39m       expect(result[33m?[39m[33m.[39mfailed[[35m0[39m][33m.[39mmessage)[33m.[39mtoContain([32m'500'[39m)[33m;[39m
     [90m 492 |[39m     })[33m;[39m
     [90m 493 |[39m   })[33m;[39m[0m

      at Object.toHaveLength (tests/unit/sync/engine.test.ts:490:30)

FAIL tests/unit/services/auto-assignment.test.ts
  ‚óè AutoAssignmentService ‚Ä∫ bulkAutoAssignOnEntityCreation ‚Ä∫ should auto-assign creator when they have appropriate roles

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "creator123", "entity123", "RESPONDER", "creator123"
    Received: "creator123", "entity123", "ASSESSOR", "creator123"

    Number of calls: 1

    [0m [90m 343 |[39m
     [90m 344 |[39m       expect(autoAssignSpy)[33m.[39mtoHaveBeenCalledWith([32m'creator123'[39m[33m,[39m [32m'entity123'[39m[33m,[39m [32m'ASSESSOR'[39m[33m,[39m [32m'creator123'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 345 |[39m       expect(autoAssignSpy)[33m.[39mtoHaveBeenCalledWith([32m'creator123'[39m[33m,[39m [32m'entity123'[39m[33m,[39m [32m'RESPONDER'[39m[33m,[39m [32m'creator123'[39m)[33m;[39m
     [90m     |[39m                             [31m[1m^[22m[39m
     [90m 346 |[39m
     [90m 347 |[39m       autoAssignSpy[33m.[39mmockRestore()[33m;[39m
     [90m 348 |[39m     })[33m;[39m[0m

      at Object.toHaveBeenCalledWith (tests/unit/services/auto-assignment.test.ts:345:29)

FAIL tests/integration/assignments/assignment-workflow.test.ts
  ‚óè Assignment Workflow Integration Tests ‚Ä∫ Complete Assignment Creation Workflow ‚Ä∫ should create assignment and trigger auto-assignment

    TypeError: Cannot read properties of undefined (reading 'findUnique')

    [0m [90m 67 |[39m       [90m// Mock Prisma operations for assignment creation[39m
     [90m 68 |[39m       [36mconst[39m mockPrisma [33m=[39m require([32m'@/lib/db/client'[39m)[33m.[39mprisma[33m;[39m
    [31m[1m>[22m[39m[90m 69 |[39m       mockPrisma[33m.[39muser[33m.[39mfindUnique[33m.[39mmockResolvedValue(mockAssessor)[33m;[39m
     [90m    |[39m                       [31m[1m^[22m[39m
     [90m 70 |[39m       mockPrisma[33m.[39mentity[33m.[39mfindUnique[33m.[39mmockResolvedValue(mockEntity)[33m;[39m
     [90m 71 |[39m       mockPrisma[33m.[39mentityAssignment[33m.[39mfindUnique[33m.[39mmockResolvedValue([36mnull[39m)[33m;[39m
     [90m 72 |[39m       mockPrisma[33m.[39mentityAssignment[33m.[39mcreate[33m.[39mmockResolvedValue(mockAssignment)[33m;[39m[0m

      at Object.findUnique (tests/integration/assignments/assignment-workflow.test.ts:69:23)

  ‚óè Assignment Workflow Integration Tests ‚Ä∫ Complete Assignment Creation Workflow ‚Ä∫ should handle bulk assignment with collaboration tracking

    TypeError: Cannot read properties of undefined (reading 'findMany')

    [0m [90m 126 |[39m
     [90m 127 |[39m       [36mconst[39m mockPrisma [33m=[39m require([32m'@/lib/db/client'[39m)[33m.[39mprisma[33m;[39m
    [31m[1m>[22m[39m[90m 128 |[39m       mockPrisma[33m.[39muser[33m.[39mfindMany[33m.[39mmockResolvedValue([mockAssessor[33m,[39m mockResponder])[33m;[39m
     [90m     |[39m                       [31m[1m^[22m[39m
     [90m 129 |[39m       mockPrisma[33m.[39mentity[33m.[39mfindMany[33m.[39mmockResolvedValue([mockEntity])[33m;[39m
     [90m 130 |[39m       mockPrisma[33m.[39mentityAssignment[33m.[39mfindMany[33m.[39mmockResolvedValue([])[33m;[39m
     [90m 131 |[39m       mockPrisma[33m.[39m$transaction[33m.[39mmockResolvedValue(mockBulkAssignments)[33m;[39m[0m

      at Object.findMany (tests/integration/assignments/assignment-workflow.test.ts:128:23)

  ‚óè Assignment Workflow Integration Tests ‚Ä∫ Error Handling and Edge Cases ‚Ä∫ should handle auto-assignment rule configuration

    expect(received).toBe(expected) // Object.is equality

    Expected: false
    Received: undefined

    [0m [90m 241 |[39m       })[33m;[39m
     [90m 242 |[39m
    [31m[1m>[22m[39m[90m 243 |[39m       expect([33mAutoAssignmentService[39m[33m.[39misAutoAssignmentEnabled([32m'COMMUNITY'[39m[33m,[39m [32m'ASSESSOR'[39m))[33m.[39mtoBe([36mfalse[39m)[33m;[39m
     [90m     |[39m                                                                                      [31m[1m^[22m[39m
     [90m 244 |[39m
     [90m 245 |[39m       [90m// Re-enable auto-assignment[39m
     [90m 246 |[39m       [33mAutoAssignmentService[39m[33m.[39mupdateConfig({[0m

      at Object.toBe (tests/integration/assignments/assignment-workflow.test.ts:243:86)

  ‚óè Assignment Workflow Integration Tests ‚Ä∫ Performance and Scalability ‚Ä∫ should handle large bulk assignments efficiently

    TypeError: Cannot read properties of undefined (reading 'findMany')

    [0m [90m 294 |[39m
     [90m 295 |[39m       [36mconst[39m mockPrisma [33m=[39m require([32m'@/lib/db/client'[39m)[33m.[39mprisma[33m;[39m
    [31m[1m>[22m[39m[90m 296 |[39m       mockPrisma[33m.[39muser[33m.[39mfindMany[33m.[39mmockResolvedValue(largeUserList)[33m;[39m
     [90m     |[39m                       [31m[1m^[22m[39m
     [90m 297 |[39m       mockPrisma[33m.[39mentity[33m.[39mfindMany[33m.[39mmockResolvedValue(largeEntityList)[33m;[39m
     [90m 298 |[39m       mockPrisma[33m.[39mentityAssignment[33m.[39mfindMany[33m.[39mmockResolvedValue([])[33m;[39m
     [90m 299 |[39m[0m

      at Object.findMany (tests/integration/assignments/assignment-workflow.test.ts:296:23)

  ‚óè Assignment Workflow Integration Tests ‚Ä∫ Data Consistency and Validation ‚Ä∫ should maintain data consistency during concurrent operations

    TypeError: Cannot read properties of undefined (reading 'findUnique')

    [0m [90m 380 |[39m       
     [90m 381 |[39m       [90m// First request succeeds[39m
    [31m[1m>[22m[39m[90m 382 |[39m       mockPrisma[33m.[39mentityAssignment[33m.[39mfindUnique
     [90m     |[39m                                   [31m[1m^[22m[39m
     [90m 383 |[39m         [33m.[39mmockResolvedValueOnce([36mnull[39m) [90m// No existing assignment[39m
     [90m 384 |[39m         [33m.[39mmockResolvedValueOnce(mockAssignment)[33m;[39m [90m// Assignment exists on second check[39m
     [90m 385 |[39m[0m

      at Object.findUnique (tests/integration/assignments/assignment-workflow.test.ts:382:35)

  ‚óè Assignment Workflow Integration Tests ‚Ä∫ Data Consistency and Validation ‚Ä∫ should validate role-based access throughout workflow

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/integration/assignments/assignment-workflow.test.ts:435:23)

FAIL tests/integration/auth/endpoints.test.ts
  ‚óè Authentication API Endpoints ‚Ä∫ POST /api/v1/auth/login ‚Ä∫ should authenticate user successfully

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/integration/auth/endpoints.test.ts:46:23)

  ‚óè Authentication API Endpoints ‚Ä∫ POST /api/v1/auth/login ‚Ä∫ should return 400 for invalid input

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/integration/auth/endpoints.test.ts:67:23)

  ‚óè Authentication API Endpoints ‚Ä∫ POST /api/v1/auth/login ‚Ä∫ should return 401 for invalid credentials

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/integration/auth/endpoints.test.ts:89:23)

  ‚óè Authentication API Endpoints ‚Ä∫ POST /api/v1/auth/login ‚Ä∫ should handle account locked error

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/integration/auth/endpoints.test.ts:110:23)

  ‚óè Authentication API Endpoints ‚Ä∫ GET /api/v1/auth/me ‚Ä∫ should return current user data

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/integration/auth/endpoints.test.ts:157:23)

  ‚óè Authentication API Endpoints ‚Ä∫ GET /api/v1/auth/me ‚Ä∫ should return 401 for missing token

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/integration/auth/endpoints.test.ts:173:23)

  ‚óè Authentication API Endpoints ‚Ä∫ GET /api/v1/auth/me ‚Ä∫ should return 401 for invalid token

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/integration/auth/endpoints.test.ts:189:23)

  ‚óè Authentication API Endpoints ‚Ä∫ POST /api/v1/auth/refresh ‚Ä∫ should refresh token successfully

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/integration/auth/endpoints.test.ts:217:23)

  ‚óè Authentication API Endpoints ‚Ä∫ POST /api/v1/auth/refresh ‚Ä∫ should return 401 for expired token

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/integration/auth/endpoints.test.ts:236:23)

FAIL tests/unit/components/EntityAssignmentInterface.test.tsx
  ‚óè Test suite failed to run

    Configuration error:

    Could not locate module @/components/features/assignments/AssignmentTable mapped as:
    B:\Dev\Claude Code\dms-v3-bmad-archon\src\$1.

    Please check your configuration for these entries:
    {
      "moduleNameMapper": {
        "/^@\/(.*)$/": "B:\Dev\Claude Code\dms-v3-bmad-archon\src\$1"
      },
      "resolver": undefined
    }

    [0m [90m 11 |[39m
     [90m 12 |[39m [90m// Mock the child components[39m
    [31m[1m>[22m[39m[90m 13 |[39m jest[33m.[39mmock([32m'@/components/features/assignments/AssignmentTable'[39m[33m,[39m () [33m=>[39m ({
     [90m    |[39m      [31m[1m^[22m[39m
     [90m 14 |[39m   [33mAssignmentTable[39m[33m:[39m ({ assignments[33m,[39m onDeleteAssignment }[33m:[39m any) [33m=>[39m (
     [90m 15 |[39m     [33m<[39m[33mdiv[39m data[33m-[39mtestid[33m=[39m[32m"assignment-table"[39m[33m>[39m
     [90m 16 |[39m       {assignments[33m.[39mmap((assignment[33m:[39m any) [33m=>[39m ([0m

      at createNoMappedModuleFoundError (node_modules/jest-resolve/build/resolver.js:759:17)
      at Object.mock (tests/unit/components/EntityAssignmentInterface.test.tsx:13:6)

FAIL tests/unit/api/entity-assignments.test.ts
  ‚óè Entity Assignment API Endpoints ‚Ä∫ POST /api/v1/entity-assignments ‚Ä∫ should create a new assignment successfully

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/unit/api/entity-assignments.test.ts:97:23)

  ‚óè Entity Assignment API Endpoints ‚Ä∫ POST /api/v1/entity-assignments ‚Ä∫ should reject assignment if user lacks coordinator role

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/unit/api/entity-assignments.test.ts:135:23)

  ‚óè Entity Assignment API Endpoints ‚Ä∫ POST /api/v1/entity-assignments ‚Ä∫ should reject assignment if target user not found

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/unit/api/entity-assignments.test.ts:163:23)

  ‚óè Entity Assignment API Endpoints ‚Ä∫ POST /api/v1/entity-assignments ‚Ä∫ should reject assignment if user lacks appropriate role

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/unit/api/entity-assignments.test.ts:196:23)

  ‚óè Entity Assignment API Endpoints ‚Ä∫ POST /api/v1/entity-assignments ‚Ä∫ should reject assignment if assignment already exists

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/unit/api/entity-assignments.test.ts:226:23)

  ‚óè Entity Assignment API Endpoints ‚Ä∫ GET /api/v1/entity-assignments ‚Ä∫ should fetch assignments with pagination

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/unit/api/entity-assignments.test.ts:258:23)

  ‚óè Entity Assignment API Endpoints ‚Ä∫ DELETE /api/v1/entity-assignments/[id] ‚Ä∫ should delete assignment successfully

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/unit/api/entity-assignments.test.ts:291:9)

  ‚óè Entity Assignment API Endpoints ‚Ä∫ DELETE /api/v1/entity-assignments/[id] ‚Ä∫ should return 404 if assignment not found

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/unit/api/entity-assignments.test.ts:317:9)

  ‚óè Entity Assignment API Endpoints ‚Ä∫ POST /api/v1/entity-assignments/bulk ‚Ä∫ should create bulk assignments successfully

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/unit/api/entity-assignments.test.ts:347:23)

  ‚óè Entity Assignment API Endpoints ‚Ä∫ POST /api/v1/entity-assignments/bulk ‚Ä∫ should handle missing users in bulk assignment

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/unit/api/entity-assignments.test.ts:378:23)

  ‚óè Entity Assignment API Endpoints ‚Ä∫ POST /api/v1/entity-assignments/bulk ‚Ä∫ should skip existing assignments in bulk operation

    TypeError: Cannot set property url of #<NextRequest> which has only a getter

    [0m [90m 271 |[39m   
     [90m 272 |[39m   constructor(url[33m:[39m string[33m,[39m options[33m:[39m any [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 273 |[39m     [36mthis[39m[33m.[39murl [33m=[39m url[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 274 |[39m     [36mthis[39m[33m.[39mmethod [33m=[39m options[33m.[39mmethod [33m||[39m [32m'GET'[39m[33m;[39m
     [90m 275 |[39m     [36mthis[39m[33m.[39mheaders [33m=[39m [36mnew[39m [33mMap[39m()[33m;[39m
     [90m 276 |[39m     [36mif[39m (options[33m.[39mheaders) {[0m

      at new MockRequest (tests/setup.ts:273:13)
      at new NextRequest (node_modules/next/src/server/web/spec-extension/request.ts:29:10)
      at Object.<anonymous> (tests/unit/api/entity-assignments.test.ts:413:23)

FAIL tests/integration/response-planning/api.test.ts
  ‚óè Test suite failed to run

    Cannot find module '../helpers/test-client' from 'tests/integration/response-planning/api.test.ts'

    [0m [90m 4 |[39m
     [90m 5 |[39m describe([32m'Response Planning API Integration'[39m[33m,[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   [36mlet[39m testClient[33m:[39m [33mTestClient[39m
     [90m   |[39m                     [31m[1m^[22m[39m
     [90m 7 |[39m   [36mlet[39m testUserId[33m:[39m string
     [90m 8 |[39m   [36mlet[39m testEntityId[33m:[39m string
     [90m 9 |[39m   [36mlet[39m testAssessmentId[33m:[39m string[0m

      at Resolver._throwModNotFoundError (node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.<anonymous> (tests/integration/response-planning/api.test.ts:6:21)

FAIL tests/integration/rapid-assessments/workflows.test.ts
  ‚óè Test suite failed to run

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     ‚Ä¢ If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     ‚Ä¢ If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     ‚Ä¢ To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     ‚Ä¢ If you need a custom transformation specify a "transform" option in your config.
     ‚Ä¢ If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\uuid\dist\index.js:1
    ({"Object.<anonymous>":function(module,exports,require,__dirname,__filename,jest){export { default as MAX } from './max.js';
                                                                                      ^^^^^^

    SyntaxError: Unexpected token 'export'

    [0m[0m

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at Object.<anonymous> (src/app/api/v1/rapid-assessments/route.ts:1041:27)
      at Object.<anonymous> (tests/integration/rapid-assessments/workflows.test.ts:22:16)

FAIL tests/unit/components/PreliminaryAssessmentForm.test.tsx
  ‚óè Test suite failed to run

    Cannot find module '@testing-library/user-event' from 'tests/unit/components/PreliminaryAssessmentForm.test.tsx'

    [0m [90m 29 |[39m     user[33m:[39m {
     [90m 30 |[39m       id[33m:[39m [32m'test-user'[39m[33m,[39m
    [31m[1m>[22m[39m[90m 31 |[39m       name[33m:[39m [32m'Test User'[39m[33m,[39m
     [90m    |[39m                                                       [31m[1m^[22m[39m
     [90m 32 |[39m       email[33m:[39m [32m'test@example.com'[39m[33m,[39m
     [90m 33 |[39m     }[33m,[39m
     [90m 34 |[39m   })[33m,[39m[0m

      at Resolver._throwModNotFoundError (node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.<anonymous> (tests/unit/components/PreliminaryAssessmentForm.test.tsx:31:59)

FAIL tests/integration/assessments/preliminary-assessment-workflow.test.ts
  ‚óè Test suite failed to run

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     ‚Ä¢ If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     ‚Ä¢ If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     ‚Ä¢ To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     ‚Ä¢ If you need a custom transformation specify a "transform" option in your config.
     ‚Ä¢ If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\uuid\dist\index.js:1
    ({"Object.<anonymous>":function(module,exports,require,__dirname,__filename,jest){export { default as MAX } from './max.js';
                                                                                      ^^^^^^

    SyntaxError: Unexpected token 'export'

    [0m[0m

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at Object.<anonymous> (src/app/api/v1/preliminary-assessments/route.ts:349:27)
      at Object.<anonymous> (tests/integration/assessments/preliminary-assessment-workflow.test.ts:7:16)

FAIL tests/integration/auth/role-switching.test.ts
  ‚óè Test suite failed to run

    Cannot find module 'supertest' from 'tests/integration/auth/role-switching.test.ts'

    [0m [90m 3 |[39m [36mimport[39m { app } [36mfrom[39m [32m'next/app'[39m[33m;[39m [90m// Note: This might need adjustment based on your setup[39m
     [90m 4 |[39m
    [31m[1m>[22m[39m[90m 5 |[39m describe([32m'Role Switching Integration Tests'[39m[33m,[39m () [33m=>[39m {
     [90m   |[39m                                                           [31m[1m^[22m[39m
     [90m 6 |[39m   [36mlet[39m authToken[33m:[39m string[33m;[39m
     [90m 7 |[39m   [36mlet[39m userId[33m:[39m string[33m;[39m
     [90m 8 |[39m[0m

      at Resolver._throwModNotFoundError (node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.<anonymous> (tests/integration/auth/role-switching.test.ts:5:59)

FAIL tests/unit/api/rapid-assessment-endpoints.test.ts
  ‚óè Test suite failed to run

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     ‚Ä¢ If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     ‚Ä¢ If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     ‚Ä¢ To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     ‚Ä¢ If you need a custom transformation specify a "transform" option in your config.
     ‚Ä¢ If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    B:\Dev\Claude Code\dms-v3-bmad-archon\node_modules\uuid\dist\index.js:1
    ({"Object.<anonymous>":function(module,exports,require,__dirname,__filename,jest){export { default as MAX } from './max.js';
                                                                                      ^^^^^^

    SyntaxError: Unexpected token 'export'

    [0m[0m

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at Object.<anonymous> (src/app/api/v1/rapid-assessments/route.ts:1041:27)
      at Object.<anonymous> (tests/unit/api/rapid-assessment-endpoints.test.ts:23:16)

FAIL tests/unit/forms/health-assessment-form.test.tsx
  ‚óè Test suite failed to run

    Cannot find module '@testing-library/user-event' from 'tests/unit/forms/health-assessment-form.test.tsx'

    [0m [90m 69 |[39m   jest[33m.[39mclearAllMocks()
     [90m 70 |[39m })
    [31m[1m>[22m[39m[90m 71 |[39m
     [90m    |[39m [31m[1m^[22m[39m
     [90m 72 |[39m describe([32m'HealthAssessmentForm'[39m[33m,[39m () [33m=>[39m {
     [90m 73 |[39m   [36mconst[39m defaultProps [33m=[39m {
     [90m 74 |[39m     entityId[33m:[39m [32m'entity-1'[39m[33m,[39m[0m

      at Resolver._throwModNotFoundError (node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.<anonymous> (tests/unit/forms/health-assessment-form.test.tsx:71:59)

FAIL tests/unit/components/ResponsePlanningForm.test.tsx
  ‚óè ResponsePlanningForm Component ‚Ä∫ Form Rendering ‚Ä∫ should render all form fields in create mode

    TypeError: mockUseOffline.mockReturnValue is not a function

    [0m [90m 79 |[39m
     [90m 80 |[39m     [90m// Setup default offline mock[39m
    [31m[1m>[22m[39m[90m 81 |[39m     mockUseOffline[33m.[39mmockReturnValue({
     [90m    |[39m                    [31m[1m^[22m[39m
     [90m 82 |[39m       isOnline[33m:[39m [36mtrue[39m[33m,[39m
     [90m 83 |[39m       isSyncing[33m:[39m [36mfalse[39m[33m,[39m
     [90m 84 |[39m       syncProgress[33m:[39m [35m0[39m[33m,[39m[0m

      at Object.mockReturnValue (tests/unit/components/ResponsePlanningForm.test.tsx:81:20)

  ‚óè ResponsePlanningForm Component ‚Ä∫ Form Rendering ‚Ä∫ should render in edit mode with correct title

    TypeError: mockUseOffline.mockReturnValue is not a function

    [0m [90m 79 |[39m
     [90m 80 |[39m     [90m// Setup default offline mock[39m
    [31m[1m>[22m[39m[90m 81 |[39m     mockUseOffline[33m.[39mmockReturnValue({
     [90m    |[39m                    [31m[1m^[22m[39m
     [90m 82 |[39m       isOnline[33m:[39m [36mtrue[39m[33m,[39m
     [90m 83 |[39m       isSyncing[33m:[39m [36mfalse[39m[33m,[39m
     [90m 84 |[39m       syncProgress[33m:[39m [35m0[39m[33m,[39m[0m

      at Object.mockReturnValue (tests/unit/components/ResponsePlanningForm.test.tsx:81:20)

  ‚óè ResponsePlanningForm Component ‚Ä∫ Form Rendering ‚Ä∫ should show online status indicators

    TypeError: mockUseOffline.mockReturnValue is not a function

    [0m [90m 79 |[39m
     [90m 80 |[39m     [90m// Setup default offline mock[39m
    [31m[1m>[22m[39m[90m 81 |[39m     mockUseOffline[33m.[39mmockReturnValue({
     [90m    |[39m                    [31m[1m^[22m[39m
     [90m 82 |[39m       isOnline[33m:[39m [36mtrue[39m[33m,[39m
     [90m 83 |[39m       isSyncing[33m:[39m [36mfalse[39m[33m,[39m
     [90m 84 |[39m       syncProgress[33m:[39m [35m0[39m[33m,[39m[0m

      at Object.mockReturnValue (tests/unit/components/ResponsePlanningForm.test.tsx:81:20)

  ‚óè ResponsePlanningForm Component ‚Ä∫ Form Rendering ‚Ä∫ should show offline status indicators

    TypeError: mockUseOffline.mockReturnValue is not a function

    [0m [90m 79 |[39m
     [90m 80 |[39m     [90m// Setup default offline mock[39m
    [31m[1m>[22m[39m[90m 81 |[39m     mockUseOffline[33m.[39mmockReturnValue({
     [90m    |[39m                    [31m[1m^[22m[39m
     [90m 82 |[39m       isOnline[33m:[39m [36mtrue[39m[33m,[39m
     [90m 83 |[39m       isSyncing[33m:[39m [36mfalse[39m[33m,[39m
     [90m 84 |[39m       syncProgress[33m:[39m [35m0[39m[33m,[39m[0m

      at Object.mockReturnValue (tests/unit/components/ResponsePlanningForm.test.tsx:81:20)

  ‚óè ResponsePlanningForm Component ‚Ä∫ Form Rendering ‚Ä∫ should show sync progress when syncing

    TypeError: mockUseOffline.mockReturnValue is not a function

    [0m [90m 79 |[39m
     [90m 80 |[39m     [90m// Setup default offline mock[39m
    [31m[1m>[22m[39m[90m 81 |[39m     mockUseOffline[33m.[39mmockReturnValue({
     [90m    |[39m                    [31m[1m^[22m[39m
     [90m 82 |[39m       isOnline[33m:[39m [36mtrue[39m[33m,[39m
     [90m 83 |[39m       isSyncing[33m:[39m [36mfalse[39m[33m,[39m
     [90m 84 |[39m       syncProgress[33m:[39m [35m0[39m[33m,[39m[0m

      at Object.mockReturnValue (tests/unit/components/ResponsePlanningForm.test.tsx:81:20)

  ‚óè ResponsePlanningForm Component ‚Ä∫ Form Validation ‚Ä∫ should validate required fields

    TypeError: mockUseOffline.mockReturnValue is not a function

    [0m [90m 79 |[39m
     [90m 80 |[39m     [90m// Setup default offline mock[39m
    [31m[1m>[22m[39m[90m 81 |[39m     mockUseOffline[33m.[39mmockReturnValue({
     [90m    |[39m                    [31m[1m^[22m[39m
     [90m 82 |[39m       isOnline[33m:[39m [36mtrue[39m[33m,[39m
     [90m 83 |[39m       isSyncing[33m:[39m [36mfalse[39m[33m,[39m
     [90m 84 |[39m       syncProgress[33m:[39m [35m0[39m[33m,[39m[0m

      at Object.mockReturnValue (tests/unit/components/ResponsePlanningForm.test.tsx:81:20)

  ‚óè ResponsePlanningForm Component ‚Ä∫ Form Validation ‚Ä∫ should validate item fields

    TypeError: mockUseOffline.mockReturnValue is not a function

    [0m [90m 79 |[39m
     [90m 80 |[39m     [90m// Setup default offline mock[39m
    [31m[1m>[22m[39m[90m 81 |[39m     mockUseOffline[33m.[39mmockReturnValue({
     [90m    |[39m                    [31m[1m^[22m[39m
     [90m 82 |[39m       isOnline[33m:[39m [36mtrue[39m[33m,[39m
     [90m 83 |[39m       isSyncing[33m:[39m [36mfalse[39m[33m,[39m
     [90m 84 |[39m       syncProgress[33m:[39m [35m0[39m[33m,[39m[0m

      at Object.mockReturnValue (tests/unit/components/ResponsePlanningForm.test.tsx:81:20)

  ‚óè ResponsePlanningForm Component ‚Ä∫ Form Validation ‚Ä∫ should validate positive quantities

    TypeError: mockUseOffline.mockReturnValue is not a function

    [0m [90m 79 |[39m
     [90m 80 |[39m     [90m// Setup default offline mock[39m
    [31m[1m>[22m[39m[90m 81 |[39m     mockUseOffline[33m.[39mmockReturnValue({
     [90m    |[39m                    [31m[1m^[22m[39m
     [90m 82 |[39m       isOnline[33m:[39m [36mtrue[39m[33m,[39m
     [90m 83 |[39m       isSyncing[33m:[39m [36mfalse[39m[33m,[39m
     [90m 84 |[39m       syncProgress[33m:[39m [35m0[39m[33m,[39m[0m

      at Object.mockReturnValue (tests/unit/components/ResponsePlanningForm.test.tsx:81:20)

  ‚óè ResponsePlanningForm Component ‚Ä∫ Item Management ‚Ä∫ should add new items dynamically

    TypeError: mockUseOffline.mockReturnValue is not a function

    [0m [90m 79 |[39m
     [90m 80 |[39m     [90m// Setup default offline mock[39m
    [31m[1m>[22m[39m[90m 81 |[39m     mockUseOffline[33m.[39mmockReturnValue({
     [90m    |[39m                    [31m[1m^[22m[39m
     [90m 82 |[39m       isOnline[33m:[39m [36mtrue[39m[33m,[39m
     [90m 83 |[39m       isSyncing[33m:[39m [36mfalse[39m[33m,[39m
     [90m 84 |[39m       syncProgress[33m:[39m [35m0[39m[33m,[39m[0m

      at Object.mockReturnValue (tests/unit/components/ResponsePlanningForm.test.tsx:81:20)

  ‚óè ResponsePlanningForm Component ‚Ä∫ Item Management ‚Ä∫ should remove items when there are multiple

    TypeError: mockUseOffline.mockReturnValue is not a function

    [0m [90m 79 |[39m
     [90m 80 |[39m     [90m// Setup default offline mock[39m
    [31m[1m>[22m[39m[90m 81 |[39m     mockUseOffline[33m.[39mmockReturnValue({
     [90m    |[39m                    [31m[1m^[22m[39m
     [90m 82 |[39m       isOnline[33m:[39m [36mtrue[39m[33m,[39m
     [90m 83 |[39m       isSyncing[33m:[39m [36mfalse[39m[33m,[39m
     [90m 84 |[39m       syncProgress[33m:[39m [35m0[39m[33m,[39m[0m

      at Object.mockReturnValue (tests/unit/components/ResponsePlanningForm.test.tsx:81:20)

  ‚óè ResponsePlanningForm Component ‚Ä∫ Item Management ‚Ä∫ should not allow removing the last item

    TypeError: mockUseOffline.mockReturnValue is not a function

    [0m [90m 79 |[39m
     [90m 80 |[39m     [90m// Setup default offline mock[39m
    [31m[1m>[22m[39m[90m 81 |[39m     mockUseOffline[33m.[39mmockReturnValue({
     [90m    |[39m                    [31m[1m^[22m[39m
     [90m 82 |[39m       isOnline[33m:[39m [36mtrue[39m[33m,[39m
     [90m 83 |[39m       isSyncing[33m:[39m [36mfalse[39m[33m,[39m
     [90m 84 |[39m       syncProgress[33m:[39m [35m0[39m[33m,[39m[0m

      at Object.mockReturnValue (tests/unit/components/ResponsePlanningForm.test.tsx:81:20)

  ‚óè ResponsePlanningForm Component ‚Ä∫ Form Submission ‚Ä∫ should submit valid form successfully

    TypeError: mockUseOffline.mockReturnValue is not a function

    [0m [90m 79 |[39m
     [90m 80 |[39m     [90m// Setup default offline mock[39m
    [31m[1m>[22m[39m[90m 81 |[39m     mockUseOffline[33m.[39mmockReturnValue({
     [90m    |[39m                    [31m[1m^[22m[39m
     [90m 82 |[39m       isOnline[33m:[39m [36mtrue[39m[33m,[39m
     [90m 83 |[39m       isSyncing[33m:[39m [36mfalse[39m[33m,[39m
     [90m 84 |[39m       syncProgress[33m:[39m [35m0[39m[33m,[39m[0m

      at Object.mockReturnValue (tests/unit/components/ResponsePlanningForm.test.tsx:81:20)

  ‚óè ResponsePlanningForm Component ‚Ä∫ Form Submission ‚Ä∫ should handle offline submission

    TypeError: mockUseOffline.mockReturnValue is not a function

    [0m [90m 79 |[39m
     [90m 80 |[39m     [90m// Setup default offline mock[39m
    [31m[1m>[22m[39m[90m 81 |[39m     mockUseOffline[33m.[39mmockReturnValue({
     [90m    |[39m                    [31m[1m^[22m[39m
     [90m 82 |[39m       isOnline[33m:[39m [36mtrue[39m[33m,[39m
     [90m 83 |[39m       isSyncing[33m:[39m [36mfalse[39m[33m,[39m
     [90m 84 |[39m       syncProgress[33m:[39m [35m0[39m[33m,[39m[0m

      at Object.mockReturnValue (tests/unit/components/ResponsePlanningForm.test.tsx:81:20)

  ‚óè ResponsePlanningForm Component ‚Ä∫ Form Submission ‚Ä∫ should handle submission errors

    TypeError: mockUseOffline.mockReturnValue is not a function

    [0m [90m 79 |[39m
     [90m 80 |[39m     [90m// Setup default offline mock[39m
    [31m[1m>[22m[39m[90m 81 |[39m     mockUseOffline[33m.[39mmockReturnValue({
     [90m    |[39m                    [31m[1m^[22m[39m
     [90m 82 |[39m       isOnline[33m:[39m [36mtrue[39m[33m,[39m
     [90m 83 |[39m       isSyncing[33m:[39m [36mfalse[39m[33m,[39m
     [90m 84 |[39m       syncProgress[33m:[39m [35m0[39m[33m,[39m[0m

      at Object.mockReturnValue (tests/unit/components/ResponsePlanningForm.test.tsx:81:20)

  ‚óè ResponsePlanningForm Component ‚Ä∫ Collaboration Features ‚Ä∫ should show collaboration status in edit mode

    TypeError: mockUseOffline.mockReturnValue is not a function

    [0m [90m 79 |[39m
     [90m 80 |[39m     [90m// Setup default offline mock[39m
    [31m[1m>[22m[39m[90m 81 |[39m     mockUseOffline[33m.[39mmockReturnValue({
     [90m    |[39m                    [31m[1m^[22m[39m
     [90m 82 |[39m       isOnline[33m:[39m [36mtrue[39m[33m,[39m
     [90m 83 |[39m       isSyncing[33m:[39m [36mfalse[39m[33m,[39m
     [90m 84 |[39m       syncProgress[33m:[39m [35m0[39m[33m,[39m[0m

      at Object.mockReturnValue (tests/unit/components/ResponsePlanningForm.test.tsx:81:20)

  ‚óè ResponsePlanningForm Component ‚Ä∫ Cancel Behavior ‚Ä∫ should call onCancel when cancel button is clicked

    TypeError: mockUseOffline.mockReturnValue is not a function

    [0m [90m 79 |[39m
     [90m 80 |[39m     [90m// Setup default offline mock[39m
    [31m[1m>[22m[39m[90m 81 |[39m     mockUseOffline[33m.[39mmockReturnValue({
     [90m    |[39m                    [31m[1m^[22m[39m
     [90m 82 |[39m       isOnline[33m:[39m [36mtrue[39m[33m,[39m
     [90m 83 |[39m       isSyncing[33m:[39m [36mfalse[39m[33m,[39m
     [90m 84 |[39m       syncProgress[33m:[39m [35m0[39m[33m,[39m[0m

      at Object.mockReturnValue (tests/unit/components/ResponsePlanningForm.test.tsx:81:20)

  ‚óè ResponsePlanningForm Component ‚Ä∫ Cancel Behavior ‚Ä∫ should show confirmation dialog when form is dirty

    TypeError: mockUseOffline.mockReturnValue is not a function

    [0m [90m 79 |[39m
     [90m 80 |[39m     [90m// Setup default offline mock[39m
    [31m[1m>[22m[39m[90m 81 |[39m     mockUseOffline[33m.[39mmockReturnValue({
     [90m    |[39m                    [31m[1m^[22m[39m
     [90m 82 |[39m       isOnline[33m:[39m [36mtrue[39m[33m,[39m
     [90m 83 |[39m       isSyncing[33m:[39m [36mfalse[39m[33m,[39m
     [90m 84 |[39m       syncProgress[33m:[39m [35m0[39m[33m,[39m[0m

      at Object.mockReturnValue (tests/unit/components/ResponsePlanningForm.test.tsx:81:20)

FAIL tests/unit/components/HealthAssessmentForm.test.tsx
  ‚óè HealthAssessmentForm ‚Ä∫ renders all form fields correctly

    TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')

    [0m [90m 129 |[39m   ]
     [90m 130 |[39m
    [31m[1m>[22m[39m[90m 131 |[39m   [36mconst[39m gaps [33m=[39m gapFields[33m.[39mfilter(field [33m=>[39m [33m![39mwatchedValues[field[33m.[39mkey [36mas[39m keyof [33mFormData[39m])
     [90m     |[39m                                                        [31m[1m^[22m[39m
     [90m 132 |[39m   [36mconst[39m gapCount [33m=[39m gaps[33m.[39mlength
     [90m 133 |[39m
     [90m 134 |[39m   [36mconst[39m handleSubmit [33m=[39m [36masync[39m (data[33m:[39m [33mFormData[39m) [33m=>[39m {[0m

      at src/components/forms/assessment/HealthAssessmentForm.tsx:131:56
          at Array.filter (<anonymous>)
      at filter (src/components/forms/assessment/HealthAssessmentForm.tsx:131:26)
      at renderWithHooks (node_modules/react-dom/cjs/react-dom.development.js:15486:18)
      at mountIndeterminateComponent (node_modules/react-dom/cjs/react-dom.development.js:20103:13)
      at beginWork (node_modules/react-dom/cjs/react-dom.development.js:21626:16)
      at beginWork$1 (node_modules/react-dom/cjs/react-dom.development.js:27465:14)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26599:12)
      at workLoopSync (node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at recoverFromConcurrentError (node_modules/react-dom/cjs/react-dom.development.js:25889:20)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25789:22)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:85:5)

  ‚óè HealthAssessmentForm ‚Ä∫ populates form with initial data

    TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')

    [0m [90m 129 |[39m   ]
     [90m 130 |[39m
    [31m[1m>[22m[39m[90m 131 |[39m   [36mconst[39m gaps [33m=[39m gapFields[33m.[39mfilter(field [33m=>[39m [33m![39mwatchedValues[field[33m.[39mkey [36mas[39m keyof [33mFormData[39m])
     [90m     |[39m                                                        [31m[1m^[22m[39m
     [90m 132 |[39m   [36mconst[39m gapCount [33m=[39m gaps[33m.[39mlength
     [90m 133 |[39m
     [90m 134 |[39m   [36mconst[39m handleSubmit [33m=[39m [36masync[39m (data[33m:[39m [33mFormData[39m) [33m=>[39m {[0m

      at src/components/forms/assessment/HealthAssessmentForm.tsx:131:56
          at Array.filter (<anonymous>)
      at filter (src/components/forms/assessment/HealthAssessmentForm.tsx:131:26)
      at renderWithHooks (node_modules/react-dom/cjs/react-dom.development.js:15486:18)
      at mountIndeterminateComponent (node_modules/react-dom/cjs/react-dom.development.js:20103:13)
      at beginWork (node_modules/react-dom/cjs/react-dom.development.js:21626:16)
      at beginWork$1 (node_modules/react-dom/cjs/react-dom.development.js:27465:14)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26599:12)
      at workLoopSync (node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at recoverFromConcurrentError (node_modules/react-dom/cjs/react-dom.development.js:25889:20)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25789:22)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:117:5)

  ‚óè HealthAssessmentForm ‚Ä∫ requires validation for required fields

    TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')

    [0m [90m 129 |[39m   ]
     [90m 130 |[39m
    [31m[1m>[22m[39m[90m 131 |[39m   [36mconst[39m gaps [33m=[39m gapFields[33m.[39mfilter(field [33m=>[39m [33m![39mwatchedValues[field[33m.[39mkey [36mas[39m keyof [33mFormData[39m])
     [90m     |[39m                                                        [31m[1m^[22m[39m
     [90m 132 |[39m   [36mconst[39m gapCount [33m=[39m gaps[33m.[39mlength
     [90m 133 |[39m
     [90m 134 |[39m   [36mconst[39m handleSubmit [33m=[39m [36masync[39m (data[33m:[39m [33mFormData[39m) [33m=>[39m {[0m

      at src/components/forms/assessment/HealthAssessmentForm.tsx:131:56
          at Array.filter (<anonymous>)
      at filter (src/components/forms/assessment/HealthAssessmentForm.tsx:131:26)
      at renderWithHooks (node_modules/react-dom/cjs/react-dom.development.js:15486:18)
      at mountIndeterminateComponent (node_modules/react-dom/cjs/react-dom.development.js:20103:13)
      at beginWork (node_modules/react-dom/cjs/react-dom.development.js:21626:16)
      at beginWork$1 (node_modules/react-dom/cjs/react-dom.development.js:27465:14)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26599:12)
      at workLoopSync (node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at recoverFromConcurrentError (node_modules/react-dom/cjs/react-dom.development.js:25889:20)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25789:22)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:135:5)

  ‚óè HealthAssessmentForm ‚Ä∫ handles checkbox interactions correctly

    TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')

    [0m [90m 129 |[39m   ]
     [90m 130 |[39m
    [31m[1m>[22m[39m[90m 131 |[39m   [36mconst[39m gaps [33m=[39m gapFields[33m.[39mfilter(field [33m=>[39m [33m![39mwatchedValues[field[33m.[39mkey [36mas[39m keyof [33mFormData[39m])
     [90m     |[39m                                                        [31m[1m^[22m[39m
     [90m 132 |[39m   [36mconst[39m gapCount [33m=[39m gaps[33m.[39mlength
     [90m 133 |[39m
     [90m 134 |[39m   [36mconst[39m handleSubmit [33m=[39m [36masync[39m (data[33m:[39m [33mFormData[39m) [33m=>[39m {[0m

      at src/components/forms/assessment/HealthAssessmentForm.tsx:131:56
          at Array.filter (<anonymous>)
      at filter (src/components/forms/assessment/HealthAssessmentForm.tsx:131:26)
      at renderWithHooks (node_modules/react-dom/cjs/react-dom.development.js:15486:18)
      at mountIndeterminateComponent (node_modules/react-dom/cjs/react-dom.development.js:20103:13)
      at beginWork (node_modules/react-dom/cjs/react-dom.development.js:21626:16)
      at beginWork$1 (node_modules/react-dom/cjs/react-dom.development.js:27465:14)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26599:12)
      at workLoopSync (node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at recoverFromConcurrentError (node_modules/react-dom/cjs/react-dom.development.js:25889:20)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25789:22)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:154:5)

  ‚óè HealthAssessmentForm ‚Ä∫ handles health issues selection correctly

    TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')

    [0m [90m 129 |[39m   ]
     [90m 130 |[39m
    [31m[1m>[22m[39m[90m 131 |[39m   [36mconst[39m gaps [33m=[39m gapFields[33m.[39mfilter(field [33m=>[39m [33m![39mwatchedValues[field[33m.[39mkey [36mas[39m keyof [33mFormData[39m])
     [90m     |[39m                                                        [31m[1m^[22m[39m
     [90m 132 |[39m   [36mconst[39m gapCount [33m=[39m gaps[33m.[39mlength
     [90m 133 |[39m
     [90m 134 |[39m   [36mconst[39m handleSubmit [33m=[39m [36masync[39m (data[33m:[39m [33mFormData[39m) [33m=>[39m {[0m

      at src/components/forms/assessment/HealthAssessmentForm.tsx:131:56
          at Array.filter (<anonymous>)
      at filter (src/components/forms/assessment/HealthAssessmentForm.tsx:131:26)
      at renderWithHooks (node_modules/react-dom/cjs/react-dom.development.js:15486:18)
      at mountIndeterminateComponent (node_modules/react-dom/cjs/react-dom.development.js:20103:13)
      at beginWork (node_modules/react-dom/cjs/react-dom.development.js:21626:16)
      at beginWork$1 (node_modules/react-dom/cjs/react-dom.development.js:27465:14)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26599:12)
      at workLoopSync (node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at recoverFromConcurrentError (node_modules/react-dom/cjs/react-dom.development.js:25889:20)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25789:22)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:172:5)

  ‚óè HealthAssessmentForm ‚Ä∫ handles GPS location capture

    TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')

    [0m [90m 129 |[39m   ]
     [90m 130 |[39m
    [31m[1m>[22m[39m[90m 131 |[39m   [36mconst[39m gaps [33m=[39m gapFields[33m.[39mfilter(field [33m=>[39m [33m![39mwatchedValues[field[33m.[39mkey [36mas[39m keyof [33mFormData[39m])
     [90m     |[39m                                                        [31m[1m^[22m[39m
     [90m 132 |[39m   [36mconst[39m gapCount [33m=[39m gaps[33m.[39mlength
     [90m 133 |[39m
     [90m 134 |[39m   [36mconst[39m handleSubmit [33m=[39m [36masync[39m (data[33m:[39m [33mFormData[39m) [33m=>[39m {[0m

      at src/components/forms/assessment/HealthAssessmentForm.tsx:131:56
          at Array.filter (<anonymous>)
      at filter (src/components/forms/assessment/HealthAssessmentForm.tsx:131:26)
      at renderWithHooks (node_modules/react-dom/cjs/react-dom.development.js:15486:18)
      at mountIndeterminateComponent (node_modules/react-dom/cjs/react-dom.development.js:20103:13)
      at beginWork (node_modules/react-dom/cjs/react-dom.development.js:21626:16)
      at beginWork$1 (node_modules/react-dom/cjs/react-dom.development.js:27465:14)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26599:12)
      at workLoopSync (node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at recoverFromConcurrentError (node_modules/react-dom/cjs/react-dom.development.js:25889:20)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25789:22)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:191:5)

  ‚óè HealthAssessmentForm ‚Ä∫ handles media attachment changes

    TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')

    [0m [90m 129 |[39m   ]
     [90m 130 |[39m
    [31m[1m>[22m[39m[90m 131 |[39m   [36mconst[39m gaps [33m=[39m gapFields[33m.[39mfilter(field [33m=>[39m [33m![39mwatchedValues[field[33m.[39mkey [36mas[39m keyof [33mFormData[39m])
     [90m     |[39m                                                        [31m[1m^[22m[39m
     [90m 132 |[39m   [36mconst[39m gapCount [33m=[39m gaps[33m.[39mlength
     [90m 133 |[39m
     [90m 134 |[39m   [36mconst[39m handleSubmit [33m=[39m [36masync[39m (data[33m:[39m [33mFormData[39m) [33m=>[39m {[0m

      at src/components/forms/assessment/HealthAssessmentForm.tsx:131:56
          at Array.filter (<anonymous>)
      at filter (src/components/forms/assessment/HealthAssessmentForm.tsx:131:26)
      at renderWithHooks (node_modules/react-dom/cjs/react-dom.development.js:15486:18)
      at mountIndeterminateComponent (node_modules/react-dom/cjs/react-dom.development.js:20103:13)
      at beginWork (node_modules/react-dom/cjs/react-dom.development.js:21626:16)
      at beginWork$1 (node_modules/react-dom/cjs/react-dom.development.js:27465:14)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26599:12)
      at workLoopSync (node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at recoverFromConcurrentError (node_modules/react-dom/cjs/react-dom.development.js:25889:20)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25789:22)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:203:5)

  ‚óè HealthAssessmentForm ‚Ä∫ submits form with valid data

    TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')

    [0m [90m 129 |[39m   ]
     [90m 130 |[39m
    [31m[1m>[22m[39m[90m 131 |[39m   [36mconst[39m gaps [33m=[39m gapFields[33m.[39mfilter(field [33m=>[39m [33m![39mwatchedValues[field[33m.[39mkey [36mas[39m keyof [33mFormData[39m])
     [90m     |[39m                                                        [31m[1m^[22m[39m
     [90m 132 |[39m   [36mconst[39m gapCount [33m=[39m gaps[33m.[39mlength
     [90m 133 |[39m
     [90m 134 |[39m   [36mconst[39m handleSubmit [33m=[39m [36masync[39m (data[33m:[39m [33mFormData[39m) [33m=>[39m {[0m

      at src/components/forms/assessment/HealthAssessmentForm.tsx:131:56
          at Array.filter (<anonymous>)
      at filter (src/components/forms/assessment/HealthAssessmentForm.tsx:131:26)
      at renderWithHooks (node_modules/react-dom/cjs/react-dom.development.js:15486:18)
      at mountIndeterminateComponent (node_modules/react-dom/cjs/react-dom.development.js:20103:13)
      at beginWork (node_modules/react-dom/cjs/react-dom.development.js:21626:16)
      at beginWork$1 (node_modules/react-dom/cjs/react-dom.development.js:27465:14)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26599:12)
      at workLoopSync (node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at recoverFromConcurrentError (node_modules/react-dom/cjs/react-dom.development.js:25889:20)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25789:22)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:214:5)

  ‚óè HealthAssessmentForm ‚Ä∫ calls onCancel when cancel button is clicked

    TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')

    [0m [90m 129 |[39m   ]
     [90m 130 |[39m
    [31m[1m>[22m[39m[90m 131 |[39m   [36mconst[39m gaps [33m=[39m gapFields[33m.[39mfilter(field [33m=>[39m [33m![39mwatchedValues[field[33m.[39mkey [36mas[39m keyof [33mFormData[39m])
     [90m     |[39m                                                        [31m[1m^[22m[39m
     [90m 132 |[39m   [36mconst[39m gapCount [33m=[39m gaps[33m.[39mlength
     [90m 133 |[39m
     [90m 134 |[39m   [36mconst[39m handleSubmit [33m=[39m [36masync[39m (data[33m:[39m [33mFormData[39m) [33m=>[39m {[0m

      at src/components/forms/assessment/HealthAssessmentForm.tsx:131:56
          at Array.filter (<anonymous>)
      at filter (src/components/forms/assessment/HealthAssessmentForm.tsx:131:26)
      at renderWithHooks (node_modules/react-dom/cjs/react-dom.development.js:15486:18)
      at mountIndeterminateComponent (node_modules/react-dom/cjs/react-dom.development.js:20103:13)
      at beginWork (node_modules/react-dom/cjs/react-dom.development.js:21626:16)
      at beginWork$1 (node_modules/react-dom/cjs/react-dom.development.js:27465:14)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26599:12)
      at workLoopSync (node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at recoverFromConcurrentError (node_modules/react-dom/cjs/react-dom.development.js:25889:20)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25789:22)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:259:5)

  ‚óè HealthAssessmentForm ‚Ä∫ disables form when isLoading is true

    TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')

    [0m [90m 129 |[39m   ]
     [90m 130 |[39m
    [31m[1m>[22m[39m[90m 131 |[39m   [36mconst[39m gaps [33m=[39m gapFields[33m.[39mfilter(field [33m=>[39m [33m![39mwatchedValues[field[33m.[39mkey [36mas[39m keyof [33mFormData[39m])
     [90m     |[39m                                                        [31m[1m^[22m[39m
     [90m 132 |[39m   [36mconst[39m gapCount [33m=[39m gaps[33m.[39mlength
     [90m 133 |[39m
     [90m 134 |[39m   [36mconst[39m handleSubmit [33m=[39m [36masync[39m (data[33m:[39m [33mFormData[39m) [33m=>[39m {[0m

      at src/components/forms/assessment/HealthAssessmentForm.tsx:131:56
          at Array.filter (<anonymous>)
      at filter (src/components/forms/assessment/HealthAssessmentForm.tsx:131:26)
      at renderWithHooks (node_modules/react-dom/cjs/react-dom.development.js:15486:18)
      at mountIndeterminateComponent (node_modules/react-dom/cjs/react-dom.development.js:20103:13)
      at beginWork (node_modules/react-dom/cjs/react-dom.development.js:21626:16)
      at beginWork$1 (node_modules/react-dom/cjs/react-dom.development.js:27465:14)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26599:12)
      at workLoopSync (node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at recoverFromConcurrentError (node_modules/react-dom/cjs/react-dom.development.js:25889:20)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25789:22)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:270:5)

  ‚óè HealthAssessmentForm ‚Ä∫ displays gap status badges correctly

    TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')

    [0m [90m 129 |[39m   ]
     [90m 130 |[39m
    [31m[1m>[22m[39m[90m 131 |[39m   [36mconst[39m gaps [33m=[39m gapFields[33m.[39mfilter(field [33m=>[39m [33m![39mwatchedValues[field[33m.[39mkey [36mas[39m keyof [33mFormData[39m])
     [90m     |[39m                                                        [31m[1m^[22m[39m
     [90m 132 |[39m   [36mconst[39m gapCount [33m=[39m gaps[33m.[39mlength
     [90m 133 |[39m
     [90m 134 |[39m   [36mconst[39m handleSubmit [33m=[39m [36masync[39m (data[33m:[39m [33mFormData[39m) [33m=>[39m {[0m

      at src/components/forms/assessment/HealthAssessmentForm.tsx:131:56
          at Array.filter (<anonymous>)
      at filter (src/components/forms/assessment/HealthAssessmentForm.tsx:131:26)
      at renderWithHooks (node_modules/react-dom/cjs/react-dom.development.js:15486:18)
      at mountIndeterminateComponent (node_modules/react-dom/cjs/react-dom.development.js:20103:13)
      at beginWork (node_modules/react-dom/cjs/react-dom.development.js:21626:16)
      at beginWork$1 (node_modules/react-dom/cjs/react-dom.development.js:27465:14)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26599:12)
      at workLoopSync (node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at recoverFromConcurrentError (node_modules/react-dom/cjs/react-dom.development.js:25889:20)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25789:22)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:289:5)

  ‚óè HealthAssessmentForm ‚Ä∫ shows gap analysis indicators for boolean fields

    TypeError: Cannot read properties of undefined (reading 'hasFunctionalClinic')

    [0m [90m 129 |[39m   ]
     [90m 130 |[39m
    [31m[1m>[22m[39m[90m 131 |[39m   [36mconst[39m gaps [33m=[39m gapFields[33m.[39mfilter(field [33m=>[39m [33m![39mwatchedValues[field[33m.[39mkey [36mas[39m keyof [33mFormData[39m])
     [90m     |[39m                                                        [31m[1m^[22m[39m
     [90m 132 |[39m   [36mconst[39m gapCount [33m=[39m gaps[33m.[39mlength
     [90m 133 |[39m
     [90m 134 |[39m   [36mconst[39m handleSubmit [33m=[39m [36masync[39m (data[33m:[39m [33mFormData[39m) [33m=>[39m {[0m

      at src/components/forms/assessment/HealthAssessmentForm.tsx:131:56
          at Array.filter (<anonymous>)
      at filter (src/components/forms/assessment/HealthAssessmentForm.tsx:131:26)
      at renderWithHooks (node_modules/react-dom/cjs/react-dom.development.js:15486:18)
      at mountIndeterminateComponent (node_modules/react-dom/cjs/react-dom.development.js:20103:13)
      at beginWork (node_modules/react-dom/cjs/react-dom.development.js:21626:16)
      at beginWork$1 (node_modules/react-dom/cjs/react-dom.development.js:27465:14)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26599:12)
      at workLoopSync (node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at recoverFromConcurrentError (node_modules/react-dom/cjs/react-dom.development.js:25889:20)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25789:22)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:73:18)
      at Object.renderForm (tests/unit/components/HealthAssessmentForm.test.tsx:298:5)

FAIL tests/unit/components/crisis/ConflictLog.test.tsx
  ‚óè ConflictLog Component ‚Ä∫ should show loading state

    TestingLibraryElementError: Found multiple elements with the role "generic"

    Here are the matching elements:

    Ignored nodes: comments, script, style
    [36m<div>[39m
      [36m<div[39m
        [33mclass[39m=[32m"bg-white rounded-lg border border-gray-200 p-6 "[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"animate-pulse"[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"h-4 bg-gray-200 rounded w-1/4 mb-4"[39m
          [36m/>[39m
          [36m<div[39m
            [33mclass[39m=[32m"space-y-3"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"h-12 bg-gray-200 rounded"[39m
            [36m/>[39m
            [36m<div[39m
              [33mclass[39m=[32m"h-12 bg-gray-200 rounded"[39m
            [36m/>[39m
            [36m<div[39m
              [33mclass[39m=[32m"h-12 bg-gray-200 rounded"[39m
            [36m/>[39m
          [36m</div>[39m
        [36m</div>[39m
      [36m</div>[39m
    [36m</div>[39m

    Ignored nodes: comments, script, style
    [36m<div[39m
      [33mclass[39m=[32m"bg-white rounded-lg border border-gray-200 p-6 "[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"animate-pulse"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"h-4 bg-gray-200 rounded w-1/4 mb-4"[39m
        [36m/>[39m
        [36m<div[39m
          [33mclass[39m=[32m"space-y-3"[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"h-12 bg-gray-200 rounded"[39m
          [36m/>[39m
          [36m<div[39m
            [33mclass[39m=[32m"h-12 bg-gray-200 rounded"[39m
          [36m/>[39m
          [36m<div[39m
            [33mclass[39m=[32m"h-12 bg-gray-200 rounded"[39m
          [36m/>[39m
        [36m</div>[39m
      [36m</div>[39m
    [36m</div>[39m

    Ignored nodes: comments, script, style
    [36m<div[39m
      [33mclass[39m=[32m"animate-pulse"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"h-4 bg-gray-200 rounded w-1/4 mb-4"[39m
      [36m/>[39m
      [36m<div[39m
        [33mclass[39m=[32m"space-y-3"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"h-12 bg-gray-200 rounded"[39m
        [36m/>[39m
        [36m<div[39m
          [33mclass[39m=[32m"h-12 bg-gray-200 rounded"[39m
        [36m/>[39m
        [36m<div[39m
          [33mclass[39m=[32m"h-12 bg-gray-200 rounded"[39m
        [36m/>[39m
      [36m</div>[39m
    [36m</div>[39m

    Ignored nodes: comments, script, style
    [36m<div[39m
      [33mclass[39m=[32m"h-4 bg-gray-200 rounded w-1/4 mb-4"[39m
    [36m/>[39m

    Ignored nodes: comments, script, style
    [36m<div[39m
      [33mclass[39m=[32m"space-y-3"[39m
    [36m>[39m
      [36m<div[39m
        [33mclass[39m=[32m"h-12 bg-gray-200 rounded"[39m
      [36m/>[39m
      [36m<div[39m
        [33mclass[39m=[32m"h-12 bg-gray-200 rounded"[39m
      [36m/>[39m
      [36m<div[39m
        [33mclass[39m=[32m"h-12 bg-gray-200 rounded"[39m
      [36m/>[39m
    [36m</div>[39m

    Ignored nodes: comments, script, style
    [36m<div[39m
      [33mclass[39m=[32m"h-12 bg-gray-200 rounded"[39m
    [36m/>[39m

    Ignored nodes: comments, script, style
    [36m<div[39m
      [33mclass[39m=[32m"h-12 bg-gray-200 rounded"[39m
    [36m/>[39m

    Ignored nodes: comments, script, style
    [36m<div[39m
      [33mclass[39m=[32m"h-12 bg-gray-200 rounded"[39m
    [36m/>[39m

    (If this is intentional, then use the `*AllBy*` variant of the query (like `queryAllByText`, `getAllByText`, or `findAllByText`)).

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<div[39m
          [33mclass[39m=[32m"bg-white rounded-lg border border-gray-200 p-6 "[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"animate-pulse"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"h-4 bg-gray-200 rounded w-1/4 mb-4"[39m
            [36m/>[39m
            [36m<div[39m
              [33mclass[39m=[32m"space-y-3"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"h-12 bg-gray-200 rounded"[39m
              [36m/>[39m
              [36m<div[39m
                [33mclass[39m=[32m"h-12 bg-gray-200 rounded"[39m
              [36m/>[39m
              [36m<div[39m
                [33mclass[39m=[32m"h-12 bg-gray-200 rounded"[39m
              [36m/>[39m
            [36m</div>[39m
          [36m</div>[39m
        [36m</div>[39m
      [36m</div>[39m
    [36m</body>[39m

    [0m [90m 117 |[39m     render([33m<[39m[33mConflictLog[39m [33m/[39m[33m>[39m)[33m;[39m
     [90m 118 |[39m
    [31m[1m>[22m[39m[90m 119 |[39m     expect(screen[33m.[39mgetByRole([32m'generic'[39m))[33m.[39mtoHaveClass([32m'animate-pulse'[39m)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 120 |[39m   })[33m;[39m
     [90m 121 |[39m
     [90m 122 |[39m   it([32m'should show error state'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.getElementError (node_modules/@testing-library/dom/dist/config.js:37:19)
      at getElementError (node_modules/@testing-library/dom/dist/query-helpers.js:20:35)
      at getMultipleElementsFoundError (node_modules/@testing-library/dom/dist/query-helpers.js:23:10)
      at node_modules/@testing-library/dom/dist/query-helpers.js:55:13
      at node_modules/@testing-library/dom/dist/query-helpers.js:95:19
      at Object.getByRole (tests/unit/components/crisis/ConflictLog.test.tsx:119:19)

  ‚óè ConflictLog Component ‚Ä∫ should expand and collapse conflict groups

    Found multiple elements with the text: Resolved

    Here are the matching elements:

    Ignored nodes: comments, script, style
    [36m<option[39m
      [33mvalue[39m=[32m"true"[39m
    [36m>[39m
      [0mResolved[0m
    [36m</option>[39m

    Ignored nodes: comments, script, style
    [36m<span[39m
      [33mclass[39m=[32m"text-xs text-green-700 font-medium"[39m
    [36m>[39m
      [0mResolved[0m
    [36m</span>[39m

    (If this is intentional, then use the `*AllBy*` variant of the query (like `queryAllByText`, `getAllByText`, or `findAllByText`)).

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<div[39m
          [33mclass[39m=[32m"bg-white rounded-lg border border-gray-200 "[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"px-6 py-4 border-b border-gray-200"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"flex items-center justify-between"[39m
            [36m>[39m
              [36m<div>[39m
                [36m<h3[39m
                  [33mclass[39m=[32m"text-lg font-semibold text-gray-900"[39m
                [36m>[39m
                  [0mSync Conflicts[0m
                [36m</h3>[39m
                [36m<p[39m
                  [33mclass[39m=[32m"text-sm text-gray-600"[39m
                [36m>[39m
                  [0m2[0m
                  [0m total ‚Ä¢ [0m
                  [0m1[0m
                  [0m unresolved[0m
                [36m</p>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mclass[39m=[32m"flex items-center gap-2"[39m
              [36m>[39m
                [36m<button[39m
                  [33mclass[39m=[32m"p-2 text-gray-500 hover:text-gray-700 disabled:opacity-50"[39m
                  [33mtitle[39m=[32m"Refresh"[39m
                [36m>[39m
                  [36m<svg[39m
                    [33mclass[39m=[32m"w-4 h-4 "[39m
                    [33mfill[39m=[32m"currentColor"[39m
                    [33mviewBox[39m=[32m"0 0 24 24"[39m
                  [36m>[39m
                    [36m<path[39m
                      [33md[39m=[32m"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"[39m
                    [36m/>[39m
                  [36m</svg>[39m
                [36m</button>[39m
                [36m<button[39m
                  [33mclass[39m=[32m"px-3 py-2 text-sm bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors"[39m
                [36m>[39m
                  [0mExport CSV[0m
                [36m</button>[39m
              [36m</div>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mclass[39m=[32m"flex gap-3 mt-4"[39m
            [36m>[39m
              [36m<select[39m
                [33mclass[39m=[32m"px-3 py-2 border border-gray-300 rounded-md text-sm"[39m
              [36m>[39m
                [36m<option[39m
                  [33mvalue[39m=[32m""[39m
                [36m>[39m
                  [0mAll Types[0m
                [36m</option>[39m
                [36m<option[39m
                  [33mvalue[39m=[32m"assessment"[39m
                [36m>[39m
                  [0mAssessment[0m
                [36m</option>[39m
                [36m<option[39m
                  [33mvalue[39m=[32m"response"[39m
                [36m>[39m
                  [0mResponse[0m
                [36m</option>[39m
                [36m<option[39m
                  [33mvalue[39m=[32m"entity"[39m
                [36m>[39m
                  [0mEntity[0m
                [36m</option>[39m
              [36m</select>[39m
              [36m<select[39m
                [33mclass[39m=[32m"px-3 py-2 border border-gray-300 rounded-md text-sm"[39m
              [36m>[39m
                [36m<option[39m
                  [33mvalue[39m=[32m""[39m
                [36m>[39m
                  [0mAll Status[0m
                [36m</option>[39m
                [36m<option[39m
                  [33mvalue[39m=[32m"true"[39m
                [36m>[39m
                  [0mResolved[0m
                [36m</option>[39m
                [36m<option[39m
                  [33mvalue[39m=[32m"false"[39m
                [36m>[39m
                  [0mUnresolved[0m
                [36m</option>[39m
              [36m</select>[39m
            [36m</div>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"p-6"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"space-y-4"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"border border-gray-200 rounded-lg"[39m
              [36m>[39m
                [36m<button[39m
                  [33mclass[39m=[32m"w-full px-4 py-3 flex items-center justify-between bg-gray-50 hover:bg-gray-100 transition-colors rounded-t-lg"[39m
                [36m>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"flex items-center gap-3"[39m
                  [36m>[39m
                    [36m<div[39m
                      [33mclass[39m=[32m"flex items-center gap-2"[39m
                    [36m>[39m
                      [36m<span[39m
                        [33mclass[39m=[32m"font-medium text-gray-900"[39m
                      [36m>[39m
                        [0mRESPONSE entity-2[0m
                      [36m</span>[39m
                      [36m<span[39m
                        [33mclass[39m=[32m"text-sm text-gray-500"[39m
                      [36m>[39m
                        [0m([0m
                        [0mRESPONSE[0m
                        [0m)[0m
                      [36m</span>[39m
                    [36m</div>[39m
                    [36m<div[39m
                      [33mclass[39m=[32m"flex items-center gap-2"[39m
                    [36m>[39m
                      [36m<span[39m
                        [33mclass[39m=[32m"px-2 py-1 bg-blue-100 text-blue-800 text-xs font-medium rounded-full"[39m
                      [36m>[39m
                        [0m1[0m
                        [0m conflicts[0m
                      [36m</span>[39m
                      [36m<span[39m
                        [33mclass[39m=[32m"px-2 py-1 bg-red-100 text-red-800 text-xs font-medium rounded-full"[39m
                      [36m>[39m
                        [0m1[0m
                        [0m unresolved[0m
                      [36m</span>[39m
                    [36m</div>[39m
                  [36m</div>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"flex items-center gap-2"[39m
                  [36m>[39m
                    [36m<span[39m
                      [33mclass[39m=[32m"text-sm text-gray-500"[39m
                    [36m>[39m
                      [0m308d ago[0m
                    [36m</span>[39m
                    [36m<svg[39m
                      [33mclass[39m=[32m"w-4 h-4 text-gray-400 transition-transform "[39m
                      [33mfill[39m=[32m"currentColor"[39m
                      [33mviewBox[39m=[32m"0 0 24 24"[39m
                    [36m>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M7.41 8.84L12 13.42l4.59-4.58L18 10.25l-6 6-6-6z"[39m
                      [36m/>[39m
                    [36m</svg>[39m
                  [36m</div>[39m
                [36m</button>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mclass[39m=[32m"border border-gray-200 rounded-lg"[39m
              [36m>[39m
                [36m<button[39m
                  [33mclass[39m=[32m"w-full px-4 py-3 flex items-center justify-between bg-gray-50 hover:bg-gray-100 transition-colors rounded-t-lg"[39m
                [36m>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"flex items-center gap-3"[39m
                  [36m>[39m
                    [36m<div[39m
                      [33mclass[39m=[32m"flex items-center gap-2"[39m
                    [36m>[39m
                      [36m<span[39m
                        [33mclass[39m=[32m"font-medium text-gray-900"[39m
                      [36m>[39m
                        [0mASSESSMENT entity-1[0m
                      [36m</span>[39m
                      [36m<span[39m
                        [33mclass[39m=[32m"text-sm text-gray-500"[39m
                      [36m>[39m
                        [0m([0m
                        [0mASSESSMENT[0m
                        [0m)[0m
                      [36m</span>[39m
                    [36m</div>[39m
                    [36m<div[39m
                      [33mclass[39m=[32m"flex items-center gap-2"[39m
                    [36m>[39m
                      [36m<span[39m
                        [33mclass[39m=[32m"px-2 py-1 bg-blue-100 text-blue-800 text-xs font-medium rounded-full"[39m
                      [36m>[39m
                        [0m1[0m
                        [0m conflicts[0m
                      [36m</span>[39m
                    [36m</div>[39m
                  [36m</div>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"flex items-center gap-2"[39m
                  [36m>[39m
                    [36m<span[39m
                      [33mclass[39m=[32m"text-sm text-gray-500"[39m
                    [36m>[39m
                      [0m308d ago[0m
                    [36m</span>[39m
                    [36m<svg[39m
                      [33mclass[39m=[32m"w-4 h-4 text-gray-400 transition-transform rotate-180"[39m
                      [33mfill[39m=[32m"currentColor"[39m
                      [33mviewBox[39m=[32m"0 0 24 24"[39m
                    [36m>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M7.41 8.84L12 13.42l4.59-4.58L18 10.25l-6 6-6-6z"[39m
                      [36m/>[39m
                    [36m</svg>[39m
                  [36m</div>[39m
                [36m</button>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"divide-y divide-gray-200"[39m
                [36m>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"px-4 py-3"[39m
                  [36m>[39m
                    [36m<div[39m
                      [33mclass[39m=[32m"flex items-start justify-between"[39m
                    [36m>[39m
                      [36m<div[39m
                        [33mclass[39m=[32m"flex-1"[39m
                      [36m>[39m
                        [36m<div[39m
                          [33mclass[39m=[32m"flex items-center gap-3 mb-2"[39m
                        [36m>[39m
                          [36m<div[39m
                            [33mclass[39m=[32m"flex items-center gap-1"[39m
                          [36m>[39m
                            [36m<div[39m
                              [33mclass[39m=[32m"w-3 h-3 bg-green-500 rounded-full"[39m
                            [36m/>[39m
                            [36m<span[39m
                              [33mclass[39m=[32m"text-xs text-green-700 font-medium"[39m
                            [36m>[39m
                              [0mResolved[0m
                            [36m</span>[39m
                          [36m</div>[39m
                          [36m<span[39m
                            [33mclass[39m=[32m"px-2 py-1 text-xs font-medium rounded-full bg-blue-100 text-blue-800"[39m
                          [36m>[39m
                            [0mLAST-WRITE_WINS[0m
                          [36m</span>[39m
                          [36m<span[39m
                            [33mclass[39m=[32m"text-sm text-gray-500"[39m
                          [36m>[39m
                            [0mv[0m
                            [0m1[0m
                            [0m ‚Üî v[0m
                            [0m2[0m
                          [36m</span>[39m
                        [36m</div>[39m
                        [36m<div[39m
                          [33mclass[39m=[32m"text-sm text-gray-600"[39m
                        [36m>[39m
                          [36m<p>[39m
                            [0mConflict ID: [0m
                            [36m<span[39m
                              [33mclass[39m=[32m"font-mono"[39m
                            [36m>[39m
                              [0mconflict[0m
                            [36m</span>[39m
                          [36m</p>[39m
                          [36m<p>[39m
                            [0mDetected: [0m
                            [0m308d ago[0m
                          [36m</p>[39m
                          [36m<p>[39m
                            [0mResolved: [0m
                            [0m308d ago[0m
                          [36m</p>[39m
                        [36m</div>[39m
                      [36m</div>[39m
                      [36m<div[39m
                        [33mclass[39m=[32m"text-right"[39m
                      [36m>[39m
                        [36m<div[39m
                          [33mclass[39m=[32m"text-sm text-gray-900 font-medium mb-1"[39m
                        [36m>[39m
                          [0m01/01/2025[0m
                        [36m</div>[39m
                        [36m<div[39m
                          [33mclass[39m=[32m"text-xs text-gray-500"[39m
                        [36m>[39m
                          [0m11:00:00[0m
                        [36m</div>[39m
                      [36m</div>[39m
                    [36m</div>[39m
                  [36m</div>[39m
                [36m</div>[39m
              [36m</div>[39m
            [36m</div>[39m
          [36m</div>[39m
        [36m</div>[39m
      [36m</div>[39m
    [36m</body>[39m

    [0m [90m 158 |[39m
     [90m 159 |[39m     [90m// Check if conflict details are shown[39m
    [31m[1m>[22m[39m[90m 160 |[39m     [36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                  [31m[1m^[22m[39m
     [90m 161 |[39m       expect(screen[33m.[39mgetByText([32m'Resolved'[39m))[33m.[39mtoBeInTheDocument()[33m;[39m
     [90m 162 |[39m       expect(screen[33m.[39mgetByText([32m'LAST-WRITE-WINS'[39m))[33m.[39mtoBeInTheDocument()[33m;[39m
     [90m 163 |[39m     })[33m;[39m[0m

      at waitForWrapper (node_modules/@testing-library/dom/dist/wait-for.js:163:27)
      at Object.<anonymous> (tests/unit/components/crisis/ConflictLog.test.tsx:160:18)

  ‚óè ConflictLog Component ‚Ä∫ should display conflict status indicators correctly

    Found multiple elements with the text: Resolved

    Here are the matching elements:

    Ignored nodes: comments, script, style
    [36m<option[39m
      [33mvalue[39m=[32m"true"[39m
    [36m>[39m
      [0mResolved[0m
    [36m</option>[39m

    Ignored nodes: comments, script, style
    [36m<span[39m
      [33mclass[39m=[32m"text-xs text-green-700 font-medium"[39m
    [36m>[39m
      [0mResolved[0m
    [36m</span>[39m

    (If this is intentional, then use the `*AllBy*` variant of the query (like `queryAllByText`, `getAllByText`, or `findAllByText`)).

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<div[39m
          [33mclass[39m=[32m"bg-white rounded-lg border border-gray-200 "[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"px-6 py-4 border-b border-gray-200"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"flex items-center justify-between"[39m
            [36m>[39m
              [36m<div>[39m
                [36m<h3[39m
                  [33mclass[39m=[32m"text-lg font-semibold text-gray-900"[39m
                [36m>[39m
                  [0mSync Conflicts[0m
                [36m</h3>[39m
                [36m<p[39m
                  [33mclass[39m=[32m"text-sm text-gray-600"[39m
                [36m>[39m
                  [0m2[0m
                  [0m total ‚Ä¢ [0m
                  [0m1[0m
                  [0m unresolved[0m
                [36m</p>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mclass[39m=[32m"flex items-center gap-2"[39m
              [36m>[39m
                [36m<button[39m
                  [33mclass[39m=[32m"p-2 text-gray-500 hover:text-gray-700 disabled:opacity-50"[39m
                  [33mtitle[39m=[32m"Refresh"[39m
                [36m>[39m
                  [36m<svg[39m
                    [33mclass[39m=[32m"w-4 h-4 "[39m
                    [33mfill[39m=[32m"currentColor"[39m
                    [33mviewBox[39m=[32m"0 0 24 24"[39m
                  [36m>[39m
                    [36m<path[39m
                      [33md[39m=[32m"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"[39m
                    [36m/>[39m
                  [36m</svg>[39m
                [36m</button>[39m
                [36m<button[39m
                  [33mclass[39m=[32m"px-3 py-2 text-sm bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors"[39m
                [36m>[39m
                  [0mExport CSV[0m
                [36m</button>[39m
              [36m</div>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mclass[39m=[32m"flex gap-3 mt-4"[39m
            [36m>[39m
              [36m<select[39m
                [33mclass[39m=[32m"px-3 py-2 border border-gray-300 rounded-md text-sm"[39m
              [36m>[39m
                [36m<option[39m
                  [33mvalue[39m=[32m""[39m
                [36m>[39m
                  [0mAll Types[0m
                [36m</option>[39m
                [36m<option[39m
                  [33mvalue[39m=[32m"assessment"[39m
                [36m>[39m
                  [0mAssessment[0m
                [36m</option>[39m
                [36m<option[39m
                  [33mvalue[39m=[32m"response"[39m
                [36m>[39m
                  [0mResponse[0m
                [36m</option>[39m
                [36m<option[39m
                  [33mvalue[39m=[32m"entity"[39m
                [36m>[39m
                  [0mEntity[0m
                [36m</option>[39m
              [36m</select>[39m
              [36m<select[39m
                [33mclass[39m=[32m"px-3 py-2 border border-gray-300 rounded-md text-sm"[39m
              [36m>[39m
                [36m<option[39m
                  [33mvalue[39m=[32m""[39m
                [36m>[39m
                  [0mAll Status[0m
                [36m</option>[39m
                [36m<option[39m
                  [33mvalue[39m=[32m"true"[39m
                [36m>[39m
                  [0mResolved[0m
                [36m</option>[39m
                [36m<option[39m
                  [33mvalue[39m=[32m"false"[39m
                [36m>[39m
                  [0mUnresolved[0m
                [36m</option>[39m
              [36m</select>[39m
            [36m</div>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"p-6"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"space-y-4"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"border border-gray-200 rounded-lg"[39m
              [36m>[39m
                [36m<button[39m
                  [33mclass[39m=[32m"w-full px-4 py-3 flex items-center justify-between bg-gray-50 hover:bg-gray-100 transition-colors rounded-t-lg"[39m
                [36m>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"flex items-center gap-3"[39m
                  [36m>[39m
                    [36m<div[39m
                      [33mclass[39m=[32m"flex items-center gap-2"[39m
                    [36m>[39m
                      [36m<span[39m
                        [33mclass[39m=[32m"font-medium text-gray-900"[39m
                      [36m>[39m
                        [0mRESPONSE entity-2[0m
                      [36m</span>[39m
                      [36m<span[39m
                        [33mclass[39m=[32m"text-sm text-gray-500"[39m
                      [36m>[39m
                        [0m([0m
                        [0mRESPONSE[0m
                        [0m)[0m
                      [36m</span>[39m
                    [36m</div>[39m
                    [36m<div[39m
                      [33mclass[39m=[32m"flex items-center gap-2"[39m
                    [36m>[39m
                      [36m<span[39m
                        [33mclass[39m=[32m"px-2 py-1 bg-blue-100 text-blue-800 text-xs font-medium rounded-full"[39m
                      [36m>[39m
                        [0m1[0m
                        [0m conflicts[0m
                      [36m</span>[39m
                      [36m<span[39m
                        [33mclass[39m=[32m"px-2 py-1 bg-red-100 text-red-800 text-xs font-medium rounded-full"[39m
                      [36m>[39m
                        [0m1[0m
                        [0m unresolved[0m
                      [36m</span>[39m
                    [36m</div>[39m
                  [36m</div>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"flex items-center gap-2"[39m
                  [36m>[39m
                    [36m<span[39m
                      [33mclass[39m=[32m"text-sm text-gray-500"[39m
                    [36m>[39m
                      [0m308d ago[0m
                    [36m</span>[39m
                    [36m<svg[39m
                      [33mclass[39m=[32m"w-4 h-4 text-gray-400 transition-transform "[39m
                      [33mfill[39m=[32m"currentColor"[39m
                      [33mviewBox[39m=[32m"0 0 24 24"[39m
                    [36m>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M7.41 8.84L12 13.42l4.59-4.58L18 10.25l-6 6-6-6z"[39m
                      [36m/>[39m
                    [36m</svg>[39m
                  [36m</div>[39m
                [36m</button>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mclass[39m=[32m"border border-gray-200 rounded-lg"[39m
              [36m>[39m
                [36m<button[39m
                  [33mclass[39m=[32m"w-full px-4 py-3 flex items-center justify-between bg-gray-50 hover:bg-gray-100 transition-colors rounded-t-lg"[39m
                [36m>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"flex items-center gap-3"[39m
                  [36m>[39m
                    [36m<div[39m
                      [33mclass[39m=[32m"flex items-center gap-2"[39m
                    [36m>[39m
                      [36m<span[39m
                        [33mclass[39m=[32m"font-medium text-gray-900"[39m
                      [36m>[39m
                        [0mASSESSMENT entity-1[0m
                      [36m</span>[39m
                      [36m<span[39m
                        [33mclass[39m=[32m"text-sm text-gray-500"[39m
                      [36m>[39m
                        [0m([0m
                        [0mASSESSMENT[0m
                        [0m)[0m
                      [36m</span>[39m
                    [36m</div>[39m
                    [36m<div[39m
                      [33mclass[39m=[32m"flex items-center gap-2"[39m
                    [36m>[39m
                      [36m<span[39m
                        [33mclass[39m=[32m"px-2 py-1 bg-blue-100 text-blue-800 text-xs font-medium rounded-full"[39m
                      [36m>[39m
                        [0m1[0m
                        [0m conflicts[0m
                      [36m</span>[39m
                    [36m</div>[39m
                  [36m</div>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"flex items-center gap-2"[39m
                  [36m>[39m
                    [36m<span[39m
                      [33mclass[39m=[32m"text-sm text-gray-500"[39m
                    [36m>[39m
                      [0m308d ago[0m
                    [36m</span>[39m
                    [36m<svg[39m
                      [33mclass[39m=[32m"w-4 h-4 text-gray-400 transition-transform rotate-180"[39m
                      [33mfill[39m=[32m"currentColor"[39m
                      [33mviewBox[39m=[32m"0 0 24 24"[39m
                    [36m>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M7.41 8.84L12 13.42l4.59-4.58L18 10.25l-6 6-6-6z"[39m
                      [36m/>[39m
                    [36m</svg>[39m
                  [36m</div>[39m
                [36m</button>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"divide-y divide-gray-200"[39m
                [36m>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"px-4 py-3"[39m
                  [36m>[39m
                    [36m<div[39m
                      [33mclass[39m=[32m"flex items-start justify-between"[39m
                    [36m>[39m
                      [36m<div[39m
                        [33mclass[39m=[32m"flex-1"[39m
                      [36m>[39m
                        [36m<div[39m
                          [33mclass[39m=[32m"flex items-center gap-3 mb-2"[39m
                        [36m>[39m
                          [36m<div[39m
                            [33mclass[39m=[32m"flex items-center gap-1"[39m
                          [36m>[39m
                            [36m<div[39m
                              [33mclass[39m=[32m"w-3 h-3 bg-green-500 rounded-full"[39m
                            [36m/>[39m
                            [36m<span[39m
                              [33mclass[39m=[32m"text-xs text-green-700 font-medium"[39m
                            [36m>[39m
                              [0mResolved[0m
                            [36m</span>[39m
                          [36m</div>[39m
                          [36m<span[39m
                            [33mclass[39m=[32m"px-2 py-1 text-xs font-medium rounded-full bg-blue-100 text-blue-800"[39m
                          [36m>[39m
                            [0mLAST-WRITE_WINS[0m
                          [36m</span>[39m
                          [36m<span[39m
                            [33mclass[39m=[32m"text-sm text-gray-500"[39m
                          [36m>[39m
                            [0mv[0m
                            [0m1[0m
                            [0m ‚Üî v[0m
                            [0m2[0m
                          [36m</span>[39m
                        [36m</div>[39m
                        [36m<div[39m
                          [33mclass[39m=[32m"text-sm text-gray-600"[39m
                        [36m>[39m
                          [36m<p>[39m
                            [0mConflict ID: [0m
                            [36m<span[39m
                              [33mclass[39m=[32m"font-mono"[39m
                            [36m>[39m
                              [0mconflict[0m
                            [36m</span>[39m
                          [36m</p>[39m
                          [36m<p>[39m
                            [0mDetected: [0m
                            [0m308d ago[0m
                          [36m</p>[39m
                          [36m<p>[39m
                            [0mResolved: [0m
                            [0m308d ago[0m
                          [36m</p>[39m
                        [36m</div>[39m
                      [36m</div>[39m
                      [36m<div[39m
                        [33mclass[39m=[32m"text-right"[39m
                      [36m>[39m
                        [36m<div[39m
                          [33mclass[39m=[32m"text-sm text-gray-900 font-medium mb-1"[39m
                        [36m>[39m
                          [0m01/01/2025[0m
                        [36m</div>[39m
                        [36m<div[39m
                          [33mclass[39m=[32m"text-xs text-gray-500"[39m
                        [36m>[39m
                          [0m11:00:00[0m
                        [36m</div>[39m
                      [36m</div>[39m
                    [36m</div>[39m
                  [36m</div>[39m
                [36m</div>[39m
              [36m</div>[39m
            [36m</div>[39m
          [36m</div>[39m
        [36m</div>[39m
      [36m</div>[39m
    [36m</body>[39m

    [0m [90m 274 |[39m     fireEvent[33m.[39mclick(groupHeader)[33m;[39m
     [90m 275 |[39m
    [31m[1m>[22m[39m[90m 276 |[39m     [36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                  [31m[1m^[22m[39m
     [90m 277 |[39m       [90m// Check for resolved status[39m
     [90m 278 |[39m       expect(screen[33m.[39mgetByText([32m'Resolved'[39m))[33m.[39mtoBeInTheDocument()[33m;[39m
     [90m 279 |[39m       [0m

      at waitForWrapper (node_modules/@testing-library/dom/dist/wait-for.js:163:27)
      at Object.<anonymous> (tests/unit/components/crisis/ConflictLog.test.tsx:276:18)

FAIL tests/unit/components/GPSCapture.test.tsx (5.04 s)
  ‚óè GPSCapture ‚Ä∫ should capture GPS coordinates successfully

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: 9.072264, 7.491302
    Received: 11.506, 13.098

    Number of calls: 1

    Ignored nodes: comments, script, style
    [36m<html>[39m
      [36m<head />[39m
      [36m<body>[39m
        [36m<div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"rounded-lg border bg-card text-card-foreground shadow-sm w-full"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"flex flex-col space-y-1.5 p-6"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"text-2xl font-semibold leading-none tracking-tight flex items-center gap-2"[39m
              [36m>[39m
                [36m<svg[39m
                  [33maria-hidden[39m=[32m"true"[39m
                  [33mclass[39m=[32m"lucide lucide-map-pin h-5 w-5"[39m
                  [33mfill[39m=[32m"none"[39m
                  [33mheight[39m=[32m"24"[39m
                  [33mstroke[39m=[32m"currentColor"[39m
                  [33mstroke-linecap[39m=[32m"round"[39m
                  [33mstroke-linejoin[39m=[32m"round"[39m
                  [33mstroke-width[39m=[32m"2"[39m
                  [33mviewBox[39m=[32m"0 0 24 24"[39m
                  [33mwidth[39m=[32m"24"[39m
                  [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
                [36m>[39m
                  [36m<path[39m
                    [33md[39m=[32m"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0"[39m
                  [36m/>[39m
                  [36m<circle[39m
                    [33mcx[39m=[32m"12"[39m
                    [33mcy[39m=[32m"10"[39m
                    [33mr[39m=[32m"3"[39m
                  [36m/>[39m
                [36m</svg>[39m
                [0mGPS Location Capture[0m
              [36m</div>[39m
              [36m<div[39m
                [33mclass[39m=[32m"text-sm text-muted-foreground"[39m
              [36m>[39m
                [0mCapture GPS coordinates automatically or enter them manually[0m
              [36m</div>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mclass[39m=[32m"p-6 pt-0 space-y-4"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground bg-background text-foreground"[39m
                [33mrole[39m=[32m"alert"[39m
              [36m>[39m
                [36m<svg[39m
                  [33maria-hidden[39m=[32m"true"[39m
                  [33mclass[39m=[32m"lucide lucide-map-pin h-4 w-4"[39m
                  [33mfill[39m=[32m"none"[39m
                  [33mheight[39m=[32m"24"[39m
                  [33mstroke[39m=[32m"currentColor"[39m
                  [33mstroke-linecap[39m=[32m"round"[39m
                  [33mstroke-linejoin[39m=[32m"round"[39m
                  [33mstroke-width[39m=[32m"2"[39m
                  [33mviewBox[39m=[32m"0 0 24 24"[39m
                  [33mwidth[39m=[32m"24"[39m
                  [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
                [36m>[39m
                  [36m<path[39m
                    [33md[39m=[32m"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0"[39m
                  [36m/>[39m
                  [36m<circle[39m
                    [33mcx[39m=[32m"12"[39m
                    [33mcy[39m=[32m"10"[39m
                    [33mr[39m=[32m"3"[39m
                  [36m/>[39m
                [36m</svg>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"text-sm [&_p]:leading-relaxed"[39m
                [36m>[39m
                  [36m<strong>[39m
                    [0mCurrent Location:[0m
                  [36m</strong>[39m
                  [36m<br />[39m
                  [0mLatitude: [0m
                  [0m11.506000[0m
                  [36m<br />[39m
                  [0mLongitude: [0m
                  [0m13.098000[0m
                [36m</div>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mclass[39m=[32m"flex gap-2"[39m
              [36m>[39m
                [36m<button[39m
                  [33mclass[39m=[32m"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 py-2 flex-1"[39m
                [36m>[39m
                  [36m<svg[39m
                    [33maria-hidden[39m=[32m"true"[39m
                    [33mclass[39m=[32m"lucide lucide-navigation h-4 w-4 mr-2"[39m
                    [33mfill[39m=[32m"none"[39m
                    [33mheight[39m=[32m"24"[39m
                    [33mstroke[39m=[32m"currentColor"[39m
                    [33mstroke-linecap[39m=[32m"round"[39m
                    [33mstroke-linejoin[39m=[32m"round"[39m
                    [33mstroke-width[39m=[32m"2"[39m
                    [33mviewBox[39m=[32m"0 0 24 24"[39m
                    [33mwidth[39m=[32m"24"[39m
                    [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
                  [36m>[39m
                    [36m<polygon[39m
                      [33mpoints[39m=[32m"3 11 22 2 13 21 11 13 3 11"[39m
                    [36m/>[39m
                  [36m</svg>[39m
                  [0mCapture GPS[0m
                [36m</button>[39m
                [36m<button[39m
                  [33mclass[39m=[32m"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2"[39m
                [36m>[39m
                  [0mManual Entry[0m
                [36m</button>[39m
              [36m</div>[39m
            [36m</div>[39m
          [36m</div>[39m
        [36m</div>[39m
      [36m</body>[39m
    [36m</html>[39m

    [0m [90m 81 |[39m
     [90m 82 |[39m     [36mawait[39m waitFor(() [33m=>[39m {
    [31m[1m>[22m[39m[90m 83 |[39m       expect(mockOnLocationCapture)[33m.[39mtoHaveBeenCalledWith([35m9.072264[39m[33m,[39m [35m7.491302[39m)
     [90m    |[39m                                     [31m[1m^[22m[39m
     [90m 84 |[39m     })
     [90m 85 |[39m
     [90m 86 |[39m     expect(screen[33m.[39mgetByText([35m/current location/i[39m))[33m.[39mtoBeInTheDocument()[0m

      at toHaveBeenCalledWith (tests/unit/components/GPSCapture.test.tsx:83:37)
      at runWithExpensiveErrorDiagnosticsDisabled (node_modules/@testing-library/dom/dist/config.js:47:12)
      at checkCallback (node_modules/@testing-library/dom/dist/wait-for.js:124:77)
      at checkRealTimersCallback (node_modules/@testing-library/dom/dist/wait-for.js:118:16)
      at Timeout.task [as _onTimeout] (node_modules/jsdom/lib/jsdom/browser/Window.js:520:19)

  ‚óè GPSCapture ‚Ä∫ should handle GPS capture errors

    Unable to find an element with the text: /location access denied by user/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<div[39m
          [33mclass[39m=[32m"rounded-lg border bg-card text-card-foreground shadow-sm w-full"[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"flex flex-col space-y-1.5 p-6"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"text-2xl font-semibold leading-none tracking-tight flex items-center gap-2"[39m
            [36m>[39m
              [36m<svg[39m
                [33maria-hidden[39m=[32m"true"[39m
                [33mclass[39m=[32m"lucide lucide-map-pin h-5 w-5"[39m
                [33mfill[39m=[32m"none"[39m
                [33mheight[39m=[32m"24"[39m
                [33mstroke[39m=[32m"currentColor"[39m
                [33mstroke-linecap[39m=[32m"round"[39m
                [33mstroke-linejoin[39m=[32m"round"[39m
                [33mstroke-width[39m=[32m"2"[39m
                [33mviewBox[39m=[32m"0 0 24 24"[39m
                [33mwidth[39m=[32m"24"[39m
                [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
              [36m>[39m
                [36m<path[39m
                  [33md[39m=[32m"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0"[39m
                [36m/>[39m
                [36m<circle[39m
                  [33mcx[39m=[32m"12"[39m
                  [33mcy[39m=[32m"10"[39m
                  [33mr[39m=[32m"3"[39m
                [36m/>[39m
              [36m</svg>[39m
              [0mGPS Location Capture[0m
            [36m</div>[39m
            [36m<div[39m
              [33mclass[39m=[32m"text-sm text-muted-foreground"[39m
            [36m>[39m
              [0mCapture GPS coordinates automatically or enter them manually[0m
            [36m</div>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"p-6 pt-0 space-y-4"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground bg-background text-foreground"[39m
              [33mrole[39m=[32m"alert"[39m
            [36m>[39m
              [36m<svg[39m
                [33maria-hidden[39m=[32m"true"[39m
                [33mclass[39m=[32m"lucide lucide-map-pin h-4 w-4"[39m
                [33mfill[39m=[32m"none"[39m
                [33mheight[39m=[32m"24"[39m
                [33mstroke[39m=[32m"currentColor"[39m
                [33mstroke-linecap[39m=[32m"round"[39m
                [33mstroke-linejoin[39m=[32m"round"[39m
                [33mstroke-width[39m=[32m"2"[39m
                [33mviewBox[39m=[32m"0 0 24 24"[39m
                [33mwidth[39m=[32m"24"[39m
                [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
              [36m>[39m
                [36m<path[39m
                  [33md[39m=[32m"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0"[39m
                [36m/>[39m
                [36m<circle[39m
                  [33mcx[39m=[32m"12"[39m
                  [33mcy[39m=[32m"10"[39m
                  [33mr[39m=[32m"3"[39m
                [36m/>[39m
              [36m</svg>[39m
              [36m<div[39m
                [33mclass[39m=[32m"text-sm [&_p]:leading-relaxed"[39m
              [36m>[39m
                [36m<strong>[39m
                  [0mCurrent Location:[0m
                [36m</strong>[39m
                [36m<br />[39m
                [0mLatitude: [0m
                [0m11.506000[0m
                [36m<br />[39m
                [0mLongitude: [0m
                [0m13.098000[0m
              [36m</div>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mclass[39m=[32m"flex gap-2"[39m
            [36m>[39m
              [36m<button[39m
                [33mclass[39m=[32m"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 py-2 flex-1"[39m
              [36m>[39m
                [36m<svg[39m
                  [33maria-hidden[39m=[32m"true"[39m
                  [33mclass[39m=[32m"lucide lucide-navigation h-4 w-4 mr-2"[39m
                  [33mfill[39m=[32m"none"[39m
                  [33mheight[39m=[32m"24"[39m
                  [33mstroke[39m=[32m"currentColor"[39m
                  [33mstroke-linecap[39m=[32m"round"[39m
                  [33mstroke-linejoin[39m=[32m"round"[39m
                  [33mstroke-width[39m=[32m"2"[39m
                  [33mviewBox[39m=[32m"0 0 24 24"[39m
                  [33mwidth[39m=[32m"24"[39m
                  [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
                [36m>[39m
                  [36m<polygon[39m
                    [33mpoints[39m=[32m"3 11 22 2 13 21 11 13 3 11"[39m
                  [36m/>[39m
                [36m</svg>[39m
                [0mCapture GPS[0m
              [36m</button>[39m
              [36m<button[39m
                [33mclass[39m=[32m"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2"[39m
              [36m>[39m
                [0mManual Entry[0m
              [36m</button>[39m
            [36m</div>[39m
          [36m</div>[39m
        [36m</div>[39m
      [36m</div>[39m
    [36m</body>[39m

    [0m [90m 104 |[39m     fireEvent[33m.[39mclick(captureButton)
     [90m 105 |[39m
    [31m[1m>[22m[39m[90m 106 |[39m     [36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                  [31m[1m^[22m[39m
     [90m 107 |[39m       expect(screen[33m.[39mgetByText([35m/location access denied by user/i[39m))[33m.[39mtoBeInTheDocument()
     [90m 108 |[39m     })
     [90m 109 |[39m[0m

      at waitForWrapper (node_modules/@testing-library/dom/dist/wait-for.js:163:27)
      at Object.<anonymous> (tests/unit/components/GPSCapture.test.tsx:106:18)

  ‚óè GPSCapture ‚Ä∫ should validate manual coordinate input

    TestingLibraryElementError: Unable to find an element with the text: /please enter valid latitude and longitude values/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<div[39m
          [33mclass[39m=[32m"rounded-lg border bg-card text-card-foreground shadow-sm w-full"[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"flex flex-col space-y-1.5 p-6"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"text-2xl font-semibold leading-none tracking-tight flex items-center gap-2"[39m
            [36m>[39m
              [36m<svg[39m
                [33maria-hidden[39m=[32m"true"[39m
                [33mclass[39m=[32m"lucide lucide-map-pin h-5 w-5"[39m
                [33mfill[39m=[32m"none"[39m
                [33mheight[39m=[32m"24"[39m
                [33mstroke[39m=[32m"currentColor"[39m
                [33mstroke-linecap[39m=[32m"round"[39m
                [33mstroke-linejoin[39m=[32m"round"[39m
                [33mstroke-width[39m=[32m"2"[39m
                [33mviewBox[39m=[32m"0 0 24 24"[39m
                [33mwidth[39m=[32m"24"[39m
                [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
              [36m>[39m
                [36m<path[39m
                  [33md[39m=[32m"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0"[39m
                [36m/>[39m
                [36m<circle[39m
                  [33mcx[39m=[32m"12"[39m
                  [33mcy[39m=[32m"10"[39m
                  [33mr[39m=[32m"3"[39m
                [36m/>[39m
              [36m</svg>[39m
              [0mGPS Location Capture[0m
            [36m</div>[39m
            [36m<div[39m
              [33mclass[39m=[32m"text-sm text-muted-foreground"[39m
            [36m>[39m
              [0mCapture GPS coordinates automatically or enter them manually[0m
            [36m</div>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"p-6 pt-0 space-y-4"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"flex gap-2"[39m
            [36m>[39m
              [36m<button[39m
                [33mclass[39m=[32m"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 py-2 flex-1"[39m
              [36m>[39m
                [36m<svg[39m
                  [33maria-hidden[39m=[32m"true"[39m
                  [33mclass[39m=[32m"lucide lucide-navigation h-4 w-4 mr-2"[39m
                  [33mfill[39m=[32m"none"[39m
                  [33mheight[39m=[32m"24"[39m
                  [33mstroke[39m=[32m"currentColor"[39m
                  [33mstroke-linecap[39m=[32m"round"[39m
                  [33mstroke-linejoin[39m=[32m"round"[39m
                  [33mstroke-width[39m=[32m"2"[39m
                  [33mviewBox[39m=[32m"0 0 24 24"[39m
                  [33mwidth[39m=[32m"24"[39m
                  [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
                [36m>[39m
                  [36m<polygon[39m
                    [33mpoints[39m=[32m"3 11 22 2 13 21 11 13 3 11"[39m
                  [36m/>[39m
                [36m</svg>[39m
                [0mCapture GPS[0m
              [36m</button>[39m
              [36m<button[39m
                [33mclass[39m=[32m"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2"[39m
              [36m>[39m
                [0mManual Entry[0m
              [36m</button>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mclass[39m=[32m"space-y-4 border-t pt-4"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"grid grid-cols-2 gap-4"[39m
              [36m>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"space-y-2"[39m
                [36m>[39m
                  [36m<label[39m
                    [33mclass[39m=[32m"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"[39m
                    [33mfor[39m=[32m"manual-lat"[39m
                  [36m>[39m
                    [0mLatitude[0m
                  [36m</label>[39m
                  [36m<input[39m
                    [33mclass[39m=[32m"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm"[39m
                    [33mid[39m=[32m"manual-lat"[39m
                    [33mplaceholder[39m=[32m"e.g., 9.072264"[39m
                    [33mstep[39m=[32m"any"[39m
                    [33mtype[39m=[32m"number"[39m
                    [33mvalue[39m=[32m""[39m
                  [36m/>[39m
                [36m</div>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"space-y-2"[39m
                [36m>[39m
                  [36m<label[39m
                    [33mclass[39m=[32m"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"[39m
                    [33mfor[39m=[32m"manual-lng"[39m
                  [36m>[39m
                    [0mLongitude[0m
                  [36m</label>[39m
                  [36m<input[39m
                    [33mclass[39m=[32m"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm"[39m
                    [33mid[39m=[32m"manual-lng"[39m
                    [33mplaceholder[39m=[32m"e.g., 7.491302"[39m
                    [33mstep[39m=[32m"any"[39m
                    [33mtype[39m=[32m"number"[39m
                    [33mvalue[39m=[32m"7.491302"[39m
                  [36m/>[39m
                [36m</div>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mclass[39m=[32m"flex gap-2"[39m
              [36m>[39m
                [36m<button[39m
                  [33mclass[39m=[32m"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 py-2 flex-1"[39m
                  [33mdisabled[39m=[32m""[39m
                [36m>[39m
                  [0mSet Location[0m
                [36m</button>[39m
              [36m</div>[39m
            [36m</div>[39m
          [36m</div>[39m
        [36m</div>[39m
      [36m</div>[39m
    [36m</body>[39m

    [0m [90m 161 |[39m     fireEvent[33m.[39mclick(setLocationButton)
     [90m 162 |[39m
    [31m[1m>[22m[39m[90m 163 |[39m     expect(screen[33m.[39mgetByText([35m/please enter valid latitude and longitude values/i[39m))[33m.[39mtoBeInTheDocument()
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 164 |[39m     expect(mockOnLocationCapture)[33m.[39mnot[33m.[39mtoHaveBeenCalled()
     [90m 165 |[39m   })
     [90m 166 |[39m[0m

      at Object.getElementError (node_modules/@testing-library/dom/dist/config.js:37:19)
      at node_modules/@testing-library/dom/dist/query-helpers.js:76:38
      at node_modules/@testing-library/dom/dist/query-helpers.js:52:17
      at node_modules/@testing-library/dom/dist/query-helpers.js:95:19
      at Object.getByText (tests/unit/components/GPSCapture.test.tsx:163:19)

  ‚óè GPSCapture ‚Ä∫ should show error when geolocation is not supported

    Unable to find an element with the text: /geolocation is not supported by this browser/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<div[39m
          [33mclass[39m=[32m"rounded-lg border bg-card text-card-foreground shadow-sm w-full"[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"flex flex-col space-y-1.5 p-6"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"text-2xl font-semibold leading-none tracking-tight flex items-center gap-2"[39m
            [36m>[39m
              [36m<svg[39m
                [33maria-hidden[39m=[32m"true"[39m
                [33mclass[39m=[32m"lucide lucide-map-pin h-5 w-5"[39m
                [33mfill[39m=[32m"none"[39m
                [33mheight[39m=[32m"24"[39m
                [33mstroke[39m=[32m"currentColor"[39m
                [33mstroke-linecap[39m=[32m"round"[39m
                [33mstroke-linejoin[39m=[32m"round"[39m
                [33mstroke-width[39m=[32m"2"[39m
                [33mviewBox[39m=[32m"0 0 24 24"[39m
                [33mwidth[39m=[32m"24"[39m
                [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
              [36m>[39m
                [36m<path[39m
                  [33md[39m=[32m"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0"[39m
                [36m/>[39m
                [36m<circle[39m
                  [33mcx[39m=[32m"12"[39m
                  [33mcy[39m=[32m"10"[39m
                  [33mr[39m=[32m"3"[39m
                [36m/>[39m
              [36m</svg>[39m
              [0mGPS Location Capture[0m
            [36m</div>[39m
            [36m<div[39m
              [33mclass[39m=[32m"text-sm text-muted-foreground"[39m
            [36m>[39m
              [0mCapture GPS coordinates automatically or enter them manually[0m
            [36m</div>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"p-6 pt-0 space-y-4"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground bg-background text-foreground"[39m
              [33mrole[39m=[32m"alert"[39m
            [36m>[39m
              [36m<svg[39m
                [33maria-hidden[39m=[32m"true"[39m
                [33mclass[39m=[32m"lucide lucide-map-pin h-4 w-4"[39m
                [33mfill[39m=[32m"none"[39m
                [33mheight[39m=[32m"24"[39m
                [33mstroke[39m=[32m"currentColor"[39m
                [33mstroke-linecap[39m=[32m"round"[39m
                [33mstroke-linejoin[39m=[32m"round"[39m
                [33mstroke-width[39m=[32m"2"[39m
                [33mviewBox[39m=[32m"0 0 24 24"[39m
                [33mwidth[39m=[32m"24"[39m
                [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
              [36m>[39m
                [36m<path[39m
                  [33md[39m=[32m"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0"[39m
                [36m/>[39m
                [36m<circle[39m
                  [33mcx[39m=[32m"12"[39m
                  [33mcy[39m=[32m"10"[39m
                  [33mr[39m=[32m"3"[39m
                [36m/>[39m
              [36m</svg>[39m
              [36m<div[39m
                [33mclass[39m=[32m"text-sm [&_p]:leading-relaxed"[39m
              [36m>[39m
                [36m<strong>[39m
                  [0mCurrent Location:[0m
                [36m</strong>[39m
                [36m<br />[39m
                [0mLatitude: [0m
                [0m11.506000[0m
                [36m<br />[39m
                [0mLongitude: [0m
                [0m13.098000[0m
              [36m</div>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mclass[39m=[32m"flex gap-2"[39m
            [36m>[39m
              [36m<button[39m
                [33mclass[39m=[32m"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 py-2 flex-1"[39m
              [36m>[39m
                [36m<svg[39m
                  [33maria-hidden[39m=[32m"true"[39m
                  [33mclass[39m=[32m"lucide lucide-navigation h-4 w-4 mr-2"[39m
                  [33mfill[39m=[32m"none"[39m
                  [33mheight[39m=[32m"24"[39m
                  [33mstroke[39m=[32m"currentColor"[39m
                  [33mstroke-linecap[39m=[32m"round"[39m
                  [33mstroke-linejoin[39m=[32m"round"[39m
                  [33mstroke-width[39m=[32m"2"[39m
                  [33mviewBox[39m=[32m"0 0 24 24"[39m
                  [33mwidth[39m=[32m"24"[39m
                  [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
                [36m>[39m
                  [36m<polygon[39m
                    [33mpoints[39m=[32m"3 11 22 2 13 21 11 13 3 11"[39m
                  [36m/>[39m
                [36m</svg>[39m
                [0mCapture GPS[0m
              [36m</button>[39m
              [36m<button[39m
                [33mclass[39m=[32m"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2"[39m
              [36m>[39m
                [0mManual Entry[0m
              [36m</button>[39m
            [36m</div>[39m
          [36m</div>[39m
        [36m</div>[39m
      [36m</div>[39m
    [36m</body>[39m

    [0m [90m 221 |[39m     fireEvent[33m.[39mclick(captureButton)
     [90m 222 |[39m
    [31m[1m>[22m[39m[90m 223 |[39m     [36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                  [31m[1m^[22m[39m
     [90m 224 |[39m       expect(screen[33m.[39mgetByText([35m/geolocation is not supported by this browser/i[39m))[33m.[39mtoBeInTheDocument()
     [90m 225 |[39m     })
     [90m 226 |[39m   })[0m

      at waitForWrapper (node_modules/@testing-library/dom/dist/wait-for.js:163:27)
      at Object.<anonymous> (tests/unit/components/GPSCapture.test.tsx:223:18)

FAIL tests/unit/components/RoleSwitcher.test.tsx (10 s)
  ‚óè RoleSwitcher Component ‚Ä∫ Component Rendering ‚Ä∫ should render when user is authenticated with multiple roles

    TestingLibraryElementError: Found multiple elements with the text: Assessor

    Here are the matching elements:

    Ignored nodes: comments, script, style
    [36m<span[39m
      [33mclass[39m=[32m"hidden sm:inline"[39m
    [36m>[39m
      [0mAssessor[0m
    [36m</span>[39m

    Ignored nodes: comments, script, style
    [36m<div[39m
      [33mclass[39m=[32m"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-blue-100 text-blue-800 hover:bg-blue-200"[39m
    [36m>[39m
      [0mAssessor[0m
    [36m</div>[39m

    (If this is intentional, then use the `*AllBy*` variant of the query (like `queryAllByText`, `getAllByText`, or `findAllByText`)).

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<button[39m
          [33maria-expanded[39m=[32m"false"[39m
          [33maria-haspopup[39m=[32m"menu"[39m
          [33mclass[39m=[32m"inline-flex items-center justify-center whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9 rounded-md px-3 gap-2 undefined"[39m
          [33mdata-state[39m=[32m"closed"[39m
          [33mid[39m=[32m"radix-:r0:"[39m
          [33mtype[39m=[32m"button"[39m
        [36m>[39m
          [36m<div[39m
            [33mdata-testid[39m=[32m"user-icon"[39m
          [36m/>[39m
          [36m<span[39m
            [33mclass[39m=[32m"hidden sm:inline"[39m
          [36m>[39m
            [0mAssessor[0m
          [36m</span>[39m
          [36m<div[39m
            [33mclass[39m=[32m"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-blue-100 text-blue-800 hover:bg-blue-200"[39m
          [36m>[39m
            [0mAssessor[0m
          [36m</div>[39m
          [36m<div[39m
            [33mdata-testid[39m=[32m"arrow-left-right-icon"[39m
          [36m/>[39m
        [36m</button>[39m
      [36m</div>[39m
    [36m</body>[39m

    [0m [90m 83 |[39m       
     [90m 84 |[39m       expect(screen[33m.[39mgetByTestId([32m'user-icon'[39m))[33m.[39mtoBeInTheDocument()[33m;[39m
    [31m[1m>[22m[39m[90m 85 |[39m       expect(screen[33m.[39mgetByText([32m'Assessor'[39m))[33m.[39mtoBeInTheDocument()[33m;[39m
     [90m    |[39m                     [31m[1m^[22m[39m
     [90m 86 |[39m       expect(screen[33m.[39mgetByTestId([32m'arrow-left-right-icon'[39m))[33m.[39mtoBeInTheDocument()[33m;[39m
     [90m 87 |[39m     })[33m;[39m
     [90m 88 |[39m[0m

      at Object.getElementError (node_modules/@testing-library/dom/dist/config.js:37:19)
      at getElementError (node_modules/@testing-library/dom/dist/query-helpers.js:20:35)
      at getMultipleElementsFoundError (node_modules/@testing-library/dom/dist/query-helpers.js:23:10)
      at node_modules/@testing-library/dom/dist/query-helpers.js:55:13
      at node_modules/@testing-library/dom/dist/query-helpers.js:95:19
      at Object.getByText (tests/unit/components/RoleSwitcher.test.tsx:85:21)

  ‚óè RoleSwitcher Component ‚Ä∫ Component Rendering ‚Ä∫ should display current role correctly

    TestingLibraryElementError: Found multiple elements with the text: Coordinator

    Here are the matching elements:

    Ignored nodes: comments, script, style
    [36m<span[39m
      [33mclass[39m=[32m"hidden sm:inline"[39m
    [36m>[39m
      [0mCoordinator[0m
    [36m</span>[39m

    Ignored nodes: comments, script, style
    [36m<div[39m
      [33mclass[39m=[32m"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-green-100 text-green-800 hover:bg-green-200"[39m
    [36m>[39m
      [0mCoordinator[0m
    [36m</div>[39m

    (If this is intentional, then use the `*AllBy*` variant of the query (like `queryAllByText`, `getAllByText`, or `findAllByText`)).

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<button[39m
          [33maria-expanded[39m=[32m"false"[39m
          [33maria-haspopup[39m=[32m"menu"[39m
          [33mclass[39m=[32m"inline-flex items-center justify-center whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9 rounded-md px-3 gap-2 undefined"[39m
          [33mdata-state[39m=[32m"closed"[39m
          [33mid[39m=[32m"radix-:r2:"[39m
          [33mtype[39m=[32m"button"[39m
        [36m>[39m
          [36m<div[39m
            [33mdata-testid[39m=[32m"user-icon"[39m
          [36m/>[39m
          [36m<span[39m
            [33mclass[39m=[32m"hidden sm:inline"[39m
          [36m>[39m
            [0mCoordinator[0m
          [36m</span>[39m
          [36m<div[39m
            [33mclass[39m=[32m"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-green-100 text-green-800 hover:bg-green-200"[39m
          [36m>[39m
            [0mCoordinator[0m
          [36m</div>[39m
          [36m<div[39m
            [33mdata-testid[39m=[32m"arrow-left-right-icon"[39m
          [36m/>[39m
        [36m</button>[39m
      [36m</div>[39m
    [36m</body>[39m

    [0m [90m  95 |[39m       render([33m<[39m[33mRoleSwitcher[39m [33m/[39m[33m>[39m)[33m;[39m
     [90m  96 |[39m       
    [31m[1m>[22m[39m[90m  97 |[39m       expect(screen[33m.[39mgetByText([32m'Coordinator'[39m))[33m.[39mtoBeInTheDocument()[33m;[39m
     [90m     |[39m                     [31m[1m^[22m[39m
     [90m  98 |[39m     })[33m;[39m
     [90m  99 |[39m   })[33m;[39m
     [90m 100 |[39m[0m

      at Object.getElementError (node_modules/@testing-library/dom/dist/config.js:37:19)
      at getElementError (node_modules/@testing-library/dom/dist/query-helpers.js:20:35)
      at getMultipleElementsFoundError (node_modules/@testing-library/dom/dist/query-helpers.js:23:10)
      at node_modules/@testing-library/dom/dist/query-helpers.js:55:13
      at node_modules/@testing-library/dom/dist/query-helpers.js:95:19
      at Object.getByText (tests/unit/components/RoleSwitcher.test.tsx:97:21)

  ‚óè RoleSwitcher Component ‚Ä∫ Dropdown Menu ‚Ä∫ should show dropdown when clicked

    Unable to find an element with the text: Switch Role. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<button[39m
          [33maria-expanded[39m=[32m"false"[39m
          [33maria-haspopup[39m=[32m"menu"[39m
          [33mclass[39m=[32m"inline-flex items-center justify-center whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9 rounded-md px-3 gap-2 undefined"[39m
          [33mdata-state[39m=[32m"closed"[39m
          [33mid[39m=[32m"radix-:r4:"[39m
          [33mtype[39m=[32m"button"[39m
        [36m>[39m
          [36m<div[39m
            [33mdata-testid[39m=[32m"user-icon"[39m
          [36m/>[39m
          [36m<span[39m
            [33mclass[39m=[32m"hidden sm:inline"[39m
          [36m>[39m
            [0mAssessor[0m
          [36m</span>[39m
          [36m<div[39m
            [33mclass[39m=[32m"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-blue-100 text-blue-800 hover:bg-blue-200"[39m
          [36m>[39m
            [0mAssessor[0m
          [36m</div>[39m
          [36m<div[39m
            [33mdata-testid[39m=[32m"arrow-left-right-icon"[39m
          [36m/>[39m
        [36m</button>[39m
      [36m</div>[39m
    [36m</body>[39m

    [0m [90m 108 |[39m
     [90m 109 |[39m       [90m// Wait for dropdown to appear[39m
    [31m[1m>[22m[39m[90m 110 |[39m       [36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                    [31m[1m^[22m[39m
     [90m 111 |[39m         expect(screen[33m.[39mgetByText([32m'Switch Role'[39m))[33m.[39mtoBeInTheDocument()[33m;[39m
     [90m 112 |[39m       })[33m;[39m
     [90m 113 |[39m[0m

      at waitForWrapper (node_modules/@testing-library/dom/dist/wait-for.js:163:27)
      at Object.<anonymous> (tests/unit/components/RoleSwitcher.test.tsx:110:20)

  ‚óè RoleSwitcher Component ‚Ä∫ Dropdown Menu ‚Ä∫ should show current role as selected

    Unable to find an element by: [data-testid="check-icon"]

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<button[39m
          [33maria-expanded[39m=[32m"false"[39m
          [33maria-haspopup[39m=[32m"menu"[39m
          [33mclass[39m=[32m"inline-flex items-center justify-center whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9 rounded-md px-3 gap-2 undefined"[39m
          [33mdata-state[39m=[32m"closed"[39m
          [33mid[39m=[32m"radix-:r6:"[39m
          [33mtype[39m=[32m"button"[39m
        [36m>[39m
          [36m<div[39m
            [33mdata-testid[39m=[32m"user-icon"[39m
          [36m/>[39m
          [36m<span[39m
            [33mclass[39m=[32m"hidden sm:inline"[39m
          [36m>[39m
            [0mAssessor[0m
          [36m</span>[39m
          [36m<div[39m
            [33mclass[39m=[32m"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-blue-100 text-blue-800 hover:bg-blue-200"[39m
          [36m>[39m
            [0mAssessor[0m
          [36m</div>[39m
          [36m<div[39m
            [33mdata-testid[39m=[32m"arrow-left-right-icon"[39m
          [36m/>[39m
        [36m</button>[39m
      [36m</div>[39m
    [36m</body>[39m

    [0m [90m 123 |[39m       fireEvent[33m.[39mclick(button)[33m;[39m
     [90m 124 |[39m
    [31m[1m>[22m[39m[90m 125 |[39m       [36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                    [31m[1m^[22m[39m
     [90m 126 |[39m         [90m// Current role should have check icon[39m
     [90m 127 |[39m         [36mconst[39m checkIcons [33m=[39m screen[33m.[39mgetAllByTestId([32m'check-icon'[39m)[33m;[39m
     [90m 128 |[39m         expect(checkIcons)[33m.[39mtoHaveLength([35m1[39m)[33m;[39m[0m

      at waitForWrapper (node_modules/@testing-library/dom/dist/wait-for.js:163:27)
      at Object.<anonymous> (tests/unit/components/RoleSwitcher.test.tsx:125:20)

  ‚óè RoleSwitcher Component ‚Ä∫ Role Switching ‚Ä∫ should call switchRole when clicking different role

    Unable to find an element with the text: Coordinator. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<button[39m
          [33maria-expanded[39m=[32m"false"[39m
          [33maria-haspopup[39m=[32m"menu"[39m
          [33mclass[39m=[32m"inline-flex items-center justify-center whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9 rounded-md px-3 gap-2 undefined"[39m
          [33mdata-state[39m=[32m"closed"[39m
          [33mid[39m=[32m"radix-:r8:"[39m
          [33mtype[39m=[32m"button"[39m
        [36m>[39m
          [36m<div[39m
            [33mdata-testid[39m=[32m"user-icon"[39m
          [36m/>[39m
          [36m<span[39m
            [33mclass[39m=[32m"hidden sm:inline"[39m
          [36m>[39m
            [0mAssessor[0m
          [36m</span>[39m
          [36m<div[39m
            [33mclass[39m=[32m"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-blue-100 text-blue-800 hover:bg-blue-200"[39m
          [36m>[39m
            [0mAssessor[0m
          [36m</div>[39m
          [36m<div[39m
            [33mdata-testid[39m=[32m"arrow-left-right-icon"[39m
          [36m/>[39m
        [36m</button>[39m
      [36m</div>[39m
    [36m</body>[39m

    [0m [90m 144 |[39m       fireEvent[33m.[39mclick(button)[33m;[39m
     [90m 145 |[39m
    [31m[1m>[22m[39m[90m 146 |[39m       [36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                    [31m[1m^[22m[39m
     [90m 147 |[39m         [90m// Click on a different role[39m
     [90m 148 |[39m         [36mconst[39m coordinatorOption [33m=[39m screen[33m.[39mgetByText([32m'Coordinator'[39m)[33m;[39m
     [90m 149 |[39m         fireEvent[33m.[39mclick(coordinatorOption)[33m;[39m[0m

      at waitForWrapper (node_modules/@testing-library/dom/dist/wait-for.js:163:27)
      at Object.<anonymous> (tests/unit/components/RoleSwitcher.test.tsx:146:20)

  ‚óè RoleSwitcher Component ‚Ä∫ Role Switching ‚Ä∫ should show unsaved changes warning when applicable

    Unable to find an element with the text: Coordinator. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [0m
            [0m
      [36m<form[39m
        [33mdata-dirty[39m=[32m"true"[39m
      [36m>[39m
        [0m
              [0m
        [36m<input[39m
          [33mdata-initial-value[39m=[32m""[39m
          [33mvalue[39m=[32m"test"[39m
        [36m/>[39m
        [0m
            [0m
      [36m</form>[39m
      [0m
          [0m
      [36m<div>[39m
        [36m<button[39m
          [33maria-expanded[39m=[32m"false"[39m
          [33maria-haspopup[39m=[32m"menu"[39m
          [33mclass[39m=[32m"inline-flex items-center justify-center whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9 rounded-md px-3 gap-2 undefined"[39m
          [33mdata-state[39m=[32m"closed"[39m
          [33mid[39m=[32m"radix-:ra:"[39m
          [33mtype[39m=[32m"button"[39m
        [36m>[39m
          [36m<div[39m
            [33mdata-testid[39m=[32m"user-icon"[39m
          [36m/>[39m
          [36m<span[39m
            [33mclass[39m=[32m"hidden sm:inline"[39m
          [36m>[39m
            [0mAssessor[0m
          [36m</span>[39m
          [36m<div[39m
            [33mclass[39m=[32m"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-blue-100 text-blue-800 hover:bg-blue-200"[39m
          [36m>[39m
            [0mAssessor[0m
          [36m</div>[39m
          [36m<div[39m
            [33mdata-testid[39m=[32m"arrow-left-right-icon"[39m
          [36m/>[39m
        [36m</button>[39m
      [36m</div>[39m
    [36m</body>[39m

    [0m [90m 170 |[39m       fireEvent[33m.[39mclick(button)[33m;[39m
     [90m 171 |[39m
    [31m[1m>[22m[39m[90m 172 |[39m       [36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                    [31m[1m^[22m[39m
     [90m 173 |[39m         [36mconst[39m coordinatorOption [33m=[39m screen[33m.[39mgetByText([32m'Coordinator'[39m)[33m;[39m
     [90m 174 |[39m         fireEvent[33m.[39mclick(coordinatorOption)[33m;[39m
     [90m 175 |[39m       })[33m;[39m[0m

      at waitForWrapper (node_modules/@testing-library/dom/dist/wait-for.js:163:27)
      at Object.<anonymous> (tests/unit/components/RoleSwitcher.test.tsx:172:20)

  ‚óè RoleSwitcher Component ‚Ä∫ Role Switching ‚Ä∫ should redirect to correct dashboard after role switch

    Unable to find an element with the text: Coordinator. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [0m
            [0m
      [36m<form[39m
        [33mdata-dirty[39m=[32m"true"[39m
      [36m>[39m
        [0m
              [0m
        [36m<input[39m
          [33mdata-initial-value[39m=[32m""[39m
          [33mvalue[39m=[32m"test"[39m
        [36m/>[39m
        [0m
            [0m
      [36m</form>[39m
      [0m
          [0m
      [36m<div>[39m
        [36m<button[39m
          [33maria-expanded[39m=[32m"false"[39m
          [33maria-haspopup[39m=[32m"menu"[39m
          [33mclass[39m=[32m"inline-flex items-center justify-center whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9 rounded-md px-3 gap-2 undefined"[39m
          [33mdata-state[39m=[32m"closed"[39m
          [33mid[39m=[32m"radix-:rc:"[39m
          [33mtype[39m=[32m"button"[39m
        [36m>[39m
          [36m<div[39m
            [33mdata-testid[39m=[32m"user-icon"[39m
          [36m/>[39m
          [36m<span[39m
            [33mclass[39m=[32m"hidden sm:inline"[39m
          [36m>[39m
            [0mAssessor[0m
          [36m</span>[39m
          [36m<div[39m
            [33mclass[39m=[32m"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-blue-100 text-blue-800 hover:bg-blue-200"[39m
          [36m>[39m
            [0mAssessor[0m
          [36m</div>[39m
          [36m<div[39m
            [33mdata-testid[39m=[32m"arrow-left-right-icon"[39m
          [36m/>[39m
        [36m</button>[39m
      [36m</div>[39m
    [36m</body>[39m

    [0m [90m 196 |[39m       fireEvent[33m.[39mclick(button)[33m;[39m
     [90m 197 |[39m
    [31m[1m>[22m[39m[90m 198 |[39m       [36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                    [31m[1m^[22m[39m
     [90m 199 |[39m         [36mconst[39m coordinatorOption [33m=[39m screen[33m.[39mgetByText([32m'Coordinator'[39m)[33m;[39m
     [90m 200 |[39m         fireEvent[33m.[39mclick(coordinatorOption)[33m;[39m
     [90m 201 |[39m       })[33m;[39m[0m

      at waitForWrapper (node_modules/@testing-library/dom/dist/wait-for.js:163:27)
      at Object.<anonymous> (tests/unit/components/RoleSwitcher.test.tsx:198:20)

  ‚óè RoleSwitcher Component ‚Ä∫ Unsaved Changes Warning ‚Ä∫ should show warning dialog when there are unsaved forms

    Unable to find an element with the text: Coordinator. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [0m
            [0m
      [36m<form[39m
        [33mdata-dirty[39m=[32m"true"[39m
      [36m>[39m
        [0m
              [0m
        [36m<input[39m
          [33mtype[39m=[32m"text"[39m
          [33mvalue[39m=[32m"test"[39m
        [36m/>[39m
        [0m
            [0m
      [36m</form>[39m
      [0m
          [0m
      [36m<div>[39m
        [36m<button[39m
          [33maria-expanded[39m=[32m"false"[39m
          [33maria-haspopup[39m=[32m"menu"[39m
          [33mclass[39m=[32m"inline-flex items-center justify-center whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9 rounded-md px-3 gap-2 undefined"[39m
          [33mdata-state[39m=[32m"closed"[39m
          [33mid[39m=[32m"radix-:re:"[39m
          [33mtype[39m=[32m"button"[39m
        [36m>[39m
          [36m<div[39m
            [33mdata-testid[39m=[32m"user-icon"[39m
          [36m/>[39m
          [36m<span[39m
            [33mclass[39m=[32m"hidden sm:inline"[39m
          [36m>[39m
            [0mAssessor[0m
          [36m</span>[39m
          [36m<div[39m
            [33mclass[39m=[32m"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-blue-100 text-blue-800 hover:bg-blue-200"[39m
          [36m>[39m
            [0mAssessor[0m
          [36m</div>[39m
          [36m<div[39m
            [33mdata-testid[39m=[32m"arrow-left-right-icon"[39m
          [36m/>[39m
        [36m</button>[39m
      [36m</div>[39m
    [36m</body>[39m

    [0m [90m 220 |[39m       fireEvent[33m.[39mclick(button)[33m;[39m
     [90m 221 |[39m
    [31m[1m>[22m[39m[90m 222 |[39m       [36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                    [31m[1m^[22m[39m
     [90m 223 |[39m         [36mconst[39m coordinatorOption [33m=[39m screen[33m.[39mgetByText([32m'Coordinator'[39m)[33m;[39m
     [90m 224 |[39m         fireEvent[33m.[39mclick(coordinatorOption)[33m;[39m
     [90m 225 |[39m       })[33m;[39m[0m

      at waitForWrapper (node_modules/@testing-library/dom/dist/wait-for.js:163:27)
      at Object.<anonymous> (tests/unit/components/RoleSwitcher.test.tsx:222:20)

  ‚óè RoleSwitcher Component ‚Ä∫ Unsaved Changes Warning ‚Ä∫ should close warning when cancel is clicked

    Unable to find an element with the text: Coordinator. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [0m
            [0m
      [36m<form[39m
        [33mdata-dirty[39m=[32m"true"[39m
      [36m>[39m
        [0m
              [0m
        [36m<input[39m
          [33mtype[39m=[32m"text"[39m
          [33mvalue[39m=[32m"test"[39m
        [36m/>[39m
        [0m
            [0m
      [36m</form>[39m
      [0m
          [0m
      [36m<div>[39m
        [36m<button[39m
          [33maria-expanded[39m=[32m"false"[39m
          [33maria-haspopup[39m=[32m"menu"[39m
          [33mclass[39m=[32m"inline-flex items-center justify-center whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9 rounded-md px-3 gap-2 undefined"[39m
          [33mdata-state[39m=[32m"closed"[39m
          [33mid[39m=[32m"radix-:rg:"[39m
          [33mtype[39m=[32m"button"[39m
        [36m>[39m
          [36m<div[39m
            [33mdata-testid[39m=[32m"user-icon"[39m
          [36m/>[39m
          [36m<span[39m
            [33mclass[39m=[32m"hidden sm:inline"[39m
          [36m>[39m
            [0mAssessor[0m
          [36m</span>[39m
          [36m<div[39m
            [33mclass[39m=[32m"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-blue-100 text-blue-800 hover:bg-blue-200"[39m
          [36m>[39m
            [0mAssessor[0m
          [36m</div>[39m
          [36m<div[39m
            [33mdata-testid[39m=[32m"arrow-left-right-icon"[39m
          [36m/>[39m
        [36m</button>[39m
      [36m</div>[39m
    [36m</body>[39m

    [0m [90m 244 |[39m       fireEvent[33m.[39mclick(button)[33m;[39m
     [90m 245 |[39m
    [31m[1m>[22m[39m[90m 246 |[39m       [36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                    [31m[1m^[22m[39m
     [90m 247 |[39m         [36mconst[39m coordinatorOption [33m=[39m screen[33m.[39mgetByText([32m'Coordinator'[39m)[33m;[39m
     [90m 248 |[39m         fireEvent[33m.[39mclick(coordinatorOption)[33m;[39m
     [90m 249 |[39m       })[33m;[39m[0m

      at waitForWrapper (node_modules/@testing-library/dom/dist/wait-for.js:163:27)
      at Object.<anonymous> (tests/unit/components/RoleSwitcher.test.tsx:246:20)

  ‚óè RoleSwitcher Component ‚Ä∫ Unsaved Changes Warning ‚Ä∫ should proceed with role switch when Save & Switch is clicked

    Unable to find an element with the text: Coordinator. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [0m
            [0m
      [36m<form[39m
        [33mdata-dirty[39m=[32m"true"[39m
      [36m>[39m
        [0m
              [0m
        [36m<input[39m
          [33mtype[39m=[32m"text"[39m
          [33mvalue[39m=[32m"test"[39m
        [36m/>[39m
        [0m
            [0m
      [36m</form>[39m
      [0m
          [0m
      [36m<div>[39m
        [36m<button[39m
          [33maria-expanded[39m=[32m"false"[39m
          [33maria-haspopup[39m=[32m"menu"[39m
          [33mclass[39m=[32m"inline-flex items-center justify-center whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9 rounded-md px-3 gap-2 undefined"[39m
          [33mdata-state[39m=[32m"closed"[39m
          [33mid[39m=[32m"radix-:ri:"[39m
          [33mtype[39m=[32m"button"[39m
        [36m>[39m
          [36m<div[39m
            [33mdata-testid[39m=[32m"user-icon"[39m
          [36m/>[39m
          [36m<span[39m
            [33mclass[39m=[32m"hidden sm:inline"[39m
          [36m>[39m
            [0mAssessor[0m
          [36m</span>[39m
          [36m<div[39m
            [33mclass[39m=[32m"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-blue-100 text-blue-800 hover:bg-blue-200"[39m
          [36m>[39m
            [0mAssessor[0m
          [36m</div>[39m
          [36m<div[39m
            [33mdata-testid[39m=[32m"arrow-left-right-icon"[39m
          [36m/>[39m
        [36m</button>[39m
      [36m</div>[39m
    [36m</body>[39m

    [0m [90m 276 |[39m       fireEvent[33m.[39mclick(button)[33m;[39m
     [90m 277 |[39m
    [31m[1m>[22m[39m[90m 278 |[39m       [36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                    [31m[1m^[22m[39m
     [90m 279 |[39m         [36mconst[39m coordinatorOption [33m=[39m screen[33m.[39mgetByText([32m'Coordinator'[39m)[33m;[39m
     [90m 280 |[39m         fireEvent[33m.[39mclick(coordinatorOption)[33m;[39m
     [90m 281 |[39m       })[33m;[39m[0m

      at waitForWrapper (node_modules/@testing-library/dom/dist/wait-for.js:163:27)
      at Object.<anonymous> (tests/unit/components/RoleSwitcher.test.tsx:278:20)


Test Suites: 24 failed, 3 passed, 27 total
Tests:       134 failed, 118 passed, 252 total
Snapshots:   0 total
Time:        14.38 s
Ran all test suites.
