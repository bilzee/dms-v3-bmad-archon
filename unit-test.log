
> disaster-management-pwa@0.1.0 test:unit:coverage
> jest --coverage

FAIL tests/unit/api/commitments/commitment-api.test.ts
  â— Commitment API Tests - Story 4.3 â€º GET /api/v1/donors/[id]/commitments â€º should return commitments for a specific donor

    TypeError: Cannot read properties of undefined (reading 'findUnique')

    [0m [90m 125 |[39m     
     [90m 126 |[39m     [90m// Default mock implementations[39m
    [31m[1m>[22m[39m[90m 127 |[39m     (prisma[33m.[39mdonor[33m.[39mfindUnique [36mas[39m jest[33m.[39m[33mMockedFunction[39m)[33m.[39mmockResolvedValue({
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 128 |[39m       id[33m:[39m [32m'donor-456'[39m[33m,[39m
     [90m 129 |[39m       name[33m:[39m [32m'Test Donor Organization'[39m[33m,[39m
     [90m 130 |[39m       type[33m:[39m [32m'ORGANIZATION'[39m[33m,[39m[0m

      at Object.findUnique (tests/unit/api/commitments/commitment-api.test.ts:127:19)

  â— Commitment API Tests - Story 4.3 â€º GET /api/v1/donors/[id]/commitments â€º should return 404 for non-existent donor

    TypeError: Cannot read properties of undefined (reading 'findUnique')

    [0m [90m 125 |[39m     
     [90m 126 |[39m     [90m// Default mock implementations[39m
    [31m[1m>[22m[39m[90m 127 |[39m     (prisma[33m.[39mdonor[33m.[39mfindUnique [36mas[39m jest[33m.[39m[33mMockedFunction[39m)[33m.[39mmockResolvedValue({
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 128 |[39m       id[33m:[39m [32m'donor-456'[39m[33m,[39m
     [90m 129 |[39m       name[33m:[39m [32m'Test Donor Organization'[39m[33m,[39m
     [90m 130 |[39m       type[33m:[39m [32m'ORGANIZATION'[39m[33m,[39m[0m

      at Object.findUnique (tests/unit/api/commitments/commitment-api.test.ts:127:19)

  â— Commitment API Tests - Story 4.3 â€º GET /api/v1/donors/[id]/commitments â€º should support entity and incident filtering

    TypeError: Cannot read properties of undefined (reading 'findUnique')

    [0m [90m 125 |[39m     
     [90m 126 |[39m     [90m// Default mock implementations[39m
    [31m[1m>[22m[39m[90m 127 |[39m     (prisma[33m.[39mdonor[33m.[39mfindUnique [36mas[39m jest[33m.[39m[33mMockedFunction[39m)[33m.[39mmockResolvedValue({
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 128 |[39m       id[33m:[39m [32m'donor-456'[39m[33m,[39m
     [90m 129 |[39m       name[33m:[39m [32m'Test Donor Organization'[39m[33m,[39m
     [90m 130 |[39m       type[33m:[39m [32m'ORGANIZATION'[39m[33m,[39m[0m

      at Object.findUnique (tests/unit/api/commitments/commitment-api.test.ts:127:19)

  â— Commitment API Tests - Story 4.3 â€º GET /api/v1/commitments/available â€º should return available commitments for responders

    TypeError: Cannot read properties of undefined (reading 'findUnique')

    [0m [90m 125 |[39m     
     [90m 126 |[39m     [90m// Default mock implementations[39m
    [31m[1m>[22m[39m[90m 127 |[39m     (prisma[33m.[39mdonor[33m.[39mfindUnique [36mas[39m jest[33m.[39m[33mMockedFunction[39m)[33m.[39mmockResolvedValue({
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 128 |[39m       id[33m:[39m [32m'donor-456'[39m[33m,[39m
     [90m 129 |[39m       name[33m:[39m [32m'Test Donor Organization'[39m[33m,[39m
     [90m 130 |[39m       type[33m:[39m [32m'ORGANIZATION'[39m[33m,[39m[0m

      at Object.findUnique (tests/unit/api/commitments/commitment-api.test.ts:127:19)

  â— Commitment API Tests - Story 4.3 â€º GET /api/v1/commitments/available â€º should only return commitments for PLANNED status by default

    TypeError: Cannot read properties of undefined (reading 'findUnique')

    [0m [90m 125 |[39m     
     [90m 126 |[39m     [90m// Default mock implementations[39m
    [31m[1m>[22m[39m[90m 127 |[39m     (prisma[33m.[39mdonor[33m.[39mfindUnique [36mas[39m jest[33m.[39m[33mMockedFunction[39m)[33m.[39mmockResolvedValue({
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 128 |[39m       id[33m:[39m [32m'donor-456'[39m[33m,[39m
     [90m 129 |[39m       name[33m:[39m [32m'Test Donor Organization'[39m[33m,[39m
     [90m 130 |[39m       type[33m:[39m [32m'ORGANIZATION'[39m[33m,[39m[0m

      at Object.findUnique (tests/unit/api/commitments/commitment-api.test.ts:127:19)

  â— Commitment API Tests - Story 4.3 â€º GET /api/v1/commitments/available â€º should reject requests from non-responder roles

    TypeError: Cannot read properties of undefined (reading 'findUnique')

    [0m [90m 125 |[39m     
     [90m 126 |[39m     [90m// Default mock implementations[39m
    [31m[1m>[22m[39m[90m 127 |[39m     (prisma[33m.[39mdonor[33m.[39mfindUnique [36mas[39m jest[33m.[39m[33mMockedFunction[39m)[33m.[39mmockResolvedValue({
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 128 |[39m       id[33m:[39m [32m'donor-456'[39m[33m,[39m
     [90m 129 |[39m       name[33m:[39m [32m'Test Donor Organization'[39m[33m,[39m
     [90m 130 |[39m       type[33m:[39m [32m'ORGANIZATION'[39m[33m,[39m[0m

      at Object.findUnique (tests/unit/api/commitments/commitment-api.test.ts:127:19)

  â— Commitment API Tests - Story 4.3 â€º POST /api/v1/responses/from-commitment â€º should create response from commitment successfully

    TypeError: Cannot read properties of undefined (reading 'findUnique')

    [0m [90m 125 |[39m     
     [90m 126 |[39m     [90m// Default mock implementations[39m
    [31m[1m>[22m[39m[90m 127 |[39m     (prisma[33m.[39mdonor[33m.[39mfindUnique [36mas[39m jest[33m.[39m[33mMockedFunction[39m)[33m.[39mmockResolvedValue({
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 128 |[39m       id[33m:[39m [32m'donor-456'[39m[33m,[39m
     [90m 129 |[39m       name[33m:[39m [32m'Test Donor Organization'[39m[33m,[39m
     [90m 130 |[39m       type[33m:[39m [32m'ORGANIZATION'[39m[33m,[39m[0m

      at Object.findUnique (tests/unit/api/commitments/commitment-api.test.ts:127:19)

  â— Commitment API Tests - Story 4.3 â€º POST /api/v1/responses/from-commitment â€º should reject requests for non-existent commitment

    TypeError: Cannot read properties of undefined (reading 'findUnique')

    [0m [90m 125 |[39m     
     [90m 126 |[39m     [90m// Default mock implementations[39m
    [31m[1m>[22m[39m[90m 127 |[39m     (prisma[33m.[39mdonor[33m.[39mfindUnique [36mas[39m jest[33m.[39m[33mMockedFunction[39m)[33m.[39mmockResolvedValue({
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 128 |[39m       id[33m:[39m [32m'donor-456'[39m[33m,[39m
     [90m 129 |[39m       name[33m:[39m [32m'Test Donor Organization'[39m[33m,[39m
     [90m 130 |[39m       type[33m:[39m [32m'ORGANIZATION'[39m[33m,[39m[0m

      at Object.findUnique (tests/unit/api/commitments/commitment-api.test.ts:127:19)

  â— Commitment API Tests - Story 4.3 â€º POST /api/v1/responses/from-commitment â€º should validate request body structure

    TypeError: Cannot read properties of undefined (reading 'findUnique')

    [0m [90m 125 |[39m     
     [90m 126 |[39m     [90m// Default mock implementations[39m
    [31m[1m>[22m[39m[90m 127 |[39m     (prisma[33m.[39mdonor[33m.[39mfindUnique [36mas[39m jest[33m.[39m[33mMockedFunction[39m)[33m.[39mmockResolvedValue({
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 128 |[39m       id[33m:[39m [32m'donor-456'[39m[33m,[39m
     [90m 129 |[39m       name[33m:[39m [32m'Test Donor Organization'[39m[33m,[39m
     [90m 130 |[39m       type[33m:[39m [32m'ORGANIZATION'[39m[33m,[39m[0m

      at Object.findUnique (tests/unit/api/commitments/commitment-api.test.ts:127:19)

  â— CommitmentService - Story 4.3 â€º getAvailableCommitmentsForResponder â€º should filter commitments by entity assignment

    TypeError: Cannot read properties of undefined (reading 'findMany')

    [0m [90m 414 |[39m       [36mconst[39m filters [33m=[39m { entityId[33m:[39m [32m'entity-123'[39m[33m,[39m incidentId[33m:[39m [32m'incident-456'[39m }[33m;[39m
     [90m 415 |[39m       
    [31m[1m>[22m[39m[90m 416 |[39m       (prisma[33m.[39mdonorCommitment[33m.[39mfindMany [36mas[39m jest[33m.[39m[33mMockedFunction[39m)[33m.[39mmockResolvedValue([mockCommitment])[33m;[39m
     [90m     |[39m                               [31m[1m^[22m[39m
     [90m 417 |[39m
     [90m 418 |[39m       [90m// Act[39m
     [90m 419 |[39m       [36mconst[39m result [33m=[39m [36mawait[39m commitmentService[33m.[39mgetAvailableCommitmentsForResponder(userId[33m,[39m filters)[33m;[39m[0m

      at Object.findMany (tests/unit/api/commitments/commitment-api.test.ts:416:31)

  â— CommitmentService - Story 4.3 â€º getAvailableCommitmentsForResponder â€º should calculate available quantities correctly

    TypeError: Cannot read properties of undefined (reading 'findMany')

    [0m [90m 451 |[39m       }[33m;[39m
     [90m 452 |[39m       
    [31m[1m>[22m[39m[90m 453 |[39m       (prisma[33m.[39mdonorCommitment[33m.[39mfindMany [36mas[39m jest[33m.[39m[33mMockedFunction[39m)[33m.[39mmockResolvedValue([commitmentWithPartialUsage])[33m;[39m
     [90m     |[39m                               [31m[1m^[22m[39m
     [90m 454 |[39m
     [90m 455 |[39m       [90m// Act[39m
     [90m 456 |[39m       [36mconst[39m result [33m=[39m [36mawait[39m commitmentService[33m.[39mgetAvailableCommitmentsForResponder([32m'user-123'[39m[33m,[39m {})[33m;[39m[0m

      at Object.findMany (tests/unit/api/commitments/commitment-api.test.ts:453:31)

  â— CommitmentService - Story 4.3 â€º processCommitmentUsage â€º should update commitment quantities correctly

    TypeError: Cannot read properties of undefined (reading 'findUnique')

    [0m [90m 480 |[39m       }[33m;[39m
     [90m 481 |[39m       
    [31m[1m>[22m[39m[90m 482 |[39m       (prisma[33m.[39mdonorCommitment[33m.[39mfindUnique [36mas[39m jest[33m.[39m[33mMockedFunction[39m)[33m.[39mmockResolvedValue(mockCommitment)[33m;[39m
     [90m     |[39m                               [31m[1m^[22m[39m
     [90m 483 |[39m       (prisma[33m.[39mdonorCommitment[33m.[39mupdate [36mas[39m jest[33m.[39m[33mMockedFunction[39m)[33m.[39mmockResolvedValue(updatedCommitment)[33m;[39m
     [90m 484 |[39m
     [90m 485 |[39m       [90m// Act[39m[0m

      at Object.findUnique (tests/unit/api/commitments/commitment-api.test.ts:482:31)

  â— CommitmentService - Story 4.3 â€º processCommitmentUsage â€º should set status to COMPLETE when fully used

    TypeError: Cannot read properties of undefined (reading 'findUnique')

    [0m [90m 514 |[39m       }[33m;[39m
     [90m 515 |[39m       
    [31m[1m>[22m[39m[90m 516 |[39m       (prisma[33m.[39mdonorCommitment[33m.[39mfindUnique [36mas[39m jest[33m.[39m[33mMockedFunction[39m)[33m.[39mmockResolvedValue(mockCommitment)[33m;[39m
     [90m     |[39m                               [31m[1m^[22m[39m
     [90m 517 |[39m       (prisma[33m.[39mdonorCommitment[33m.[39mupdate [36mas[39m jest[33m.[39m[33mMockedFunction[39m)[33m.[39mmockResolvedValue(fullyUsedCommitment)[33m;[39m
     [90m 518 |[39m
     [90m 519 |[39m       [90m// Act[39m[0m

      at Object.findUnique (tests/unit/api/commitments/commitment-api.test.ts:516:31)

  â— CommitmentService - Story 4.3 â€º processCommitmentUsage â€º should reject usage when quantity exceeds available

    TypeError: Cannot read properties of undefined (reading 'findUnique')

    [0m [90m 541 |[39m       }[33m;[39m
     [90m 542 |[39m       
    [31m[1m>[22m[39m[90m 543 |[39m       (prisma[33m.[39mdonorCommitment[33m.[39mfindUnique [36mas[39m jest[33m.[39m[33mMockedFunction[39m)[33m.[39mmockResolvedValue(mockCommitment)[33m;[39m
     [90m     |[39m                               [31m[1m^[22m[39m
     [90m 544 |[39m
     [90m 545 |[39m       [90m// Act & Assert[39m
     [90m 546 |[39m       [36mawait[39m expect(commitmentService[33m.[39mprocessCommitmentUsage(usageData[33m,[39m [32m'user-123'[39m))[0m

      at Object.findUnique (tests/unit/api/commitments/commitment-api.test.ts:543:31)

  â— CommitmentService - Story 4.3 â€º createCommitment â€º should create commitment successfully

    TypeError: Cannot read properties of undefined (reading 'findUnique')

    [0m [90m 569 |[39m       }[33m;[39m
     [90m 570 |[39m       
    [31m[1m>[22m[39m[90m 571 |[39m       (prisma[33m.[39mdonor[33m.[39mfindUnique [36mas[39m jest[33m.[39m[33mMockedFunction[39m)[33m.[39mmockResolvedValue({
     [90m     |[39m                     [31m[1m^[22m[39m
     [90m 572 |[39m         id[33m:[39m [32m'donor-456'[39m[33m,[39m
     [90m 573 |[39m         name[33m:[39m [32m'Test Donor'[39m[33m,[39m
     [90m 574 |[39m         type[33m:[39m [32m'ORGANIZATION'[39m[33m,[39m[0m

      at Object.findUnique (tests/unit/api/commitments/commitment-api.test.ts:571:21)

  â— CommitmentService - Story 4.3 â€º createCommitment â€º should validate donor exists and is active

    TypeError: Cannot read properties of undefined (reading 'findUnique')

    [0m [90m 620 |[39m       }[33m;[39m
     [90m 621 |[39m       
    [31m[1m>[22m[39m[90m 622 |[39m       (prisma[33m.[39mdonor[33m.[39mfindUnique [36mas[39m jest[33m.[39m[33mMockedFunction[39m)[33m.[39mmockResolvedValue([36mnull[39m)[33m;[39m
     [90m     |[39m                     [31m[1m^[22m[39m
     [90m 623 |[39m
     [90m 624 |[39m       [90m// Act & Assert[39m
     [90m 625 |[39m       [36mawait[39m expect(commitmentService[33m.[39mcreateCommitment(createData[33m,[39m [32m'user-123'[39m))[0m

      at Object.findUnique (tests/unit/api/commitments/commitment-api.test.ts:622:21)

  â— CommitmentService - Story 4.3 â€º getCommitmentStats â€º should return comprehensive statistics

    TypeError: Cannot read properties of undefined (reading 'count')

    [0m [90m 631 |[39m     it([32m'should return comprehensive statistics'[39m[33m,[39m [36masync[39m () [33m=>[39m {
     [90m 632 |[39m       [90m// Arrange[39m
    [31m[1m>[22m[39m[90m 633 |[39m       (prisma[33m.[39mdonorCommitment[33m.[39mcount [36mas[39m jest[33m.[39m[33mMockedFunction[39m)
     [90m     |[39m                               [31m[1m^[22m[39m
     [90m 634 |[39m         [33m.[39mmockResolvedValueOnce([35m10[39m) [90m// total[39m
     [90m 635 |[39m         [33m.[39mmockResolvedValueOnce([35m5[39m)  [90m// planned[39m
     [90m 636 |[39m         [33m.[39mmockResolvedValueOnce([35m3[39m)  [90m// partial[39m[0m

      at Object.count (tests/unit/api/commitments/commitment-api.test.ts:633:31)

PASS tests/unit/auth/role-switching.test.ts
PASS tests/unit/auth/service.test.ts
PASS tests/unit/api/preliminary-assessment.test.ts
PASS tests/integration/commitments/database-migration.test.ts
----------------------------------------------------------|---------|----------|---------|---------|-------------------------
File                                                      | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s       
----------------------------------------------------------|---------|----------|---------|---------|-------------------------
All files                                                 |    0.91 |     0.29 |    1.07 |    0.93 |                         
 src                                                      |       0 |        0 |       0 |       0 |                         
  middleware.ts                                           |       0 |        0 |       0 |       0 | 1-56                    
 src/app/(auth)/assessor/dashboard                        |       0 |      100 |       0 |       0 |                         
  page.tsx                                                |       0 |      100 |       0 |       0 | 3-12                    
 src/app/(auth)/assessor/preliminary-assessment           |       0 |        0 |       0 |       0 |                         
  page.tsx                                                |       0 |        0 |       0 |       0 | 3-220                   
 src/app/(auth)/assessor/rapid-assessments                |       0 |        0 |       0 |       0 |                         
  page.tsx                                                |       0 |        0 |       0 |       0 | 3-254                   
 src/app/(auth)/assessor/rapid-assessments/new            |       0 |        0 |       0 |       0 |                         
  page.tsx                                                |       0 |        0 |       0 |       0 | 3-296                   
 src/app/(auth)/coordinator/dashboard                     |       0 |      100 |       0 |       0 |                         
  page.tsx                                                |       0 |      100 |       0 |       0 | 3-12                    
 src/app/(auth)/coordinator/entities                      |       0 |        0 |       0 |       0 |                         
  page.tsx                                                |       0 |        0 |       0 |       0 | 3-571                   
 src/app/(auth)/coordinator/verification                  |       0 |        0 |       0 |       0 |                         
  page.tsx                                                |       0 |        0 |       0 |       0 | 3-43                    
 src/app/(auth)/coordinator/verification/auto-approval    |       0 |      100 |       0 |       0 |                         
  page.tsx                                                |       0 |      100 |       0 |       0 | 2-9                     
 src/app/(auth)/coordinator/verification/deliveries       |       0 |        0 |       0 |       0 |                         
  page.tsx                                                |       0 |        0 |       0 |       0 | 3-631                   
 src/app/(auth)/responder/dashboard                       |       0 |        0 |       0 |       0 |                         
  page.tsx                                                |       0 |        0 |       0 |       0 | 3-214                   
 src/app/(auth)/responder/planning                        |       0 |        0 |       0 |       0 |                         
  page.tsx                                                |       0 |        0 |       0 |       0 | 3-220                   
 src/app/(auth)/responder/planning/new                    |       0 |      100 |       0 |       0 |                         
  page.tsx                                                |       0 |      100 |       0 |       0 | 4-25                    
 src/app/(auth)/responder/responses                       |       0 |        0 |       0 |       0 |                         
  page.tsx                                                |       0 |        0 |       0 |       0 | 3-333                   
 src/app/(auth)/responder/responses/[id]/deliver          |       0 |        0 |       0 |       0 |                         
  page.tsx                                                |       0 |        0 |       0 |       0 | 3-96                    
 src/app/admin/users                                      |       0 |        0 |       0 |       0 |                         
  page.tsx                                                |       0 |        0 |       0 |       0 | 3-269                   
 src/app/api/entities/available-for-assessment            |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-84                    
 src/app/api/living-tests                                 |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 8-340                   
 src/app/api/v1/assessments/[id]/reject                   |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-151                   
 src/app/api/v1/assessments/[id]/verify                   |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-140                   
 src/app/api/v1/assessments/verified                      |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-54                    
 src/app/api/v1/auth/login                                |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-77                    
 src/app/api/v1/auth/logout                               |       0 |      100 |       0 |       0 |                         
  route.ts                                                |       0 |      100 |       0 |       0 | 1-26                    
 src/app/api/v1/auth/me                                   |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-53                    
 src/app/api/v1/auth/profile                              |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-228                   
 src/app/api/v1/auth/refresh                              |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-27                    
 src/app/api/v1/auto-assignment/config                    |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-154                   
 src/app/api/v1/auto-assignment/trigger                   |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-66                    
 src/app/api/v1/commitments/available                     |   13.15 |        0 |       0 |   13.88 |                         
  route.ts                                                |   13.15 |        0 |       0 |   13.88 | 7-150                   
 src/app/api/v1/delivery-media                            |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-243                   
 src/app/api/v1/delivery-media/[id]                       |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-194                   
 src/app/api/v1/delivery-media/sync                       |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-88                    
 src/app/api/v1/donors/[id]/commitments                   |    11.9 |        0 |       0 |   13.51 |                         
  route.ts                                                |    11.9 |        0 |       0 |   13.51 | 11-131                  
 src/app/api/v1/entities                                  |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-53                    
 src/app/api/v1/entities/[id]/auto-approval               |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-203                   
 src/app/api/v1/entities/assigned                         |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-54                    
 src/app/api/v1/entities/public                           |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-22                    
 src/app/api/v1/entity-assignments                        |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-191                   
 src/app/api/v1/entity-assignments/[id]                   |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-124                   
 src/app/api/v1/entity-assignments/bulk                   |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-171                   
 src/app/api/v1/entity-assignments/collaboration          |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-75                    
 src/app/api/v1/entity-assignments/entity/[entityId]      |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-103                   
 src/app/api/v1/entity-assignments/suggestions            |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-126                   
 src/app/api/v1/entity-assignments/user/[userId]          |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-83                    
 src/app/api/v1/incidents                                 |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-96                    
 src/app/api/v1/incidents/from-assessment                 |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-79                    
 src/app/api/v1/preliminary-assessments                   |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-39                    
 src/app/api/v1/preliminary-assessments/[id]              |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-233                   
 src/app/api/v1/preliminary-assessments/user/[userId]     |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-83                    
 src/app/api/v1/rapid-assessments                         |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-145                   
 src/app/api/v1/rapid-assessments/[id]                    |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-195                   
 src/app/api/v1/rapid-assessments/[id]/submit             |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-62                    
 src/app/api/v1/rapid-assessments/user/[userId]           |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-61                    
 src/app/api/v1/responses/[id]                            |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-183                   
 src/app/api/v1/responses/[id]/collaboration              |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-226                   
 src/app/api/v1/responses/[id]/deliver                    |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-175                   
 src/app/api/v1/responses/assigned                        |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-70                    
 src/app/api/v1/responses/conflicts/[assessmentId]        |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-55                    
 src/app/api/v1/responses/from-commitment                 |   14.58 |        0 |       0 |   15.21 |                         
  route.ts                                                |   14.58 |        0 |       0 |   15.21 | 19-187                  
 src/app/api/v1/responses/planned                         |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-101                   
 src/app/api/v1/responses/planned/assigned                |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-70                    
 src/app/api/v1/roles                                     |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-44                    
 src/app/api/v1/sync/batch                                |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-368                   
 src/app/api/v1/sync/conflicts                            |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-89                    
 src/app/api/v1/sync/conflicts/export                     |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-103                   
 src/app/api/v1/sync/conflicts/summary                    |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-44                    
 src/app/api/v1/sync/pull                                 |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-296                   
 src/app/api/v1/sync/resolve                              |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-419                   
 src/app/api/v1/sync/status                               |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-113                   
 src/app/api/v1/users                                     |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-224                   
 src/app/api/v1/users/[userId]                            |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-319                   
 src/app/api/v1/users/[userId]/roles                      |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-174                   
 src/app/api/v1/users/assignable                          |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-85                    
 src/app/api/v1/verification/auto-approval                |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-267                   
 src/app/api/v1/verification/metrics                      |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-145                   
 src/app/api/v1/verification/queue/assessments            |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-91                    
 src/app/api/v1/verification/queue/deliveries             |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-192                   
 src/app/api/v1/verification/queue/deliveries/[id]/verify |       0 |        0 |       0 |       0 |                         
  route.ts                                                |       0 |        0 |       0 |       0 | 1-277                   
 src/app/dashboard                                        |       0 |        0 |       0 |       0 |                         
  page.tsx                                                |       0 |        0 |       0 |       0 | 3-387                   
 src/app/dashboard/crisis                                 |       0 |        0 |       0 |       0 |                         
  page.tsx                                                |       0 |        0 |       0 |       0 | 3-238                   
 src/app/login                                            |       0 |      100 |       0 |       0 |                         
  page.tsx                                                |       0 |      100 |       0 |       0 | 1-3                     
 src/app/profile                                          |       0 |        0 |       0 |       0 |                         
  page.tsx                                                |       0 |        0 |       0 |       0 | 3-84                    
 src/app/rapid-assessments                                |       0 |        0 |       0 |       0 |                         
  page.tsx                                                |       0 |        0 |       0 |       0 | 3-31                    
 src/app/rapid-assessments/new                            |       0 |        0 |       0 |       0 |                         
  page.tsx                                                |       0 |        0 |       0 |       0 | 3-245                   
 src/app/verification/metrics                             |       0 |        0 |       0 |       0 |                         
  page.tsx                                                |       0 |        0 |       0 |       0 | 3-249                   
 src/components/auth                                      |       0 |        0 |       0 |       0 |                         
  EditUserForm.tsx                                        |       0 |        0 |       0 |       0 | 3-410                   
  LoginForm.tsx                                           |       0 |        0 |       0 |       0 | 3-142                   
  RegisterForm.tsx                                        |       0 |        0 |       0 |       0 | 3-255                   
 src/components/dashboards/crisis                         |       0 |        0 |       0 |       0 |                         
  ConflictExportDialog.tsx                                |       0 |        0 |       0 |       0 | 3-166                   
  ConflictLog.tsx                                         |       0 |        0 |       0 |       0 | 3-362                   
  ConflictSummary.tsx                                     |       0 |        0 |       0 |       0 | 3-124                   
 src/components/delivery                                  |       0 |        0 |       0 |       0 |                         
  OfflineSyncDashboard.tsx                                |       0 |        0 |       0 |       0 | 3-261                   
  OfflineSyncStatus.tsx                                   |       0 |        0 |       0 |       0 | 3-236                   
 src/components/forms/assessment                          |       0 |        0 |       0 |       0 |                         
  FoodAssessmentForm.tsx                                  |       0 |        0 |       0 |       0 | 3-471                   
  HealthAssessmentForm.tsx                                |       0 |        0 |       0 |       0 | 3-595                   
  PopulationAssessmentForm.tsx                            |       0 |        0 |       0 |       0 | 3-538                   
  PreliminaryAssessmentForm.tsx                           |       0 |        0 |       0 |       0 | 3-551                   
  SecurityAssessmentForm.tsx                              |       0 |        0 |       0 |       0 | 3-424                   
  ShelterAssessmentForm.tsx                               |       0 |        0 |       0 |       0 | 3-478                   
  WASHAssessmentForm.tsx                                  |       0 |        0 |       0 |       0 | 3-513                   
 src/components/forms/delivery                            |       0 |        0 |       0 |       0 |                         
  DeliveryConfirmationForm.tsx                            |       0 |        0 |       0 |       0 | 3-778                   
  DeliveryMediaField.tsx                                  |       0 |        0 |       0 |       0 | 3-471                   
  EnhancedDeliveryMediaCapture.tsx                        |       0 |        0 |       0 |       0 | 3-601                   
 src/components/forms/incident                            |       0 |        0 |       0 |       0 |                         
  IncidentCreationForm.tsx                                |       0 |        0 |       0 |       0 | 3-238                   
 src/components/forms/response                            |       0 |        0 |       0 |       0 |                         
  DonorCommitmentImportForm.tsx                           |       0 |        0 |       0 |       0 | 3-534                   
  ResponsePlanningForm.tsx                                |       0 |        0 |       0 |       0 | 3-991                   
 src/components/layouts                                   |       0 |        0 |       0 |       0 |                         
  AppShell.tsx                                            |       0 |        0 |       0 |       0 | 3-92                    
  Navigation.tsx                                          |       0 |        0 |       0 |       0 | 3-280                   
  RoleSwitcher.tsx                                        |       0 |        0 |       0 |       0 | 3-268                   
 src/components/providers                                 |       0 |      100 |       0 |       0 |                         
  QueryProvider.tsx                                       |       0 |      100 |       0 |       0 | 3-14                    
 src/components/response                                  |       0 |        0 |       0 |       0 |                         
  AssessmentSelector.tsx                                  |       0 |        0 |       0 |       0 | 3-184                   
  CollaborationStatus.tsx                                 |       0 |        0 |       0 |       0 | 3-186                   
  ResponsePlanningDashboard.tsx                           |       0 |        0 |       0 |       0 | 3-345                   
 src/components/shared                                    |       0 |        0 |       0 |       0 |                         
  EntitySelector.tsx                                      |       0 |        0 |       0 |       0 | 3-192                   
  EntitySelectorSkeleton.tsx                              |       0 |      100 |       0 |       0 | 1-7                     
  FormStateManager.tsx                                    |       0 |        0 |       0 |       0 | 3-104                   
  GPSCapture.tsx                                          |       0 |        0 |       0 |       0 | 3-202                   
  Header.tsx                                              |       0 |        0 |       0 |       0 | 3-14                    
  LocationSelector.tsx                                    |       0 |        0 |       0 |       0 | 3-141                   
  MediaField.tsx                                          |       0 |        0 |       0 |       0 | 3-252                   
  OfflineIndicator.tsx                                    |       0 |        0 |       0 |       0 | 3-106                   
  RoleBasedRoute.tsx                                      |       0 |        0 |       0 |       0 | 3-174                   
  SyncIndicator.tsx                                       |       0 |        0 |       0 |       0 | 3-68                    
  SyncQueue.tsx                                           |       0 |        0 |       0 |       0 | 3-332                   
 src/components/testing                                   |       0 |        0 |       0 |       0 |                         
  living-documentation-dashboard.tsx                      |       0 |        0 |       0 |       0 | 14-605                  
 src/components/ui                                        |       0 |        0 |       0 |       0 |                         
  alert-dialog.tsx                                        |       0 |      100 |     100 |       0 | 1-138                   
  alert.tsx                                               |       0 |      100 |     100 |       0 | 1-59                    
  avatar.tsx                                              |       0 |        0 |       0 |       0 | 1-78                    
  badge.tsx                                               |       0 |      100 |       0 |       0 | 1-36                    
  button.tsx                                              |       0 |        0 |       0 |       0 | 1-56                    
  card.tsx                                                |       0 |      100 |     100 |       0 | 1-79                    
  checkbox.tsx                                            |       0 |      100 |     100 |       0 | 3-30                    
  command.tsx                                             |       0 |      100 |       0 |       0 | 1-152                   
  dialog.tsx                                              |       0 |      100 |     100 |       0 | 3-121                   
  dropdown-menu.tsx                                       |       0 |        0 |       0 |       0 | 3-199                   
  form.tsx                                                |       0 |        0 |       0 |       0 | 3-177                   
  input.tsx                                               |       0 |      100 |       0 |       0 | 1-22                    
  label.tsx                                               |       0 |      100 |     100 |       0 | 3-26                    
  pagination.tsx                                          |       0 |        0 |     100 |       0 | 1-116                   
  popover.tsx                                             |       0 |        0 |     100 |       0 | 1-29                    
  progress.tsx                                            |       0 |        0 |     100 |       0 | 3-28                    
  scroll-area.tsx                                         |       0 |        0 |     100 |       0 | 1-46                    
  select.tsx                                              |       0 |        0 |     100 |       0 | 3-159                   
  separator.tsx                                           |       0 |        0 |     100 |       0 | 1-29                    
  skeleton.tsx                                            |       0 |      100 |       0 |       0 | 1-15                    
  switch.tsx                                              |       0 |      100 |     100 |       0 | 3-29                    
  table.tsx                                               |       0 |      100 |     100 |       0 | 1-116                   
  tabs.tsx                                                |       0 |      100 |     100 |       0 | 1-53                    
  textarea.tsx                                            |       0 |      100 |       0 |       0 | 1-24                    
  toast.tsx                                               |       0 |      100 |       0 |       0 | 1-126                   
  tooltip.tsx                                             |       0 |        0 |     100 |       0 | 1-28                    
 src/components/verification                              |       0 |        0 |       0 |       0 |                         
  AutoApprovalConfig.tsx                                  |       0 |        0 |       0 |       0 | 3-662                   
  StatusIndicator.tsx                                     |       0 |        0 |       0 |       0 | 1-212                   
  VerificationActions.tsx                                 |       0 |        0 |       0 |       0 | 3-416                   
  VerificationDashboard.tsx                               |       0 |        0 |       0 |       0 | 3-227                   
  VerificationQueue.tsx                                   |       0 |        0 |       0 |       0 | 3-325                   
 src/hooks                                                |       0 |        0 |       0 |       0 |                         
  useAuth.ts                                              |       0 |      100 |       0 |       0 | 1-7                     
  useBackgroundSync.ts                                    |       0 |        0 |       0 |       0 | 3-140                   
  useCollaboration.ts                                     |       0 |        0 |       0 |       0 | 1-84                    
  useConflicts.ts                                         |       0 |        0 |       0 |       0 | 1-142                   
  useEntities.ts                                          |       0 |        0 |       0 |       0 | 1-69                    
  useGPS.ts                                               |       0 |        0 |       0 |       0 | 3-120                   
  useIncident.ts                                          |       0 |        0 |       0 |       0 | 1-13                    
  useOffline.ts                                           |       0 |        0 |       0 |       0 | 3-223                   
  usePreliminaryAssessment.ts                             |       0 |        0 |       0 |       0 | 1-13                    
  useRoleSession.ts                                       |       0 |        0 |       0 |       0 | 3-183                   
  useSync.ts                                              |       0 |        0 |       0 |       0 | 1-278                   
  useVerification.ts                                      |       0 |        0 |       0 |       0 | 1-257                   
 src/lib                                                  |       0 |      100 |       0 |       0 |                         
  utils.ts                                                |       0 |      100 |       0 |       0 | 1-5                     
 src/lib/assignment                                       |       0 |        0 |       0 |       0 |                         
  auto-assignment.ts                                      |       0 |        0 |       0 |       0 | 1-397                   
  middleware.ts                                           |       0 |        0 |       0 |       0 | 2-221                   
  multi-user-service.ts                                   |       0 |        0 |       0 |       0 | 1-517                   
 src/lib/auth                                             |   25.12 |     9.43 |      34 |   25.13 |                         
  auth-options.ts                                         |       0 |        0 |       0 |       0 | 4-62                    
  config.ts                                               |       0 |      100 |     100 |       0 | 1-4                     
  get-current-user.ts                                     |       0 |        0 |       0 |       0 | 10-53                   
  middleware.ts                                           |    12.5 |        0 |   14.28 |   13.33 | 23-102                  
  role-check.ts                                           |       0 |        0 |       0 |       0 | 1-51                    
  service.ts                                              |   67.64 |    35.71 |      64 |   69.35 | 136,173,187-194,262-309 
  verify.ts                                               |       0 |        0 |       0 |       0 | 2-136                   
 src/lib/data                                             |       0 |        0 |       0 |       0 |                         
  nigeria-locations.ts                                    |       0 |        0 |       0 |       0 | 18-243                  
 src/lib/db                                               |    3.33 |    13.04 |       0 |    2.35 |                         
  client.ts                                               |     100 |      100 |     100 |     100 |                         
  offline.ts                                              |       0 |        0 |       0 |       0 | 1-563                   
 src/lib/services                                         |    2.68 |     1.72 |    2.92 |    2.91 |                         
  commitment.service.ts                                   |    3.92 |        0 |       0 |    4.65 | 37-237                  
  conflict-export.service.ts                              |       0 |        0 |       0 |       0 | 10-330                  
  delivery-media.service.ts                               |       0 |        0 |       0 |       0 | 2-348                   
  delivery-offline.service.ts                             |       0 |        0 |       0 |       0 | 1-694                   
  entity-assignment.service.ts                            |    2.35 |        0 |       0 |    2.63 | 60-479                  
  entity.service.ts                                       |       0 |        0 |       0 |       0 | 1-159                   
  incident.service.ts                                     |       0 |        0 |       0 |       0 | 1-175                   
  preliminary-assessment.service.ts                       |   59.45 |       50 |   71.42 |   59.45 | 68-102,127,135,184      
  rapid-assessment.service.ts                             |       0 |        0 |       0 |       0 | 1-421                   
  response-client.service.ts                              |       0 |        0 |       0 |       0 | 2-168                   
  response-offline.service.ts                             |       0 |        0 |       0 |       0 | 2-291                   
  response.service.ts                                     |       0 |        0 |       0 |       0 | 1-537                   
 src/lib/sync                                             |       0 |        0 |       0 |       0 |                         
  conflict.ts                                             |       0 |        0 |       0 |       0 | 1-463                   
  engine.ts                                               |       0 |        0 |       0 |       0 | 1-597                   
  queue.ts                                                |       0 |        0 |       0 |       0 | 1-463                   
 src/lib/testing                                          |       0 |        0 |       0 |       0 |                         
  fix-validator.ts                                        |       0 |        0 |       0 |       0 | 69-966                  
  living-documentation-dashboard.tsx                      |       0 |        0 |       0 |       0 | 14-605                  
  living-test-system.ts                                   |       0 |        0 |       0 |       0 | 9-890                   
 src/lib/utils                                            |       0 |        0 |       0 |       0 |                         
  audit-logger.ts                                         |       0 |        0 |       0 |       0 | 1-96                    
  delivery-media-manager.ts                               |       0 |        0 |       0 |       0 | 2-396                   
  delivery-media-validator.ts                             |       0 |        0 |       0 |       0 | 26-530                  
 src/lib/validation                                       |       0 |      100 |     100 |       0 |                         
  incidents.ts                                            |       0 |      100 |     100 |       0 | 1-21                    
  preliminary-assessment.ts                               |       0 |      100 |     100 |       0 | 1-39                    
  rapid-assessment.ts                                     |       0 |      100 |     100 |       0 | 1-152                   
  response.ts                                             |       0 |      100 |     100 |       0 | 1-41                    
 src/providers                                            |       0 |        0 |       0 |       0 |                         
  BackgroundSyncProvider.tsx                              |       0 |        0 |       0 |       0 | 3-140                   
 src/stores                                               |       0 |        0 |       0 |       0 |                         
  auth.store.ts                                           |       0 |        0 |       0 |       0 | 1-236                   
  entity.store.ts                                         |       0 |        0 |       0 |       0 | 1-450                   
  incident.store.ts                                       |       0 |        0 |       0 |       0 | 1-238                   
  offline.store.ts                                        |       0 |        0 |       0 |       0 | 1-217                   
  preliminary-assessment.store.ts                         |       0 |        0 |       0 |       0 | 1-494                   
  sync.store.ts                                           |       0 |        0 |       0 |       0 | 1-435                   
 src/types                                                |       0 |      100 |     100 |       0 |                         
  media.ts                                                |       0 |      100 |     100 |       0 | 1-118                   
  rapid-assessment.ts                                     |       0 |      100 |     100 |       0 | 1-4                     
  response.ts                                             |       0 |      100 |     100 |       0 | 1-69                    
 src/utils                                                |       0 |        0 |       0 |       0 |                         
  assessment-utils.ts                                     |       0 |        0 |       0 |       0 | 7-137                   
----------------------------------------------------------|---------|----------|---------|---------|-------------------------

Test Suites: 1 failed, 4 passed, 5 total
Tests:       17 failed, 49 passed, 66 total
Snapshots:   0 total
Time:        4.281 s
Ran all test suites.
